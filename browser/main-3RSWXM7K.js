import{A as $T,B as qT,C as bn,D as Ii,E as _h,F as iu,G as Hy,H as HT,I as GT,J as z,K as Xt,L as ht,M as Gy,N as zT,O as su,P as Q,Q as Dt,R as vh,S as zy,T as Dn,U as Ci,V as Gr,W as jo,X as WT,Y as Zt,Z as Wy,_ as Ue,a as A,b as ye,c as kT,d as By,e as y,f as OT,g as fh,h as FT,i as LT,j as D,k as Lo,l as ph,m as VT,n as jT,o as mt,p as Vo,q as ru,r as $y,s as UT,t as dr,u as qy,v as gh,w as mh,x as BT,y as yh,z as nt}from"./chunk-ZEK4DZ7O.js";var KT=null;var Ky=1,QT=Symbol("SIGNAL");function sn(t){let e=KT;return KT=t,e}var YT={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function bj(t){if(!(Xy(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===Ky)){if(!t.producerMustRecompute(t)&&!Qy(t)){t.dirty=!1,t.lastCleanEpoch=Ky;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=Ky}}function XT(t){return t&&(t.nextProducerIndex=0),sn(t)}function ZT(t,e){if(sn(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(Xy(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Yy(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function Qy(t){wh(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(bj(n),r!==n.version))return!0}return!1}function JT(t){if(wh(t),Xy(t))for(let e=0;e<t.producerNode.length;e++)Yy(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Yy(t,e){if(Dj(t),wh(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)Yy(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];wh(i),i.producerIndexOfThis[r]=e}}function Xy(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function wh(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function Dj(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function Tj(){throw new Error}var Sj=Tj;function eS(t){Sj=t}function Z(t){return typeof t=="function"}function Uo(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Eh=Uo(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function bs(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Xe=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(Z(r))try{r()}catch(s){e=s instanceof Eh?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{tS(s)}catch(o){e=e??[],o instanceof Eh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Eh(e)}}add(e){var n;if(e&&e!==this)if(this.closed)tS(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&bs(n,e)}remove(e){let{_finalizers:n}=this;n&&bs(n,e),e instanceof t&&e._removeParent(this)}};Xe.EMPTY=(()=>{let t=new Xe;return t.closed=!0,t})();var Zy=Xe.EMPTY;function Ih(t){return t instanceof Xe||t&&"closed"in t&&Z(t.remove)&&Z(t.add)&&Z(t.unsubscribe)}function tS(t){Z(t)?t():t.unsubscribe()}var Hn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Bo={setTimeout(t,e,...n){let{delegate:r}=Bo;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=Bo;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Ch(t){Bo.setTimeout(()=>{let{onUnhandledError:e}=Hn;if(e)e(t);else throw t})}function Ds(){}var nS=Jy("C",void 0,void 0);function rS(t){return Jy("E",void 0,t)}function iS(t){return Jy("N",t,void 0)}function Jy(t,e,n){return{kind:t,value:e,error:n}}var Ts=null;function $o(t){if(Hn.useDeprecatedSynchronousErrorHandling){let e=!Ts;if(e&&(Ts={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=Ts;if(Ts=null,n)throw r}}else t()}function sS(t){Hn.useDeprecatedSynchronousErrorHandling&&Ts&&(Ts.errorThrown=!0,Ts.error=t)}var Ss=class extends Xe{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Ih(e)&&e.add(this)):this.destination=Mj}static create(e,n,r){return new zr(e,n,r)}next(e){this.isStopped?t_(iS(e),this):this._next(e)}error(e){this.isStopped?t_(rS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?t_(nS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Aj=Function.prototype.bind;function e_(t,e){return Aj.call(t,e)}var n_=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){bh(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){bh(r)}else bh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){bh(n)}}},zr=class extends Ss{constructor(e,n,r){super();let i;if(Z(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Hn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&e_(e.next,s),error:e.error&&e_(e.error,s),complete:e.complete&&e_(e.complete,s)}):i=e}this.destination=new n_(i)}};function bh(t){Hn.useDeprecatedSynchronousErrorHandling?sS(t):Ch(t)}function xj(t){throw t}function t_(t,e){let{onStoppedNotification:n}=Hn;n&&Bo.setTimeout(()=>n(t,e))}var Mj={closed:!0,next:Ds,error:xj,complete:Ds};var qo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Tt(t){return t}function r_(...t){return i_(t)}function i_(t){return t.length===0?Tt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var ne=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=Pj(n)?n:new zr(n,r,i);return $o(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=oS(r),new r((i,s)=>{let o=new zr({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[qo](){return this}pipe(...n){return i_(n)(this)}toPromise(n){return n=oS(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function oS(t){var e;return(e=t??Hn.Promise)!==null&&e!==void 0?e:Promise}function Rj(t){return t&&Z(t.next)&&Z(t.error)&&Z(t.complete)}function Pj(t){return t&&t instanceof Ss||Rj(t)&&Ih(t)}function s_(t){return Z(t?.lift)}function Y(t){return e=>{if(s_(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function W(t,e,n,r,i){return new o_(t,e,n,r,i)}var o_=class extends Ss{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ho(){return Y((t,e)=>{let n=null;t._refCount++;let r=W(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Go=class extends ne{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,s_(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Xe;let n=this.getSubject();e.add(this.source.subscribe(W(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Xe.EMPTY)}return e}refCount(){return Ho()(this)}};var aS=Uo(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ft=(()=>{class t extends ne{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Dh(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new aS}next(n){$o(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){$o(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){$o(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Zy:(this.currentObservers=null,s.push(n),new Xe(()=>{this.currentObservers=null,bs(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new ne;return n.source=this,n}}return t.create=(e,n)=>new Dh(e,n),t})(),Dh=class extends ft{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Zy}};var St=class extends ft{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var ou={now(){return(ou.delegate||Date).now()},delegate:void 0};var Th=class extends ft{constructor(e=1/0,n=1/0,r=ou){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var Sh=class extends Xe{constructor(e,n){super()}schedule(e,n=0){return this}};var au={setInterval(t,e,...n){let{delegate:r}=au;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=au;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var zo=class extends Sh{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return au.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&au.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,bs(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Wo=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};Wo.now=ou.now;var Ko=class extends Wo{constructor(e,n=Wo.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var Wr=new Ko(zo);var Ah=class extends zo{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var xh=class extends Ko{};var a_=new xh(Ah);var Jt=new ne(t=>t.complete());function cS(t){return t&&Z(t.schedule)}function c_(t){return t[t.length-1]}function Qo(t){return Z(c_(t))?t.pop():void 0}function hr(t){return cS(c_(t))?t.pop():void 0}function uS(t,e){return typeof c_(t)=="number"?t.pop():e}var Mh=t=>t&&typeof t.length=="number"&&typeof t!="function";function Rh(t){return Z(t?.then)}function Ph(t){return Z(t[qo])}function Nh(t){return Symbol.asyncIterator&&Z(t?.[Symbol.asyncIterator])}function kh(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Nj(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Oh=Nj();function Fh(t){return Z(t?.[Oh])}function Lh(t){return FT(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield fh(n.read());if(i)return yield fh(void 0);yield yield fh(r)}}finally{n.releaseLock()}})}function Vh(t){return Z(t?.getReader)}function Te(t){if(t instanceof ne)return t;if(t!=null){if(Ph(t))return kj(t);if(Mh(t))return Oj(t);if(Rh(t))return Fj(t);if(Nh(t))return lS(t);if(Fh(t))return Lj(t);if(Vh(t))return Vj(t)}throw kh(t)}function kj(t){return new ne(e=>{let n=t[qo]();if(Z(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Oj(t){return new ne(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function Fj(t){return new ne(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Ch)})}function Lj(t){return new ne(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function lS(t){return new ne(e=>{jj(t,e).catch(n=>e.error(n))})}function Vj(t){return lS(Lh(t))}function jj(t,e){var n,r,i,s;return OT(this,void 0,void 0,function*(){try{for(n=LT(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function en(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function on(t,e=0){return Y((n,r)=>{n.subscribe(W(r,i=>en(r,t,()=>r.next(i),e),()=>en(r,t,()=>r.complete(),e),i=>en(r,t,()=>r.error(i),e)))})}function Gn(t,e=0){return Y((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function dS(t,e){return Te(t).pipe(Gn(e),on(e))}function hS(t,e){return Te(t).pipe(Gn(e),on(e))}function fS(t,e){return new ne(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function pS(t,e){return new ne(n=>{let r;return en(n,e,()=>{r=t[Oh](),en(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>Z(r?.return)&&r.return()})}function jh(t,e){if(!t)throw new Error("Iterable cannot be null");return new ne(n=>{en(n,e,()=>{let r=t[Symbol.asyncIterator]();en(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function gS(t,e){return jh(Lh(t),e)}function mS(t,e){if(t!=null){if(Ph(t))return dS(t,e);if(Mh(t))return fS(t,e);if(Rh(t))return hS(t,e);if(Nh(t))return jh(t,e);if(Fh(t))return pS(t,e);if(Vh(t))return gS(t,e)}throw kh(t)}function oe(t,e){return e?mS(t,e):Te(t)}function U(...t){let e=hr(t);return oe(t,e)}function Yo(t,e){let n=Z(t)?t:()=>t,r=i=>i.error(n());return new ne(e?i=>e.schedule(r,0,i):r)}function u_(t){return!!t&&(t instanceof ne||Z(t.lift)&&Z(t.subscribe))}var Kr=Uo(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function V(t,e){return Y((n,r)=>{let i=0;n.subscribe(W(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:Uj}=Array;function Bj(t,e){return Uj(e)?t(...e):t(e)}function Uh(t){return V(e=>Bj(t,e))}var{isArray:$j}=Array,{getPrototypeOf:qj,prototype:Hj,keys:Gj}=Object;function Bh(t){if(t.length===1){let e=t[0];if($j(e))return{args:e,keys:null};if(zj(e)){let n=Gj(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function zj(t){return t&&typeof t=="object"&&qj(t)===Hj}function $h(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function cu(...t){let e=hr(t),n=Qo(t),{args:r,keys:i}=Bh(t);if(r.length===0)return oe([],e);let s=new ne(Wj(r,e,i?o=>$h(i,o):Tt));return n?s.pipe(Uh(n)):s}function Wj(t,e,n=Tt){return r=>{yS(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)yS(e,()=>{let u=oe(t[c],e),l=!1;u.subscribe(W(r,d=>{s[c]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function yS(t,e,n){t?en(n,t,e):e()}function _S(t,e,n,r,i,s,o,a){let c=[],u=0,l=0,d=!1,h=()=>{d&&!c.length&&!u&&e.complete()},f=g=>u<r?p(g):c.push(g),p=g=>{s&&e.next(g),u++;let m=!1;Te(n(g,l++)).subscribe(W(e,E=>{i?.(E),s?f(E):e.next(E)},()=>{m=!0},void 0,()=>{if(m)try{for(u--;c.length&&u<r;){let E=c.shift();o?en(e,o,()=>p(E)):p(E)}h()}catch(E){e.error(E)}}))};return t.subscribe(W(e,f,()=>{d=!0,h()})),()=>{a?.()}}function rt(t,e,n=1/0){return Z(e)?rt((r,i)=>V((s,o)=>e(r,s,i,o))(Te(t(r,i))),n):(typeof e=="number"&&(n=e),Y((r,i)=>_S(r,i,t,n)))}function bi(t=1/0){return rt(Tt,t)}function vS(){return bi(1)}function Xo(...t){return vS()(oe(t,hr(t)))}function qh(t){return new ne(e=>{Te(t()).subscribe(e)})}function l_(...t){let e=Qo(t),{args:n,keys:r}=Bh(t),i=new ne(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),c=o,u=o;for(let l=0;l<o;l++){let d=!1;Te(n[l]).subscribe(W(s,h=>{d||(d=!0,u--),a[l]=h},()=>c--,void 0,()=>{(!c||!d)&&(u||s.next(r?$h(r,a):a),s.complete())}))}});return e?i.pipe(Uh(e)):i}function Zo(...t){let e=hr(t),n=uS(t,1/0),r=t;return r.length?r.length===1?Te(r[0]):bi(n)(oe(r,e)):Jt}function yt(t,e){return Y((n,r)=>{let i=0;n.subscribe(W(r,s=>t.call(e,s,i++)&&r.next(s)))})}function Di(t){return Y((e,n)=>{let r=null,i=!1,s;r=e.subscribe(W(n,void 0,void 0,o=>{s=Te(t(o,Di(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function wS(t,e,n,r,i){return(s,o)=>{let a=n,c=e,u=0;s.subscribe(W(o,l=>{let d=u++;c=a?t(c,l,d):(a=!0,l),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function Ti(t,e){return Z(e)?rt(t,e,1):rt(t,1)}function d_(t,e=Wr){return Y((n,r)=>{let i=null,s=null,o=null,a=()=>{if(i){i.unsubscribe(),i=null;let u=s;s=null,r.next(u)}};function c(){let u=o+t,l=e.now();if(l<u){i=this.schedule(void 0,u-l),r.add(i);return}a()}n.subscribe(W(r,u=>{s=u,o=e.now(),i||(i=e.schedule(c,t),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}function Si(t){return Y((e,n)=>{let r=!1;e.subscribe(W(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function zn(t){return t<=0?()=>Jt:Y((e,n)=>{let r=0;e.subscribe(W(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function h_(t){return V(()=>t)}function uu(t,e=Tt){return t=t??Kj,Y((n,r)=>{let i,s=!0;n.subscribe(W(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function Kj(t,e){return t===e}function Hh(t=Qj){return Y((e,n)=>{let r=!1;e.subscribe(W(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function Qj(){return new Kr}function Jo(t){return Y((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function an(t,e){let n=arguments.length>=2;return r=>r.pipe(t?yt((i,s)=>t(i,s,r)):Tt,zn(1),n?Si(e):Hh(()=>new Kr))}function ea(t){return t<=0?()=>Jt:Y((e,n)=>{let r=[];e.subscribe(W(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function f_(t,e){let n=arguments.length>=2;return r=>r.pipe(t?yt((i,s)=>t(i,s,r)):Tt,ea(1),n?Si(e):Hh(()=>new Kr))}function lu(){return Y((t,e)=>{let n,r=!1;t.subscribe(W(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function fr(t,e){return Y(wS(t,e,arguments.length>=2,!0))}function du(t={}){let{connector:e=()=>new ft,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,c,u=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,l=d=!1},p=()=>{let g=o;f(),g?.unsubscribe()};return Y((g,m)=>{u++,!d&&!l&&h();let E=c=c??e();m.add(()=>{u--,u===0&&!d&&!l&&(a=p_(p,i))}),E.subscribe(m),!o&&u>0&&(o=new zr({next:S=>E.next(S),error:S=>{d=!0,h(),a=p_(f,n,S),E.error(S)},complete:()=>{l=!0,h(),a=p_(f,r),E.complete()}}),Te(g).subscribe(o))})(s)}}function p_(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new zr({next:()=>{r.unsubscribe(),t()}});return Te(e(...n)).subscribe(r)}function Gh(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,du({connector:()=>new Th(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function g_(t){return Y((e,n)=>{let r=!1,i=0;e.subscribe(W(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function As(...t){let e=hr(t);return Y((n,r)=>{(e?Xo(t,n,e):Xo(t,n)).subscribe(r)})}function De(t,e){return Y((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(W(r,c=>{i?.unsubscribe();let u=0,l=s++;Te(t(c,l)).subscribe(i=W(r,d=>r.next(e?e(c,d,l,u++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function zh(t,e){return Z(e)?De(()=>t,e):De(()=>t)}function m_(t){return Y((e,n)=>{Te(t).subscribe(W(n,()=>n.complete(),Ds)),!n.closed&&e.subscribe(n)})}function Be(t,e,n){let r=Z(t)||e||n?{next:t,error:e,complete:n}:t;return r?Y((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(W(s,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),s.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):Tt}function y_(...t){let e=Qo(t);return Y((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let c=0;c<i;c++)Te(t[c]).subscribe(W(r,u=>{s[c]=u,!a&&!o[c]&&(o[c]=!0,(a=o.every(Tt))&&(o=null))},Ds));n.subscribe(W(r,c=>{if(a){let u=[c,...s];r.next(e?e(...u):u)}}))})}var Yj="https://g.co/ng/security#xss",B=class extends Error{constructor(e,n){super(Af(e,n)),this.code=e}};function Af(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}var k_=class extends ft{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=__(s),i&&(i=__(i)),o&&(o=__(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Xe&&e.add(a),a}};function __(t){return e=>{setTimeout(t,void 0,e)}}var it=k_;var ue=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ue||{});function Bt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Bt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function ES(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var aA=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(aA||{}),mr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(mr||{});function Tu(t){return{toString:t}.toString()}var un=globalThis;var aa={},cn=[];function Se(t){for(let e in t)if(t[e]===Se)return e;throw Error("Could not find renamed property on target object.")}function Xj(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}var Zj=Se({\u0275cmp:Se}),Jj=Se({\u0275dir:Se}),eU=Se({\u0275pipe:Se}),tU=Se({\u0275mod:Se}),sf=Se({\u0275fac:Se}),fu=Se({__NG_ELEMENT_ID__:Se}),IS=Se({__NG_ENV_ID__:Se}),dn=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(dn||{});function cA(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function O_(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];rU(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function nU(t){return t===3||t===4||t===6}function rU(t){return t.charCodeAt(0)===64}function gu(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?CS(t,n,i,null,e[++r]):CS(t,n,i,null,null))}}return t}function CS(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var uA="ng-template";function iU(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if(typeof s=="string"&&i){let o=t[r++];if(n&&s==="class"&&cA(o.toLowerCase(),e,0)!==-1)return!0}else if(s===1){for(;r<t.length&&typeof(s=t[r++])=="string";)if(s.toLowerCase()===e)return!0;return!1}else typeof s=="number"&&(i=!1)}return!1}function lA(t){return t.type===4&&t.value!==uA}function sU(t,e,n){let r=t.type===4&&!n?uA:t.value;return e===r}function oU(t,e,n){let r=4,i=t.attrs||[],s=uU(i),o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Wn(r)&&!Wn(c))return!1;if(o&&Wn(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!sU(t,c,n)||c===""&&e.length===1){if(Wn(r))return!1;o=!0}}else{let u=r&8?c:e[++a];if(r&8&&t.attrs!==null){if(!iU(t.attrs,u,n)){if(Wn(r))return!1;o=!0}continue}let l=r&8?"class":c,d=aU(l,i,lA(t),n);if(d===-1){if(Wn(r))return!1;o=!0;continue}if(u!==""){let h;d>s?h="":h=i[d+1].toLowerCase();let f=r&8?h:null;if(f&&cA(f,u,0)!==-1||r&2&&u!==h){if(Wn(r))return!1;o=!0}}}}return Wn(r)||o}function Wn(t){return(t&1)===0}function aU(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return lU(e,t)}function cU(t,e,n=!1){for(let r=0;r<e.length;r++)if(oU(t,e[r],n))return!0;return!1}function uU(t){for(let e=0;e<t.length;e++){let n=t[e];if(nU(n))return e}return t.length}function lU(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function bS(t,e){return t?":not("+e.trim()+")":e}function dU(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Wn(o)&&(e+=bS(s,i),i=""),r=o,s=s||!Wn(r);n++}return i!==""&&(e+=bS(s,i)),e}function hU(t){return t.map(dU).join(",")}function fU(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Wn(i))break;i=s}r++}return{attrs:e,classes:n}}function Nt(t){return Tu(()=>{let e=gA(t),n=ye(A({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===aA.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||mr.Emulated,styles:t.styles||cn,_:null,schemas:t.schemas||null,tView:null,id:""});mA(n);let r=t.dependencies;return n.directiveDefs=TS(r,!1),n.pipeDefs=TS(r,!0),n.id=mU(n),n})}function pU(t){return Mi(t)||dA(t)}function gU(t){return t!==null}function Me(t){return Tu(()=>({type:t.type,bootstrap:t.bootstrap||cn,declarations:t.declarations||cn,imports:t.imports||cn,exports:t.exports||cn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function DS(t,e){if(t==null)return aa;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=dn.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==dn.None?[r,a]:r,e[s]=o):n[s]=r}return n}function $t(t){return Tu(()=>{let e=gA(t);return mA(e),e})}function Mi(t){return t[Zj]||null}function dA(t){return t[Jj]||null}function hA(t){return t[eU]||null}function fA(t){let e=Mi(t)||dA(t)||hA(t);return e!==null?e.standalone:!1}function pA(t,e){let n=t[tU]||null;if(!n&&e===!0)throw new Error(`Type ${Bt(t)} does not have '\u0275mod' property.`);return n}function gA(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||aa,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||cn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:DS(t.inputs,e),outputs:DS(t.outputs),debugInfo:null}}function mA(t){t.features?.forEach(e=>e(t))}function TS(t,e){if(!t)return null;let n=e?hA:pU;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(gU)}function mU(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}var hn=0,he=1,X=2,At=3,Kn=4,Xn=5,Yr=6,mu=7,Qn=8,ca=9,Ri=10,st=11,yu=12,SS=13,ga=14,Sn=15,xf=16,ta=17,ua=18,Mf=19,yA=20,xi=21,v_=22,Ms=23,tn=25,_A=1,_u=6,Xr=7,of=8,af=9,ln=10,bv=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(bv||{});function Qr(t){return Array.isArray(t)&&typeof t[_A]=="object"}function _r(t){return Array.isArray(t)&&t[_A]===!0}function vA(t){return(t.flags&4)!==0}function Su(t){return t.componentOffset>-1}function Dv(t){return(t.flags&1)===1}function Pi(t){return!!t.template}function wA(t){return(t[X]&512)!==0}var yU="svg",_U="math",vU=!1;function wU(){return vU}function Yn(t){for(;Array.isArray(t);)t=t[hn];return t}function EA(t,e){return Yn(e[t])}function An(t,e){return Yn(e[t.index])}function IA(t,e){return t.data[e]}function EU(t,e){return t[e]}function ki(t,e){let n=e[t];return Qr(n)?n:n[hn]}function Tv(t){return(t[X]&128)===128}function IU(t){return _r(t[At])}function cf(t,e){return e==null?null:t[e]}function CA(t){t[ta]=0}function CU(t){t[X]&1024||(t[X]|=1024,Tv(t)&&vu(t))}function bU(t,e){for(;t>0;)e=e[ga],t--;return e}function Sv(t){return!!(t[X]&9216||t[Ms]?.dirty)}function F_(t){Sv(t)?vu(t):t[X]&64&&(wU()?(t[X]|=1024,vu(t)):t[Ri].changeDetectionScheduler?.notify())}function vu(t){t[Ri].changeDetectionScheduler?.notify();let e=wu(t);for(;e!==null&&!(e[X]&8192||(e[X]|=8192,!Tv(e)));)e=wu(e)}function bA(t,e){if((t[X]&256)===256)throw new B(911,!1);t[xi]===null&&(t[xi]=[]),t[xi].push(e)}function DU(t,e){if(t[xi]===null)return;let n=t[xi].indexOf(e);n!==-1&&t[xi].splice(n,1)}function wu(t){let e=t[At];return _r(e)?e[At]:e}var le={lFrame:PA(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function TU(){return le.lFrame.elementDepthCount}function SU(){le.lFrame.elementDepthCount++}function AU(){le.lFrame.elementDepthCount--}function DA(){return le.bindingsEnabled}function Au(){return le.skipHydrationRootTNode!==null}function xU(t){return le.skipHydrationRootTNode===t}function MU(t){le.skipHydrationRootTNode=t}function RU(){le.skipHydrationRootTNode=null}function Ze(){return le.lFrame.lView}function vr(){return le.lFrame.tView}function xn(t){return le.lFrame.contextLView=t,t[Qn]}function Mn(t){return le.lFrame.contextLView=null,t}function Rn(){let t=TA();for(;t!==null&&t.type===64;)t=t.parent;return t}function TA(){return le.lFrame.currentTNode}function PU(){let t=le.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function xu(t,e){let n=le.lFrame;n.currentTNode=t,n.isParent=e}function SA(){return le.lFrame.isParent}function NU(){le.lFrame.isParent=!1}function kU(){return le.lFrame.contextLView}function OU(t){return le.lFrame.bindingIndex=t}function AA(){return le.lFrame.bindingIndex++}function FU(t){let e=le.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function LU(){return le.lFrame.inI18n}function VU(t,e){let n=le.lFrame;n.bindingIndex=n.bindingRootIndex=t,L_(e)}function jU(){return le.lFrame.currentDirectiveIndex}function L_(t){le.lFrame.currentDirectiveIndex=t}function UU(t){let e=le.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function xA(t){le.lFrame.currentQueryIndex=t}function BU(t){let e=t[he];return e.type===2?e.declTNode:e.type===1?t[Xn]:null}function MA(t,e,n){if(n&ue.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&ue.Host);)if(i=BU(s),i===null||(s=s[ga],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=le.lFrame=RA();return r.currentTNode=e,r.lView=t,!0}function Av(t){let e=RA(),n=t[he];le.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function RA(){let t=le.lFrame,e=t===null?null:t.child;return e===null?PA(t):e}function PA(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function NA(){let t=le.lFrame;return le.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var kA=NA;function xv(){let t=NA();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function $U(t){return(le.lFrame.contextLView=bU(t,le.lFrame.contextLView))[Qn]}function ma(){return le.lFrame.selectedIndex}function Rs(t){le.lFrame.selectedIndex=t}function qU(){let t=le.lFrame;return IA(t.tView,t.selectedIndex)}function OA(){return le.lFrame.currentNamespace}var FA=!0;function Mv(){return FA}function Oi(t){FA=t}function HU(){return Rf(Rn(),Ze())}function Rf(t,e){return new Ls(An(t,e))}var Ls=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=HU;let t=e;return t})();function Rv(t,e){t.forEach(n=>Array.isArray(n)?Rv(n,e):e(n))}function LA(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function uf(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function GU(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function zU(t,e,n){let r=Mu(t,e);return r>=0?t[r|1]=n:(r=~r,GU(t,r,e,n)),r}function w_(t,e){let n=Mu(t,e);if(n>=0)return t[n|1]}function Mu(t,e){return WU(t,e,1)}function WU(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var KU="ngSkipHydration",QU="ngskiphydration";function VA(t){let e=t.mergedAttrs;if(e===null)return!1;for(let n=0;n<e.length;n+=2){let r=e[n];if(typeof r=="number")return!1;if(typeof r=="string"&&r.toLowerCase()===QU)return!0}return!1}function jA(t){return t.hasAttribute(KU)}function lf(t){return(t.flags&128)===128}function YU(t){if(lf(t))return!0;let e=t.parent;for(;e;){if(lf(t)||VA(e))return!0;e=e.parent}return!1}var V_;function UA(t){V_=t}function Pf(){if(V_!==void 0)return V_;if(typeof document<"u")return document;throw new B(210,!1)}function F(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Re(t){return{providers:t.providers||[],imports:t.imports||[]}}function Nf(t){return AS(t,$A)||AS(t,qA)}function BA(t){return Nf(t)!==null}function AS(t,e){return t.hasOwnProperty(e)?t[e]:null}function XU(t){let e=t&&(t[$A]||t[qA]);return e||null}function xS(t){return t&&(t.hasOwnProperty(MS)||t.hasOwnProperty(ZU))?t[MS]:null}var $A=Se({\u0275prov:Se}),MS=Se({\u0275inj:Se}),qA=Se({ngInjectableDef:Se}),ZU=Se({ngInjectorDef:Se}),x=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=F({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}},Ru=new x("",{providedIn:"root",factory:()=>JU}),JU="ng",Pv=new x(""),ot=new x("",{providedIn:"platform",factory:()=>"unknown"});var Nv=new x("",{providedIn:"root",factory:()=>Pf().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var eB=Se({__forward_ref__:Se});function Vs(t){return t.__forward_ref__=Vs,t.toString=function(){return Bt(this())},t}function Ut(t){return HA(t)?t():t}function HA(t){return typeof t=="function"&&t.hasOwnProperty(eB)&&t.__forward_ref__===Vs}function GA(t){return t&&!!t.\u0275providers}function zA(t){return typeof t=="string"?t:t==null?"":String(t)}function tB(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():zA(t)}function nB(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new B(-200,t)}function kv(t,e){throw new B(-201,!1)}var j_;function WA(){return j_}function Tn(t){let e=j_;return j_=t,e}function KA(t,e,n){let r=Nf(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ue.Optional)return null;if(e!==void 0)return e;kv(t,"Injector")}var rB={},Eu=rB,U_="__NG_DI_FLAG__",df="ngTempTokenPath",iB="ngTokenPath",sB=/\n/gm,oB="\u0275",RS="__source",sa;function aB(){return sa}function Ai(t){let e=sa;return sa=t,e}function cB(t,e=ue.Default){if(sa===void 0)throw new B(-203,!1);return sa===null?KA(t,void 0,e):sa.get(t,e&ue.Optional?null:void 0,e)}function w(t,e=ue.Default){return(WA()||cB)(Ut(t),e)}function T(t,e=ue.Default){return w(t,kf(e))}function kf(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function B_(t){let e=[];for(let n=0;n<t.length;n++){let r=Ut(t[n]);if(Array.isArray(r)){if(r.length===0)throw new B(900,!1);let i,s=ue.Default;for(let o=0;o<r.length;o++){let a=r[o],c=uB(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(w(i,s))}else e.push(w(r))}return e}function QA(t,e){return t[U_]=e,t.prototype[U_]=e,t}function uB(t){return t[U_]}function lB(t,e,n,r){let i=t[df];throw e[RS]&&i.unshift(e[RS]),t.message=dB(`
`+t.message,i,n,r),t[iB]=i,t[df]=null,t}function dB(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==oB?t.slice(2):t;let i=Bt(e);if(Array.isArray(e))i=e.map(Bt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Bt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(sB,`
  `)}`}function hB(){let t=new js;return T(ot)==="browser"&&(t.store=fB(Pf(),T(Ru))),t}var js=(()=>{let e=class e{constructor(){this.store={},this.onSerializeCallbacks={}}get(r,i){return this.store[r]!==void 0?this.store[r]:i}set(r,i){this.store[r]=i}remove(r){delete this.store[r]}hasKey(r){return this.store.hasOwnProperty(r)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(r,i){this.onSerializeCallbacks[r]=i}toJson(){for(let r in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(r))try{this.store[r]=this.onSerializeCallbacks[r]()}catch(i){console.warn("Exception in onSerialize callback: ",i)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}};e.\u0275prov=F({token:e,providedIn:"root",factory:hB});let t=e;return t})();function fB(t,e){let n=t.getElementById(e+"-state");if(n?.textContent)try{return JSON.parse(n.textContent)}catch(r){console.warn("Exception while restoring TransferState for app "+e,r)}return{}}var YA="h",XA="b",$_=function(t){return t.FirstChild="f",t.NextSibling="n",t}($_||{}),pB="e",gB="t",Ov="c",ZA="x",hf="r",mB="i",yB="n",_B="d",vB="__nghData__",JA=vB,E_="ngh",wB="nghm",ex=()=>null;function EB(t,e,n=!1){let r=t.getAttribute(E_);if(r==null)return null;let[i,s]=r.split("|");if(r=n?s:i,!r)return null;let o=s?`|${s}`:"",a=n?i:o,c={};if(r!==""){let l=e.get(js,null,{optional:!0});l!==null&&(c=l.get(JA,[])[Number(r)])}let u={data:c,firstChild:t.firstChild??null};return n&&(u.firstChild=t,Of(u,0,t.nextSibling)),a?t.setAttribute(E_,a):t.removeAttribute(E_),u}function IB(){ex=EB}function Fv(t,e,n=!1){return ex(t,e,n)}function CB(t){let e=t._lView;return e[he].type===2?null:(wA(e)&&(e=e[tn]),e)}function bB(t){return t.textContent?.replace(/\s/gm,"")}function DB(t){let e=Pf(),n=e.createNodeIterator(t,NodeFilter.SHOW_COMMENT,{acceptNode(s){let o=bB(s);return o==="ngetn"||o==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),r,i=[];for(;r=n.nextNode();)i.push(r);for(let s of i)s.textContent==="ngetn"?s.replaceWith(e.createTextNode("")):s.remove()}function Of(t,e,n){t.segmentHeads??={},t.segmentHeads[e]=n}function q_(t,e){return t.segmentHeads?.[e]??null}function TB(t,e){let n=t.data,r=n[pB]?.[e]??null;return r===null&&n[Ov]?.[e]&&(r=Lv(t,e)),r}function tx(t,e){return t.data[Ov]?.[e]??null}function Lv(t,e){let n=tx(t,e)??[],r=0;for(let i of n)r+=i[hf]*(i[ZA]??1);return r}function Ff(t,e){if(typeof t.disconnectedNodes>"u"){let n=t.data[_B];t.disconnectedNodes=n?new Set(n):null}return!!t.disconnectedNodes?.has(e)}var Wh="__parameters__";function SB(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function nx(t,e,n){return Tu(()=>{let r=SB(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,u,l){let d=c.hasOwnProperty(Wh)?c[Wh]:Object.defineProperty(c,Wh,{value:[]})[Wh];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),c}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var ya=QA(nx("Optional"),8);var Vv=QA(nx("SkipSelf"),4);function la(t,e){let n=t.hasOwnProperty(sf);return n?t[sf]:null}var Ps=new x(""),rx=new x("",-1),ix=new x(""),ff=class{get(e,n=Eu){if(n===Eu){let r=new Error(`NullInjectorError: No provider for ${Bt(e)}!`);throw r.name="NullInjectorError",r}return n}};function Pu(t){return{\u0275providers:t}}function AB(...t){return{\u0275providers:sx(!0,t),\u0275fromNgModule:!0}}function sx(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return Rv(e,o=>{let a=o;H_(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&ox(i,s),n}function ox(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];jv(i,s=>{e(s,r)})}}function H_(t,e,n,r){if(t=Ut(t),!t)return!1;let i=null,s=xS(t),o=!s&&Mi(t);if(!s&&!o){let c=t.ngModule;if(s=xS(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let u of c)H_(u,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let u;try{Rv(s.imports,l=>{H_(l,e,n,r)&&(u||=[],u.push(l))})}finally{}u!==void 0&&ox(u,e)}if(!a){let u=la(i)||(()=>new i);e({provide:i,useFactory:u,deps:cn},i),e({provide:ix,useValue:i,multi:!0},i),e({provide:Ps,useValue:()=>w(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let u=t;jv(c,l=>{e(l,u)})}}else return!1;return i!==t&&t.providers!==void 0}function jv(t,e){for(let n of t)GA(n)&&(n=n.\u0275providers),Array.isArray(n)?jv(n,e):e(n)}var xB=Se({provide:String,useValue:Se});function ax(t){return t!==null&&typeof t=="object"&&xB in t}function MB(t){return!!(t&&t.useExisting)}function RB(t){return!!(t&&t.useFactory)}function da(t){return typeof t=="function"}function PB(t){return!!t.useClass}var Lf=new x(""),Jh={},NB={},I_;function Uv(){return I_===void 0&&(I_=new ff),I_}var fn=class{},Iu=class extends fn{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,z_(e,o=>this.processProvider(o)),this.records.set(rx,na(void 0,this)),i.has("environment")&&this.records.set(fn,na(void 0,this));let s=this.records.get(Lf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(ix,cn,ue.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=Ai(this),r=Tn(void 0),i;try{return e()}finally{Ai(n),Tn(r)}}get(e,n=Eu,r=ue.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(IS))return e[IS](this);r=kf(r);let i,s=Ai(this),o=Tn(void 0);try{if(!(r&ue.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=VB(e)&&Nf(e);u&&this.injectableDefInScope(u)?c=na(G_(e),Jh):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ue.Self?Uv():this.parent;return n=r&ue.Optional&&n===Eu?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[df]=a[df]||[]).unshift(Bt(e)),s)throw a;return lB(a,e,"R3InjectorError",this.source)}else throw a}finally{Tn(o),Ai(s)}}resolveInjectorInitializers(){let e=Ai(this),n=Tn(void 0),r;try{let i=this.get(Ps,cn,ue.Self);for(let s of i)s()}finally{Ai(e),Tn(n)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Bt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new B(205,!1)}processProvider(e){e=Ut(e);let n=da(e)?e:Ut(e&&e.provide),r=OB(e);if(!da(e)&&e.multi===!0){let i=this.records.get(n);i||(i=na(void 0,Jh,!0),i.factory=()=>B_(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===Jh&&(n.value=NB,n.value=n.factory()),typeof n.value=="object"&&n.value&&LB(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Ut(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function G_(t){let e=Nf(t),n=e!==null?e.factory:la(t);if(n!==null)return n;if(t instanceof x)throw new B(204,!1);if(t instanceof Function)return kB(t);throw new B(204,!1)}function kB(t){if(t.length>0)throw new B(204,!1);let n=XU(t);return n!==null?()=>n.factory(t):()=>new t}function OB(t){if(ax(t))return na(void 0,t.useValue);{let e=cx(t);return na(e,Jh)}}function cx(t,e,n){let r;if(da(t)){let i=Ut(t);return la(i)||G_(i)}else if(ax(t))r=()=>Ut(t.useValue);else if(RB(t))r=()=>t.useFactory(...B_(t.deps||[]));else if(MB(t))r=()=>w(Ut(t.useExisting));else{let i=Ut(t&&(t.useClass||t.provide));if(FB(t))r=()=>new i(...B_(t.deps));else return la(i)||G_(i)}return r}function na(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function FB(t){return!!t.deps}function LB(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function VB(t){return typeof t=="function"||typeof t=="object"&&t instanceof x}function z_(t,e){for(let n of t)Array.isArray(n)?z_(n,e):n&&GA(n)?z_(n.\u0275providers,e):e(n)}function ei(t,e){t instanceof Iu&&t.assertNotDestroyed();let n,r=Ai(t),i=Tn(void 0);try{return e()}finally{Ai(r),Tn(i)}}function jB(t){if(!WA()&&!aB())throw new B(-203,!1)}function UB(t){let e=un.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function BB(t){return typeof t=="function"}var W_=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function ux(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function Us(){return lx}function lx(t){return t.type.prototype.ngOnChanges&&(t.setInput=qB),$B}Us.ngInherit=!0;function $B(){let t=hx(this),e=t?.current;if(e){let n=t.previous;if(n===aa)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function qB(t,e,n,r,i){let s=this.declaredInputs[r],o=hx(t)||HB(t,{previous:aa,current:null}),a=o.current||(o.current={}),c=o.previous,u=c[s];a[s]=new W_(u&&u.currentValue,n,c===aa),ux(t,e,i,n)}var dx="__ngSimpleChanges__";function hx(t){return t[dx]||null}function HB(t,e){return t[dx]=e}var PS=null;var pr=function(t,e,n){PS?.(t,e,n)};function GB(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=lx(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function Bv(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),u&&((t.viewHooks??=[]).push(n,u),(t.viewCheckHooks??=[]).push(n,u)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function ef(t,e,n){fx(t,e,3,n)}function tf(t,e,n,r){(t[X]&3)===n&&fx(t,e,n,r)}function C_(t,e){let n=t[X];(n&3)===e&&(n&=16383,n+=1,t[X]=n)}function fx(t,e,n,r){let i=r!==void 0?t[ta]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[ta]+=65536),(a<s||s==-1)&&(zB(t,n,e,c),t[ta]=(t[ta]&4294901760)+c+2),c++}function NS(t,e){pr(4,t,e);let n=sn(null);try{e.call(t)}finally{sn(n),pr(5,t,e)}}function zB(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[X]>>14<t[ta]>>16&&(t[X]&3)===e&&(t[X]+=16384,NS(a,s)):NS(a,s)}var oa=-1,Ns=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function WB(t){return t instanceof Ns}function KB(t){return(t.flags&8)!==0}function QB(t){return(t.flags&16)!==0}function px(t){return t!==oa}function pf(t){return t&32767}function YB(t){return t>>16}function gf(t,e){let n=YB(t),r=e;for(;n>0;)r=r[ga],n--;return r}var K_=!0;function kS(t){let e=K_;return K_=t,e}var XB=256,gx=XB-1,mx=5,ZB=0,gr={};function JB(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(fu)&&(r=n[fu]),r==null&&(r=n[fu]=ZB++);let i=r&gx,s=1<<i;e.data[t+(i>>mx)]|=s}function mf(t,e){let n=yx(t,e);if(n!==-1)return n;let r=e[he];r.firstCreatePass&&(t.injectorIndex=e.length,b_(r.data,t),b_(e,null),b_(r.blueprint,null));let i=$v(t,e),s=t.injectorIndex;if(px(i)){let o=pf(i),a=gf(i,e),c=a[he].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|c[o+u]}return e[s+8]=i,s}function b_(t,e){t.push(0,0,0,0,0,0,0,0,e)}function yx(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function $v(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=Ix(i),r===null)return oa;if(n++,i=i[ga],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return oa}function Q_(t,e,n){JB(t,e,n)}function _x(t,e,n){if(n&ue.Optional||t!==void 0)return t;kv(e,"NodeInjector")}function vx(t,e,n,r){if(n&ue.Optional&&r===void 0&&(r=null),!(n&(ue.Self|ue.Host))){let i=t[ca],s=Tn(void 0);try{return i?i.get(e,r,n&ue.Optional):KA(e,r,n&ue.Optional)}finally{Tn(s)}}return _x(r,e,n)}function wx(t,e,n,r=ue.Default,i){if(t!==null){if(e[X]&2048&&!(r&ue.Self)){let o=i$(t,e,n,r,gr);if(o!==gr)return o}let s=Ex(t,e,n,r,gr);if(s!==gr)return s}return vx(e,n,r,i)}function Ex(t,e,n,r,i){let s=n$(n);if(typeof s=="function"){if(!MA(e,t,r))return r&ue.Host?_x(i,n,r):vx(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&ue.Optional))kv(n);else return o}finally{kA()}}else if(typeof s=="number"){let o=null,a=yx(t,e),c=oa,u=r&ue.Host?e[Sn][Xn]:null;for((a===-1||r&ue.SkipSelf)&&(c=a===-1?$v(t,e):e[a+8],c===oa||!FS(r,!1)?a=-1:(o=e[he],a=pf(c),e=gf(c,e)));a!==-1;){let l=e[he];if(OS(s,a,l.data)){let d=e$(a,e,n,o,r,u);if(d!==gr)return d}c=e[a+8],c!==oa&&FS(r,e[he].data[a+8]===u)&&OS(s,a,e)?(o=l,a=pf(c),e=gf(c,e)):a=-1}}return i}function e$(t,e,n,r,i,s){let o=e[he],a=o.data[t+8],c=r==null?Su(a)&&K_:r!=o&&(a.type&3)!==0,u=i&ue.Host&&s===a,l=t$(a,o,n,c,u);return l!==null?ha(e,o,l,a):gr}function t$(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,c=t.directiveStart,u=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:u;for(let f=d;f<h;f++){let p=o[f];if(f<c&&n===p||f>=c&&p.type===n)return f}if(i){let f=o[c];if(f&&Pi(f)&&f.type===n)return c}return null}function ha(t,e,n,r){let i=t[n],s=e.data;if(WB(i)){let o=i;o.resolving&&nB(tB(s[n]));let a=kS(o.canSeeViewProviders);o.resolving=!0;let c,u=o.injectImpl?Tn(o.injectImpl):null,l=MA(t,r,ue.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&GB(n,s[n],e)}finally{u!==null&&Tn(u),kS(a),o.resolving=!1,kA()}}return i}function n$(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(fu)?t[fu]:void 0;return typeof e=="number"?e>=0?e&gx:r$:e}function OS(t,e,n){let r=1<<t;return!!(n[e+(t>>mx)]&r)}function FS(t,e){return!(t&ue.Self)&&!(t&ue.Host&&e)}var xs=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return wx(this._tNode,this._lView,e,kf(r),n)}};function r$(){return new xs(Rn(),Ze())}function _a(t){return Tu(()=>{let e=t.prototype.constructor,n=e[sf]||Y_(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[sf]||Y_(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Y_(t){return HA(t)?()=>{let e=Y_(Ut(t));return e&&e()}:la(t)}function i$(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[X]&2048&&!(o[X]&512);){let a=Ex(s,o,n,r|ue.Self,gr);if(a!==gr)return a;let c=s.parent;if(!c){let u=o[yA];if(u){let l=u.get(n,gr,r);if(l!==gr)return l}c=Ix(o),o=o[ga]}s=c}return i}function Ix(t){let e=t[he],n=e.type;return n===2?e.declTNode:n===1?t[Xn]:null}function LS(t,e=null,n=null,r){let i=Cx(t,e,n,r);return i.resolveInjectorInitializers(),i}function Cx(t,e=null,n=null,r,i=new Set){let s=[n||cn,AB(t)];return r=r||(typeof t=="object"?void 0:Bt(t)),new Iu(s,e||Uv(),r||null,i)}var Pn=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return LS({name:""},i,r,"");{let s=r.name??"";return LS({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Eu,e.NULL=new ff,e.\u0275prov=F({token:e,providedIn:"any",factory:()=>w(rx)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})(),s$="ngOriginalError";function D_(t){return t[s$]}var yr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&D_(e);for(;n&&D_(n);)n=D_(n);return n||null}},bx=new x("",{providedIn:"root",factory:()=>T(yr).handleError.bind(void 0)}),Kh=new x(""),Dx=!1,Tx=new x("",{providedIn:"root",factory:()=>Dx});var X_=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Yj})`}};function qv(t){return t instanceof X_?t.changingThisBreaksApplicationSecurity:t}var o$=/^>|^->|<!--|-->|--!>|<!-$/g,a$=/(<|>)/g,c$="\u200B$1\u200B";function u$(t){return t.replace(o$,e=>e.replace(a$,c$))}var Sx=new Map,l$=0;function d$(){return l$++}function h$(t){Sx.set(t[Mf],t)}function f$(t){Sx.delete(t[Mf])}var VS="__ngContext__";function ks(t,e){Qr(e)?(t[VS]=e[Mf],h$(e)):t[VS]=e}function p$(t){return t.ownerDocument.body}function Ax(t){return t instanceof Function?t():t}function hu(t){return(t??T(Pn)).get(ot)==="browser"}var Zr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Zr||{}),g$;function Hv(t,e){return g$(t,e)}function ra(t,e,n,r,i){if(r!=null){let s,o=!1;_r(r)?s=r:Qr(r)&&(o=!0,r=r[hn]);let a=Yn(r);t===0&&n!==null?i==null?kx(e,n,a):yf(e,n,a,i||null,!0):t===1&&n!==null?yf(e,n,a,i||null,!0):t===2?Fx(e,a,o):t===3&&e.destroyNode(a),s!=null&&P$(e,t,s,n,i)}}function xx(t,e){return t.createText(e)}function m$(t,e,n){t.setValue(e,n)}function Mx(t,e){return t.createComment(u$(e))}function Gv(t,e,n){return t.createElement(e,n)}function y$(t,e){Rx(t,e),e[hn]=null,e[Xn]=null}function _$(t,e,n,r,i,s){r[hn]=i,r[Xn]=e,Vf(t,r,n,1,i,s)}function Rx(t,e){Vf(t,e,e[st],2,null,null)}function v$(t){let e=t[yu];if(!e)return T_(t[he],t);for(;e;){let n=null;if(Qr(e))n=e[yu];else{let r=e[ln];r&&(n=r)}if(!n){for(;e&&!e[Kn]&&e!==t;)Qr(e)&&T_(e[he],e),e=e[At];e===null&&(e=t),Qr(e)&&T_(e[he],e),n=e&&e[Kn]}e=n}}function w$(t,e,n,r){let i=ln+r,s=n.length;r>0&&(n[i-1][Kn]=e),r<s-ln?(e[Kn]=n[i],LA(n,ln+r,e)):(n.push(e),e[Kn]=null),e[At]=n;let o=e[xf];o!==null&&n!==o&&E$(o,e);let a=e[ua];a!==null&&a.insertView(t),F_(e),e[X]|=128}function E$(t,e){let n=t[af],i=e[At][At][Sn];e[Sn]!==i&&(t[X]|=bv.HasTransplantedViews),n===null?t[af]=[e]:n.push(e)}function Px(t,e){let n=t[af],r=n.indexOf(e);n.splice(r,1)}function Z_(t,e){if(t.length<=ln)return;let n=ln+e,r=t[n];if(r){let i=r[xf];i!==null&&i!==t&&Px(i,r),e>0&&(t[n-1][Kn]=r[Kn]);let s=uf(t,ln+e);y$(r[he],r);let o=s[ua];o!==null&&o.detachView(s[he]),r[At]=null,r[Kn]=null,r[X]&=-129}return r}function Nx(t,e){if(!(e[X]&256)){let n=e[st];n.destroyNode&&Vf(t,e,n,3,null,null),v$(e)}}function T_(t,e){if(!(e[X]&256)){e[X]&=-129,e[X]|=256,e[Ms]&&JT(e[Ms]),C$(t,e),I$(t,e),e[he].type===1&&e[st].destroy();let n=e[xf];if(n!==null&&_r(e[At])){n!==e[At]&&Px(n,e);let r=e[ua];r!==null&&r.detachView(t)}f$(e)}}function I$(t,e){let n=t.cleanup,r=e[mu];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[mu]=null);let i=e[xi];if(i!==null){e[xi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function C$(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Ns)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];pr(4,a,c);try{c.call(a)}finally{pr(5,a,c)}}else{pr(4,i,s);try{s.call(i)}finally{pr(5,i,s)}}}}}function b$(t,e,n){return D$(t,e.parent,n)}function D$(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[hn];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===mr.None||s===mr.Emulated)return null}return An(r,n)}}function yf(t,e,n,r,i){t.insertBefore(e,n,r,i)}function kx(t,e,n){t.appendChild(e,n)}function jS(t,e,n,r,i){r!==null?yf(t,e,n,r,i):kx(t,e,n)}function T$(t,e,n,r){t.removeChild(e,n,r)}function zv(t,e){return t.parentNode(e)}function S$(t,e){return t.nextSibling(e)}function A$(t,e,n){return M$(t,e,n)}function x$(t,e,n){return t.type&40?An(t,n):null}var M$=x$,US;function Wv(t,e,n,r){let i=b$(t,r,e),s=e[st],o=r.parent||e[Xn],a=A$(o,r,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)jS(s,i,n[c],a,!1);else jS(s,i,n,a,!1);US!==void 0&&US(s,r,e,n,i)}function nf(t,e){if(e!==null){let n=e.type;if(n&3)return An(e,t);if(n&4)return J_(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return nf(t,r);{let i=t[e.index];return _r(i)?J_(-1,i):Yn(i)}}else{if(n&32)return Hv(e,t)()||Yn(t[e.index]);{let r=Ox(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=wu(t[Sn]);return nf(i,r)}else return nf(t,e.next)}}}return null}function Ox(t,e){if(e!==null){let r=t[Sn][Xn],i=e.projection;return r.projection[i]}return null}function J_(t,e){let n=ln+t+1;if(n<e.length){let r=e[n],i=r[he].firstChild;if(i!==null)return nf(r,i)}return e[Xr]}function Fx(t,e,n){let r=zv(t,e);r&&T$(t,r,e,n)}function Lx(t){t.textContent=""}function Kv(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],c=n.type;if(o&&e===0&&(a&&ks(Yn(a),r),n.flags|=2),(n.flags&32)!==32)if(c&8)Kv(t,e,n.child,r,i,s,!1),ra(e,t,i,a,s);else if(c&32){let u=Hv(n,r),l;for(;l=u();)ra(e,t,i,l,s);ra(e,t,i,a,s)}else c&16?R$(t,e,r,n,i,s):ra(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Vf(t,e,n,r,i,s){Kv(n,r,t.firstChild,e,i,s,!1)}function R$(t,e,n,r,i,s){let o=n[Sn],c=o[Xn].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let l=c[u];ra(e,t,i,l,s)}else{let u=c,l=o[At];lf(r)&&(u.flags|=128),Kv(t,e,u,l,i,s,!0)}}function P$(t,e,n,r,i){let s=n[Xr],o=Yn(n);s!==o&&ra(e,t,r,s,i);for(let a=ln;a<n.length;a++){let c=n[a];Vf(c[he],c,t,e,r,s)}}function N$(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Zr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Zr.Important),t.setStyle(n,r,i,s))}}function k$(t,e,n){t.setAttribute(e,"style",n)}function Vx(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function jx(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&O_(t,e,r),i!==null&&Vx(t,e,i),s!==null&&k$(t,e,s)}var va={};function pn(t=1){Ux(vr(),Ze(),ma()+t,!1)}function Ux(t,e,n,r){if(!r)if((e[X]&3)===3){let s=t.preOrderCheckHooks;s!==null&&ef(e,s,n)}else{let s=t.preOrderHooks;s!==null&&tf(e,s,0,n)}Rs(n)}function K(t,e=ue.Default){let n=Ze();if(n===null)return w(t,e);let r=Rn();return wx(r,n,Ut(t),e)}function Bx(){let t="invalid";throw new Error(t)}function $x(t,e,n,r,i,s){let o=sn(null);try{let a=null;i&dn.SignalBased&&(a=e[r][QT]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&dn.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):ux(e,a,r,s)}finally{sn(o)}}function O$(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)Rs(~i);else{let s=i,o=n[++r],a=n[++r];VU(o,s);let c=e[s];a(2,c)}}}finally{Rs(-1)}}function jf(t,e,n,r,i,s,o,a,c,u,l){let d=e.blueprint.slice();return d[hn]=i,d[X]=r|4|128|8|64,(u!==null||t&&t[X]&2048)&&(d[X]|=2048),CA(d),d[At]=d[ga]=t,d[Qn]=n,d[Ri]=o||t&&t[Ri],d[st]=a||t&&t[st],d[ca]=c||t&&t[ca]||null,d[Xn]=s,d[Mf]=d$(),d[Yr]=l,d[yA]=u,d[Sn]=e.type==2?t[Sn]:d,d}function Uf(t,e,n,r,i){let s=t.data[e];if(s===null)s=F$(t,e,n,r,i),LU()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=PU();s.injectorIndex=o===null?-1:o.injectorIndex}return xu(s,!0),s}function F$(t,e,n,r,i){let s=TA(),o=SA(),a=o?s:s&&s.parent,c=t.data[e]=$$(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function qx(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function Hx(t,e,n,r,i){let s=ma(),o=r&2;try{Rs(-1),o&&e.length>tn&&Ux(t,e,tn,!1),pr(o?2:0,i),n(r,i)}finally{Rs(s),pr(o?3:1,i)}}function Gx(t,e,n){if(vA(e)){let r=sn(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let c=n[o];a.contentQueries(1,c,o)}}}finally{sn(r)}}}function zx(t,e,n){DA()&&(Q$(t,e,n,An(n,e)),(n.flags&64)===64&&Zx(t,e,n))}function Wx(t,e,n=An){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function Kx(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=Qv(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function Qv(t,e,n,r,i,s,o,a,c,u,l){let d=tn+r,h=d+i,f=L$(d,h),p=typeof u=="function"?u():u;return f[he]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:l}}function L$(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:va);return n}function V$(t,e,n,r){let s=r.get(Tx,Dx)||n===mr.ShadowDom,o=t.selectRootElement(e,s);return j$(o),o}function j$(t){Qx(t)}var Qx=()=>null;function U$(t){jA(t)?Lx(t):DB(t)}function B$(){Qx=U$}function $$(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return Au()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function BS(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=dn.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let u=s;if(i!==null){if(!i.hasOwnProperty(s))continue;u=i[s]}t===0?$S(r,n,u,a,c):$S(r,n,u,a)}return r}function $S(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function q$(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],c=null,u=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;c=BS(0,d.inputs,l,c,f),u=BS(1,d.outputs,l,u,p);let g=c!==null&&o!==null&&!lA(e)?i4(c,l,o):null;a.push(g)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=u}function H$(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function G$(t,e,n,r,i,s,o,a){let c=An(e,n),u=e.inputs,l;!a&&u!=null&&(l=u[r])?(Yv(t,n,l,r,i),Su(e)&&z$(n,e.index)):e.type&3?(r=H$(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function z$(t,e){let n=ki(e,t);n[X]&16||(n[X]|=64)}function Yx(t,e,n,r){if(DA()){let i=r===null?null:{"":-1},s=X$(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&Xx(t,e,n,o,i,a),i&&Z$(n,r,i)}n.mergedAttrs=gu(n.mergedAttrs,n.attrs)}function Xx(t,e,n,r,i,s){for(let u=0;u<r.length;u++)Q_(mf(n,e),t,r[u].type);e4(n,t.data.length,r.length);for(let u=0;u<r.length;u++){let l=r[u];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,c=qx(t,e,r.length,null);for(let u=0;u<r.length;u++){let l=r[u];n.mergedAttrs=gu(n.mergedAttrs,l.hostAttrs),t4(t,n,e,c,l),J$(c,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}q$(t,n,s)}function W$(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;K$(o)!=a&&o.push(a),o.push(n,r,s)}}function K$(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function Q$(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;Su(n)&&n4(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||mf(n,e),ks(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let c=t.data[a],u=ha(e,t,a,n);if(ks(u,e),o!==null&&r4(e,a-i,u,c,n,o),Pi(c)){let l=ki(n.index,e);l[Qn]=ha(e,t,a,n)}}}function Zx(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=jU();try{Rs(s);for(let a=r;a<i;a++){let c=t.data[a],u=e[a];L_(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&Y$(c,u)}}finally{Rs(-1),L_(o)}}function Y$(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function X$(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(cU(e,o.selectors,!1))if(r||(r=[]),Pi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;ev(t,e,c)}else r.unshift(o),ev(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function ev(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function Z$(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new B(-301,!1);r.push(e[i],s)}}}function J$(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Pi(e)&&(n[""]=t)}}function e4(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function t4(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=la(i.type,!0)),o=new Ns(s,Pi(i),K);t.blueprint[r]=o,n[r]=o,W$(t,e,r,qx(t,n,i.hostVars,va),i)}function n4(t,e,n){let r=An(e,t),i=Kx(n),s=t[Ri].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=Bf(t,jf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function r4(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],u=o[a++],l=o[a++],d=o[a++];$x(r,n,c,u,l,d)}}function i4(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function Jx(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function eM(t,e){let n=t.contentQueries;if(n!==null){let r=sn(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];xA(s),a.contentQueries(2,e[o],o)}}}finally{sn(r)}}}function Bf(t,e){return t[yu]?t[SS][Kn]=e:t[yu]=e,t[SS]=e,e}function tv(t,e,n){xA(0);let r=sn(null);try{e(t,n)}finally{sn(r)}}function s4(t){return t[mu]||(t[mu]=[])}function o4(t){return t.cleanup||(t.cleanup=[])}function tM(t,e){let n=t[ca],r=n?n.get(yr,null):null;r&&r.handleError(e)}function Yv(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],c=n[s++],u=e[o],l=t.data[o];$x(l,u,r,a,c,i)}}function a4(t,e,n){let r=EA(e,t);m$(t[st],r,n)}function c4(t,e){let n=ki(e,t),r=n[he];u4(r,n);let i=n[hn];i!==null&&n[Yr]===null&&(n[Yr]=Fv(i,n[ca])),Xv(r,n,n[Qn])}function u4(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function Xv(t,e,n){Av(e);try{let r=t.viewQuery;r!==null&&tv(1,r,n);let i=t.template;i!==null&&Hx(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[ua]?.finishViewCreation(t),t.staticContentQueries&&eM(t,e),t.staticViewQueries&&tv(2,t.viewQuery,n);let s=t.components;s!==null&&l4(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[X]&=-5,xv()}}function l4(t,e){for(let n=0;n<e.length;n++)c4(t,e[n])}function d4(t,e,n,r){let i=e.tView,o=t[X]&4096?4096:16,a=jf(t,i,n,o,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),c=t[e.index];a[xf]=c;let u=t[ua];return u!==null&&(a[ua]=u.createEmbeddedView(i)),Xv(i,a,n),a}function qS(t,e){return!e||e.firstChild===null||lf(t)}function h4(t,e,n,r=!0){let i=e[he];if(w$(i,e,t,n),r){let o=J_(n,t),a=e[st],c=zv(a,t[Xr]);c!==null&&_$(i,t[Xn],a,e,c,o)}let s=e[Yr];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function _f(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(Yn(s)),_r(s)&&f4(s,r);let o=n.type;if(o&8)_f(t,e,n.child,r);else if(o&32){let a=Hv(n,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=Ox(e,n);if(Array.isArray(a))r.push(...a);else{let c=wu(e[Sn]);_f(c[he],c,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function f4(t,e){for(let n=ln;n<t.length;n++){let r=t[n],i=r[he].firstChild;i!==null&&_f(r[he],r,i,e)}t[Xr]!==t[hn]&&e.push(t[Xr])}var nM=[];function p4(t){return t[Ms]??g4(t)}function g4(t){let e=nM.pop()??Object.create(y4);return e.lView=t,e}function m4(t){t.lView[Ms]!==t&&(t.lView=null,nM.push(t))}var y4=ye(A({},YT),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{vu(t.lView)},consumerOnSignalRead(){this.lView[Ms]=this}});function rM(t){return sM(t[yu])}function iM(t){return sM(t[Kn])}function sM(t){for(;t!==null&&!_r(t);)t=t[Kn];return t}var oM=100;function aM(t,e=!0,n=0){let r=t[Ri],i=r.rendererFactory,s=!1;s||i.begin?.();try{_4(t,n)}catch(o){throw e&&tM(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function _4(t,e){nv(t,e);let n=0;for(;Sv(t);){if(n===oM)throw new B(103,!1);n++,nv(t,1)}}function v4(t,e,n,r){let i=e[X];if((i&256)===256)return;let s=!1;!s&&e[Ri].inlineEffectRunner?.flush(),Av(e);let o=null,a=null;!s&&w4(t)&&(a=p4(e),o=XT(a));try{CA(e),OU(t.bindingStartIndex),n!==null&&Hx(t,e,n,2,r);let c=(i&3)===3;if(!s)if(c){let d=t.preOrderCheckHooks;d!==null&&ef(e,d,null)}else{let d=t.preOrderHooks;d!==null&&tf(e,d,0,null),C_(e,0)}if(E4(e),cM(e,0),t.contentQueries!==null&&eM(t,e),!s)if(c){let d=t.contentCheckHooks;d!==null&&ef(e,d)}else{let d=t.contentHooks;d!==null&&tf(e,d,1),C_(e,1)}O$(t,e);let u=t.components;u!==null&&lM(e,u,0);let l=t.viewQuery;if(l!==null&&tv(2,l,r),!s)if(c){let d=t.viewCheckHooks;d!==null&&ef(e,d)}else{let d=t.viewHooks;d!==null&&tf(e,d,2),C_(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[v_]){for(let d of e[v_])d();e[v_]=null}s||(e[X]&=-73)}catch(c){throw vu(e),c}finally{a!==null&&(ZT(a,o),m4(a)),xv()}}function w4(t){return t.type!==2}function cM(t,e){for(let n=rM(t);n!==null;n=iM(n))for(let r=ln;r<n.length;r++){let i=n[r];uM(i,e)}}function E4(t){for(let e=rM(t);e!==null;e=iM(e)){if(!(e[X]&bv.HasTransplantedViews))continue;let n=e[af];for(let r=0;r<n.length;r++){let i=n[r],s=i[At];CU(i)}}}function I4(t,e,n){let r=ki(e,t);uM(r,n)}function uM(t,e){Tv(t)&&nv(t,e)}function nv(t,e){let r=t[he],i=t[X],s=t[Ms],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Qy(s)),s&&(s.dirty=!1),t[X]&=-9217,o)v4(r,t,r.template,t[Qn]);else if(i&8192){cM(t,1);let a=r.components;a!==null&&lM(t,a,1)}}function lM(t,e,n){for(let r=0;r<e.length;r++)I4(t,e[r],n)}function Zv(t){for(t[Ri].changeDetectionScheduler?.notify();t;){t[X]|=64;let e=wu(t);if(wA(t)&&!e)return t;t=e}return null}var Os=class{get rootNodes(){let e=this._lView,n=e[he];return _f(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Qn]}set context(e){this._lView[Qn]=e}get destroyed(){return(this._lView[X]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[At];if(_r(e)){let n=e[of],r=n?n.indexOf(this):-1;r>-1&&(Z_(e,r),uf(n,r))}this._attachedToViewContainer=!1}Nx(this._lView[he],this._lView)}onDestroy(e){bA(this._lView,e)}markForCheck(){Zv(this._cdRefInjectingView||this._lView)}detach(){this._lView[X]&=-129}reattach(){F_(this._lView),this._lView[X]|=128}detectChanges(){this._lView[X]|=1024,aM(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new B(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,Rx(this._lView[he],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new B(902,!1);this._appRef=e,F_(this._lView)}},$f=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=D4;let t=e;return t})(),C4=$f,b4=class extends C4{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=d4(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new Os(i)}};function D4(){return T4(Rn(),Ze())}function T4(t,e){return t.type&4?new b4(e,t,Rf(t,e)):null}function dM(t){let e=t[_u]??[],r=t[At][st];for(let i of e)S4(i,r);t[_u]=cn}function S4(t,e){let n=0,r=t.firstChild;if(r){let i=t.data[hf];for(;n<i;){let s=r.nextSibling;Fx(e,r,!1),r=s,n++}}}function hM(t){dM(t);for(let e=ln;e<t.length;e++)vf(t[e])}function vf(t){let e=t[he];for(let n=tn;n<e.bindingStartIndex;n++)if(_r(t[n])){let r=t[n];hM(r)}else Qr(t[n])&&vf(t[n])}function A4(t){let e=t._views;for(let n of e){let r=CB(n);if(r!==null&&r[hn]!==null)if(Qr(r))vf(r);else{let i=r[hn];vf(i),hM(r)}}}var x4=new RegExp(`^(\\d+)*(${XA}|${YA})*(.*)`);function M4(t){let e=t.match(x4),[n,r,i,s]=e,o=r?parseInt(r,10):i,a=[];for(let[c,u,l]of s.matchAll(/(f|n)(\d*)/g)){let d=parseInt(l,10)||1;a.push(u,d)}return[o,...a]}function R4(t){return!t.prev&&t.parent?.type===8}function S_(t){return t.index-tn}function qf(t,e,n,r){let i=null,s=S_(r),o=t.data[yB];if(o?.[s])i=N4(o[s],n);else if(e.firstChild===r)i=t.firstChild;else{let a=r.prev===null,c=r.prev??r.parent;if(R4(r)){let u=S_(r.parent);i=q_(t,u)}else{let u=An(c,n);if(a)i=u.firstChild;else{let l=S_(c),d=q_(t,l);if(c.type===2&&d){let f=Lv(t,l)+1;i=Hf(f,d)}else i=u.nextSibling}}}return i}function Hf(t,e){let n=e;for(let r=0;r<t;r++)n=n.nextSibling;return n}function P4(t,e){let n=t;for(let r=0;r<e.length;r+=2){let i=e[r],s=e[r+1];for(let o=0;o<s;o++)switch(i){case $_.FirstChild:n=n.firstChild;break;case $_.NextSibling:n=n.nextSibling;break}}return n}function N4(t,e){let[n,...r]=M4(t),i;if(n===YA)i=e[Sn][hn];else if(n===XA)i=p$(e[Sn][hn]);else{let s=Number(n);i=Yn(e[s+tn])}return P4(i,r)}function k4(t,e){let n=[];for(let r of e)for(let i=0;i<(r[ZA]??1);i++){let s={data:r,firstChild:null};r[hf]>0&&(s.firstChild=t,t=Hf(r[hf],t)),n.push(s)}return[t,n]}var fM=()=>null;function O4(t,e){let n=t[_u];return!e||n===null||n.length===0?null:n[0].data[mB]===e?n.shift():(dM(t),null)}function F4(){fM=O4}function HS(t,e){return fM(t,e)}var rv=class{},iv=class{},wf=class{};function L4(t){let e=Error(`No component factory found for ${Bt(t)}.`);return e[V4]=t,e}var V4="ngComponent";var sv=class{resolveComponentFactory(e){throw L4(e)}},Gf=(()=>{let e=class e{};e.NULL=new sv;let t=e;return t})(),Cu=class{},wa=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>j4();let t=e;return t})();function j4(){let t=Ze(),e=Rn(),n=ki(e.index,t);return(Qr(n)?n:t)[st]}var U4=(()=>{let e=class e{};e.\u0275prov=F({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),A_={};function pM(t){return $4(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function B4(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function $4(t){return t!==null&&(typeof t=="function"||typeof t=="object")}var ov=class{constructor(){}supports(e){return pM(e)}create(e){return new av(e)}},q4=(t,e)=>e,av=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||q4}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<GS(r,i,s)?n:r,a=GS(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let u=a-i,l=c-i;if(u!=l){for(let h=0;h<u;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;l<=p&&p<u&&(s[h]=f+1)}let d=o.previousIndex;s[d]=l-u}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!pM(e))throw new B(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,B4(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new cv(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new Ef),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Ef),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},cv=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},uv=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},Ef=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new uv,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function GS(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function zS(){return new Jv([new ov])}var Jv=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||zS()),deps:[[e,new Vv,new ya]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new B(901,!1)}};e.\u0275prov=F({token:e,providedIn:"root",factory:zS});let t=e;return t})();var Bs=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=H4;let t=e;return t})();function H4(t){return G4(Rn(),Ze(),(t&16)===16)}function G4(t,e,n){if(Su(t)&&!n){let r=ki(t.index,e);return new Os(r,r)}else if(t.type&47){let r=e[Sn];return new Os(r,e)}return null}var gM=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=z4,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),lv=class extends gM{constructor(e){super(),this._lView=e}onDestroy(e){return bA(this._lView,e),()=>DU(this._lView,e)}};function z4(){return new lv(Ze())}var WS=new Set;function Ea(t){WS.has(t)||(WS.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function KS(...t){}function W4(){let t=typeof un.requestAnimationFrame=="function",e=un[t?"requestAnimationFrame":"setTimeout"],n=un[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var se=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new it(!1),this.onMicrotaskEmpty=new it(!1),this.onStable=new it(!1),this.onError=new it(!1),typeof Zone>"u")throw new B(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=W4().nativeRequestAnimationFrame,Y4(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new B(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new B(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,K4,KS,KS);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},K4={};function ew(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Q4(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(un,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,dv(t),t.isCheckStableRunning=!0,ew(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),dv(t))}function Y4(t){let e=()=>{Q4(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(X4(a))return n.invokeTask(i,s,o,a);try{return QS(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),YS(t)}},onInvoke:(n,r,i,s,o,a,c)=>{try{return QS(t),n.invoke(i,s,o,a,c)}finally{t.shouldCoalesceRunChangeDetection&&e(),YS(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,dv(t),ew(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function dv(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function QS(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function YS(t){t._nesting--,ew(t)}var hv=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new it,this.onMicrotaskEmpty=new it,this.onStable=new it,this.onError=new it}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function X4(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function Z4(t="zone.js",e){return t==="noop"?new hv:t==="zone.js"?new se(e):t}var ia=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(ia||{}),J4={destroy(){}};function tw(t,e){!e&&jB(tw);let n=e?.injector??T(Pn);if(!hu(n))return J4;Ea("NgAfterNextRender");let r=n.get(nw),i=r.handler??=new pv,s=e?.phase??ia.MixedReadWrite,o=()=>{i.unregister(c),a()},a=n.get(gM).onDestroy(o),c=new fv(n,s,()=>{o(),t()});return i.register(c),{destroy:o}}var fv=class{constructor(e,n,r){this.phase=n,this.callbackFn=r,this.zone=e.get(se),this.errorHandler=e.get(yr,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},pv=class{constructor(){this.executingCallbacks=!1,this.buckets={[ia.EarlyRead]:new Set,[ia.Write]:new Set,[ia.MixedReadWrite]:new Set,[ia.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},nw=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i();this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=F({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function gv(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=ES(i,a);else if(s==2){let c=a,u=e[++o];r=ES(r,c+": "+u+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var If=class extends Gf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=Mi(e);return new fa(n,this.ngModule)}};function XS(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function eq(t){let e=t.toLowerCase();return e==="svg"?yU:e==="math"?_U:null}var mv=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=kf(r);let i=this.injector.get(e,A_,r);return i!==A_||n===A_?i:this.parentInjector.get(e,n,r)}},fa=class extends wf{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=XS(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return XS(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=hU(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){i=i||this.ngModule;let s=i instanceof fn?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let o=s?new mv(e,s):e,a=o.get(Cu,null);if(a===null)throw new B(407,!1);let c=o.get(U4,null),u=o.get(nw,null),l=o.get(rv,null),d={rendererFactory:a,sanitizer:c,inlineEffectRunner:null,afterRenderEventManager:u,changeDetectionScheduler:l},h=a.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=r?V$(h,r,this.componentDef.encapsulation,o):Gv(h,f,eq(f)),g=512;this.componentDef.signals?g|=4096:this.componentDef.onPush||(g|=16);let m=null;p!==null&&(m=Fv(p,o,!0));let E=Qv(0,null,null,1,0,null,null,null,null,null,null),S=jf(null,E,null,g,null,null,d,h,o,null,m);Av(S);let b,k;try{let q=this.componentDef,G,Ee=null;q.findHostDirectiveDefs?(G=[],Ee=new Map,q.findHostDirectiveDefs(q,G,Ee),G.push(q)):G=[q];let gt=tq(S,p),Cs=nq(gt,p,q,G,S,d,h);k=IA(E,tn),p&&sq(h,q,p,r),n!==void 0&&oq(k,this.ngContentSelectors,n),b=iq(Cs,q,G,Ee,S,[aq]),Xv(E,S,null)}finally{xv()}return new yv(this.componentType,b,Rf(k,S),S,k)}},yv=class extends iv{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Os(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;Yv(s[he],s,i,e,n),this.previousInputValues.set(e,n);let o=ki(this._tNode.index,s);Zv(o)}}get injector(){return new xs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function tq(t,e){let n=t[he],r=tn;return t[r]=e,Uf(n,r,2,"#host",null)}function nq(t,e,n,r,i,s,o){let a=i[he];rq(r,t,e,o);let c=null;e!==null&&(c=Fv(e,i[ca]));let u=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=jf(i,Kx(n),null,l,i[t.index],t,s,u,null,null,c);return a.firstCreatePass&&ev(a,t,r.length-1),Bf(i,d),i[t.index]=d}function rq(t,e,n,r){for(let i of t)e.mergedAttrs=gu(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(gv(e,e.mergedAttrs,!0),n!==null&&jx(r,n,e))}function iq(t,e,n,r,i,s){let o=Rn(),a=i[he],c=An(o,i);Xx(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=ha(i,a,d,o);ks(h,i)}Zx(a,i,o),c&&ks(c,i);let u=ha(i,a,o.directiveStart+o.componentOffset,o);if(t[Qn]=i[Qn]=u,s!==null)for(let l of s)l(u,e);return Gx(a,o,i),u}function sq(t,e,n,r){if(r)O_(t,n,["ng-version","17.2.2"]);else{let{attrs:i,classes:s}=fU(e.selectors[0]);i&&O_(t,n,i),s&&s.length>0&&Vx(t,n,s.join(" "))}}function oq(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function aq(){let t=Rn();Bv(Ze()[he],t)}var Ia=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=cq;let t=e;return t})();function cq(){let t=Rn();return lq(t,Ze())}var uq=Ia,mM=class extends uq{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Rf(this._hostTNode,this._hostLView)}get injector(){return new xs(this._hostTNode,this._hostLView)}get parentInjector(){let e=$v(this._hostTNode,this._hostLView);if(px(e)){let n=gf(e,this._hostLView),r=pf(e),i=n[he].data[r+8];return new xs(i,n)}else return new xs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=ZS(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-ln}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=HS(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,qS(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!BB(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let c=o?e:new fa(Mi(e)),u=r||this.parentInjector;if(!s&&c.ngModule==null){let g=(o?u:this.parentInjector).get(fn,null);g&&(s=g)}let l=Mi(c.componentType??{}),d=HS(this._lContainer,l?.id??null),h=d?.firstChild??null,f=c.create(u,i,h,s);return this.insertImpl(f.hostView,a,qS(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(IU(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[At],u=new mM(c,c[Xn],c[At]);u.detach(u.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return h4(o,i,s,r),e.attachToViewContainerRef(),LA(x_(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=ZS(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=Z_(this._lContainer,n);r&&(uf(x_(this._lContainer),n),Nx(r[he],r))}detach(e){let n=this._adjustIndex(e,-1),r=Z_(this._lContainer,n);return r&&uf(x_(this._lContainer),n)!=null?new Os(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function ZS(t){return t[of]}function x_(t){return t[of]||(t[of]=[])}function lq(t,e){let n,r=e[t.index];return _r(r)?n=r:(n=Jx(r,e,null,t),e[t.index]=n,Bf(e,n)),yM(n,e,t,r),new mM(n,t,e)}function dq(t,e){let n=t[st],r=n.createComment(""),i=An(e,t),s=zv(n,i);return yf(n,s,r,S$(n,i),!1),r}var yM=_M,rw=()=>!1;function hq(t,e,n){return rw(t,e,n)}function _M(t,e,n,r){if(t[Xr])return;let i;n.type&8?i=Yn(r):i=dq(e,n),t[Xr]=i}function fq(t,e,n){if(t[Xr]&&t[_u])return!0;let r=n[Yr],i=e.index-tn;if(!r||YU(e)||Ff(r,i))return!1;let o=q_(r,i),a=r.data[Ov]?.[i],[c,u]=k4(o,a);return t[Xr]=c,t[_u]=u,!0}function pq(t,e,n,r){rw(t,n,e)||_M(t,e,n,r)}function gq(){yM=pq,rw=fq}function mq(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(wq))}return s}return Cf.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(u=>{i.template=u}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let u=i.styles.length,l=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[u+h]=f,l.splice(l.indexOf(d),1),l.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(u=>{a.push(u),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>Eq(s));e.push(c)}),_q(),Promise.all(e).then(()=>{})}var Cf=new Map,yq=new Set;function _q(){let t=Cf;return Cf=new Map,t}function vq(){return Cf.size===0}function wq(t){return typeof t=="string"?t:t.text()}function Eq(t){yq.delete(t)}function Iq(t){return Object.getPrototypeOf(t.prototype).constructor}function ti(t){let e=Iq(t.type),n=!0,r=[t];for(;e;){let i;if(Pi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new B(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Qh(t.inputs),o.inputTransforms=Qh(t.inputTransforms),o.declaredInputs=Qh(t.declaredInputs),o.outputs=Qh(t.outputs);let a=i.hostBindings;a&&Sq(t,a);let c=i.viewQuery,u=i.contentQueries;if(c&&Dq(t,c),u&&Tq(t,u),Cq(t,i),Xj(t.outputs,i.outputs),Pi(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===ti&&(n=!1)}}e=Object.getPrototypeOf(e)}bq(r)}function Cq(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function bq(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=gu(i.hostAttrs,n=gu(n,i.hostAttrs))}}function Qh(t){return t===aa?{}:t===cn?[]:t}function Dq(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function Tq(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function Sq(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}var Ni=class{},bu=class{};var bf=class extends Ni{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new If(this);let i=pA(e);this._bootstrapComponents=Ax(i.bootstrap),this._r3Injector=Cx(e,n,[{provide:Ni,useValue:this},{provide:Gf,useValue:this.componentFactoryResolver},...r],Bt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Df=class extends bu{constructor(e){super(),this.moduleType=e}create(e){return new bf(this.moduleType,e,[])}};function Aq(t,e,n){return new bf(t,e,n)}var _v=class extends Ni{constructor(e){super(),this.componentFactoryResolver=new If(this),this.instance=null;let n=new Iu([...e.providers,{provide:Ni,useValue:this},{provide:Gf,useValue:this.componentFactoryResolver}],e.parent||Uv(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function zf(t,e,n=null){return new _v({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var Nu=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new St(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function iw(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function xq(t,e,n,r,i,s,o,a,c){let u=e.consts,l=Uf(e,t,4,o||null,cf(u,a));Yx(e,n,l,cf(u,c)),Bv(e,l);let d=l.tView=Qv(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function Ca(t,e,n,r,i,s,o,a){let c=Ze(),u=vr(),l=t+tn,d=u.firstCreatePass?xq(l,u,c,e,n,r,i,s,o):u.data[l];xu(d,!1);let h=vM(u,c,d,t);Mv()&&Wv(u,c,h,d),ks(h,c);let f=Jx(h,c,h,d);return c[l]=f,Bf(c,f),hq(f,d,c),Dv(d)&&zx(u,c,d),o!=null&&Wx(c,d,a),Ca}var vM=wM;function wM(t,e,n,r){return Oi(!0),e[st].createComment("")}function Mq(t,e,n,r){let i=e[Yr],s=!i||Au()||Ff(i,r);if(Oi(s),s)return wM(t,e,n,r);let o=i.data[gB]?.[r]??null;o!==null&&n.tView!==null&&n.tView.ssrId===null&&(n.tView.ssrId=o);let a=qf(i,t,e,n);Of(i,r,a);let c=Lv(i,r);return Hf(c,a)}function Rq(){vM=Mq}function Pq(t,e,n,r){return iw(t,AA(),n)?e+zA(n)+r:va}function Yh(t,e){return t<<17|e<<2}function Fs(t){return t>>17&32767}function Nq(t){return(t&2)==2}function kq(t,e){return t&131071|e<<17}function vv(t){return t|2}function pa(t){return(t&131068)>>2}function M_(t,e){return t&-131069|e<<2}function Oq(t){return(t&1)===1}function wv(t){return t|1}function Fq(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Fs(o),c=pa(o);t[r]=n;let u=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||Mu(d,l)>0)&&(u=!0)}else l=n;if(i)if(c!==0){let h=Fs(t[a+1]);t[r+1]=Yh(h,a),h!==0&&(t[h+1]=M_(t[h+1],r)),t[a+1]=kq(t[a+1],r)}else t[r+1]=Yh(a,0),a!==0&&(t[a+1]=M_(t[a+1],r)),a=r;else t[r+1]=Yh(c,0),a===0?a=r:t[c+1]=M_(t[c+1],r),c=r;u&&(t[r+1]=vv(t[r+1])),JS(t,l,r,!0),JS(t,l,r,!1),Lq(e,l,t,r,s),o=Yh(a,c),s?e.classBindings=o:e.styleBindings=o}function Lq(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&Mu(s,e)>=0&&(n[r+1]=wv(n[r+1]))}function JS(t,e,n,r){let i=t[n+1],s=e===null,o=r?Fs(i):pa(i),a=!1;for(;o!==0&&(a===!1||s);){let c=t[o],u=t[o+1];Vq(c,e)&&(a=!0,t[o+1]=r?wv(u):vv(u)),o=r?Fs(u):pa(u)}a&&(t[n+1]=r?vv(i):wv(i))}function Vq(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?Mu(t,e)>=0:!1}function Fi(t,e,n){let r=Ze(),i=AA();if(iw(r,i,e)){let s=vr(),o=qU();G$(s,o,r,t,e,r[st],n,!1)}return Fi}function eA(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";Yv(t,n,s[o],o,r)}function Wf(t,e){return jq(t,e,null,!0),Wf}function jq(t,e,n,r){let i=Ze(),s=vr(),o=FU(2);if(s.firstUpdatePass&&Bq(s,t,o,r),e!==va&&iw(i,o,e)){let a=s.data[ma()];zq(s,a,i,i[st],t,i[o+1]=Wq(e,n),r,o)}}function Uq(t,e){return e>=t.expandoStartIndex}function Bq(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[ma()],o=Uq(t,n);Kq(s,r)&&e===null&&!o&&(e=!1),e=$q(i,s,e,r),Fq(i,s,e,n,o,r)}}function $q(t,e,n,r){let i=UU(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=R_(null,t,e,n,r),n=Du(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=R_(i,t,e,n,r),s===null){let c=qq(t,e,r);c!==void 0&&Array.isArray(c)&&(c=R_(null,t,e,c[1],r),c=Du(c,e.attrs,r),Hq(t,e,r,c))}else s=Gq(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function qq(t,e,n){let r=n?e.classBindings:e.styleBindings;if(pa(r)!==0)return t[Fs(r)]}function Hq(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Fs(i)]=r}function Gq(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=Du(r,o,n)}return Du(r,e.attrs,n)}function R_(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=Du(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Du(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),zU(t,o,n?!0:e[++s]))}return t===void 0?null:t}function zq(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let c=t.data,u=c[a+1],l=Oq(u)?tA(c,e,n,i,pa(u),o):void 0;if(!Tf(l)){Tf(s)||Nq(u)&&(s=tA(c,null,n,i,a,o));let d=EA(ma(),n);N$(r,o,d,i,s)}}function tA(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let c=t[i],u=Array.isArray(c),l=u?c[1]:c,d=l===null,h=n[i+1];h===va&&(h=d?cn:void 0);let f=d?w_(h,r):l===r?h:void 0;if(u&&!Tf(f)&&(f=w_(c,r)),Tf(f)&&(a=f,o))return a;let p=t[i+1];i=o?Fs(p):pa(p)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=w_(c,r))}return a}function Tf(t){return t!==void 0}function Wq(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Bt(qv(t)))),t}function Kq(t,e){return(t.flags&(e?8:16))!==0}function Qq(t,e,n,r,i,s){let o=e.consts,a=cf(o,i),c=Uf(e,t,2,r,a);return Yx(e,n,c,cf(o,s)),c.attrs!==null&&gv(c,c.attrs,!1),c.mergedAttrs!==null&&gv(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function M(t,e,n,r){let i=Ze(),s=vr(),o=tn+t,a=i[st],c=s.firstCreatePass?Qq(o,s,i,e,n,r):s.data[o],u=EM(s,i,c,a,e,t);i[o]=u;let l=Dv(c);return xu(c,!0),jx(a,u,c),(c.flags&32)!==32&&Mv()&&Wv(s,i,u,c),TU()===0&&ks(u,i),SU(),l&&(zx(s,i,c),Gx(s,c,i)),r!==null&&Wx(i,c),M}function O(){let t=Rn();SA()?NU():(t=t.parent,xu(t,!1));let e=t;xU(e)&&RU(),AU();let n=vr();return n.firstCreatePass&&(Bv(n,t),vA(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&KB(e)&&eA(n,e,Ze(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&QB(e)&&eA(n,e,Ze(),e.stylesWithoutHost,!1),O}function $e(t,e,n,r){return M(t,e,n,r),O(),$e}var EM=(t,e,n,r,i,s)=>(Oi(!0),Gv(r,i,OA()));function Yq(t,e,n,r,i,s){let o=e[Yr],a=!o||Au()||Ff(o,s);if(Oi(a),a)return Gv(r,i,OA());let c=qf(o,t,e,n);return tx(o,s)&&Of(o,s,c.nextSibling),o&&(VA(n)||jA(c))&&Su(n)&&(MU(n),Lx(c)),c}function Xq(){EM=Yq}var Zq=(t,e,n,r)=>(Oi(!0),Mx(e[st],""));function Jq(t,e,n,r){let i,s=e[Yr],o=!s||Au();if(Oi(o),o)return Mx(e[st],"");let a=qf(s,t,e,n),c=TB(s,r);return Of(s,r,a),i=Hf(c,a),i}function eH(){Zq=Jq}function Zn(){return Ze()}var Sf="en-US";var tH=Sf;function nH(t){typeof t=="string"&&(tH=t.toLowerCase().replace(/_/g,"-"))}function we(t,e,n,r){let i=Ze(),s=vr(),o=Rn();return iH(s,i,i[st],o,t,e,r),we}function rH(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[mu],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function iH(t,e,n,r,i,s,o){let a=Dv(r),u=t.firstCreatePass&&o4(t),l=e[Qn],d=s4(e),h=!0;if(r.type&3||o){let g=An(r,e),m=o?o(g):g,E=d.length,S=o?k=>o(Yn(k[r.index])):r.index,b=null;if(!o&&a&&(b=rH(t,e,i,r.index)),b!==null){let k=b.__ngLastListenerFn__||b;k.__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,h=!1}else{s=rA(r,e,l,s,!1);let k=n.listen(m,i,s);d.push(s,k),u&&u.push(i,S,E,E+1)}}else s=rA(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let m=0;m<g;m+=2){let E=p[m],S=p[m+1],q=e[E][S].subscribe(s),G=d.length;if(d.push(s,q),u){let Ee=typeof q=="function"?G+1:-(G+1);u.push(i,r.index,G,Ee)}}}}function nA(t,e,n,r){try{return pr(6,e,n),n(r)!==!1}catch(i){return tM(t,i),!1}finally{pr(7,e,n)}}function rA(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?ki(t.index,e):e;Zv(a);let c=nA(e,n,r,o),u=s.__ngNextListenerFn__;for(;u;)c=nA(e,n,u,o)&&c,u=u.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function $s(t=1){return $U(t)}function Li(t){let e=kU();return EU(e,tn+t)}function j(t,e=""){let n=Ze(),r=vr(),i=t+tn,s=r.firstCreatePass?Uf(r,i,1,e,null):r.data[i],o=IM(r,n,s,e,t);n[i]=o,Mv()&&Wv(r,n,o,s),xu(s,!1)}var IM=(t,e,n,r,i)=>(Oi(!0),xx(e[st],r));function sH(t,e,n,r,i){let s=e[Yr],o=!s||Au()||Ff(s,i);return Oi(o),o?xx(e[st],r):qf(s,t,e,n)}function oH(){IM=sH}function ni(t){return CM("",t,""),ni}function CM(t,e,n){let r=Ze(),i=Pq(r,t,e,n);return i!==va&&a4(r,ma(),i),CM}function aH(t,e,n){let r=vr();if(r.firstCreatePass){let i=Pi(t);Ev(n,r.data,r.blueprint,i,!0),Ev(e,r.data,r.blueprint,i,!1)}}function Ev(t,e,n,r,i){if(t=Ut(t),Array.isArray(t))for(let s=0;s<t.length;s++)Ev(t[s],e,n,r,i);else{let s=vr(),o=Ze(),a=Rn(),c=da(t)?t:Ut(t.provide),u=cx(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(da(t)||!t.multi){let f=new Ns(u,i,K),p=N_(c,e,i?l:l+h,d);p===-1?(Q_(mf(a,o),s,c),P_(s,t,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=N_(c,e,l+h,d),p=N_(c,e,l,l+h),g=f>=0&&n[f],m=p>=0&&n[p];if(i&&!m||!i&&!g){Q_(mf(a,o),s,c);let E=lH(i?uH:cH,n.length,i,r,u);!i&&m&&(n[p].providerFactory=E),P_(s,t,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(E),o.push(E)}else{let E=bM(n[i?p:f],u,!i&&r);P_(s,t,f>-1?f:p,E)}!i&&r&&m&&n[p].componentProviders++}}}function P_(t,e,n,r){let i=da(e),s=PB(e);if(i||s){let c=(s?Ut(e.useClass):e).prototype.ngOnDestroy;if(c){let u=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=u.indexOf(n);l===-1?u.push(n,[r,c]):u[l+1].push(r,c)}else u.push(n,c)}}}function bM(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function N_(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function cH(t,e,n,r){return Iv(this.multi,[])}function uH(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=ha(n,n[he],this.providerFactory.index,r);s=a.slice(0,o),Iv(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],Iv(i,s);return s}function Iv(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function lH(t,e,n,r,i){let s=new Ns(t,n,K);return s.multi=[],s.index=e,s.componentProviders=0,bM(s,i,r&&!n),s}function ku(t,e=[]){return n=>{n.providersResolver=(r,i)=>aH(r,i?i(t):t,e)}}var dH=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=sx(!1,r.type),s=i.length>0?zf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=F({token:e,providedIn:"environment",factory:()=>new e(w(fn))});let t=e;return t})();function DM(t){Ea("NgStandalone"),t.getStandaloneInjector=e=>e.get(dH).getOrCreateStandaloneInjector(t)}var Xh=null;function hH(t){Xh!==null&&(t.defaultEncapsulation!==Xh.defaultEncapsulation||t.preserveWhitespaces!==Xh.preserveWhitespaces)||(Xh=t)}var Jr=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},TM=new Jr("17.2.2"),Kf=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var sw=new x(""),Ou=new x(""),Qf=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,ow||(fH(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{se.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(w(se),w(Yf),w(Ou))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),Yf=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return ow?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function fH(t){ow=t}var ow;function qs(t){return!!t&&typeof t.then=="function"}function SM(t){return!!t&&typeof t.subscribe=="function"}var Xf=new x(""),AM=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=T(Xf,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(qs(o))r.push(o);else if(SM(o)){let a=new Promise((c,u)=>{o.subscribe({complete:c,error:u})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),ba=new x("");function pH(){eS(()=>{throw new B(600,!1)})}function gH(t){return t.isBoundToModule}function mH(t,e,n){try{let r=n();return qs(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function xM(t,e){return Array.isArray(e)?e.reduce(xM,t):A(A({},t),e)}var ri=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=T(bx),this.afterRenderEffectManager=T(nw),this.componentTypes=[],this.components=[],this.isStable=T(Nu).hasPendingTasks.pipe(V(r=>!r)),this._injector=T(fn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof wf;if(!this._injector.get(AM).done){let f=!s&&fA(r),p=!1;throw new B(405,p)}let a;s?a=r:a=this._injector.get(Gf).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=gH(a)?void 0:this._injector.get(Ni),u=i||a.selector,l=a.create(Pn.NULL,[],u,c),d=l.location.nativeElement,h=l.injector.get(sw,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),rf(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new B(101,!1);try{this._runningTick=!0,this.detectChangesInAttachedViews()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1}}detectChangesInAttachedViews(){let r=0;do{if(r===oM)throw new B(103,!1);let i=r===0;for(let{_lView:s,notifyErrorHandler:o}of this._views)!i&&!iA(s)||this.detectChangesInView(s,o,i);this.afterRenderEffectManager.execute(),r++}while(this._views.some(({_lView:i})=>iA(i)))}detectChangesInView(r,i,s){let o;s?(o=0,r[X]|=1024):r[X]&64?o=0:o=1,aM(r,i,o)}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;rf(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(ba,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>rf(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new B(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function rf(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}var Zh;function aw(t){Zh??=new WeakMap;let e=Zh.get(t);if(e)return e;let n=t.isStable.pipe(an(r=>r)).toPromise().then(()=>{});return Zh.set(t,n),t.onDestroy(()=>Zh?.delete(t)),n}function iA(t){return Sv(t)}var Cv=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Zf=(()=>{let e=class e{compileModuleSync(r){return new Df(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=pA(r),o=Ax(s.declarations).reduce((a,c)=>{let u=Mi(c);return u&&a.push(new fa(u)),a},[]);return new Cv(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),yH=new x("");function _H(t,e,n){let r=new Df(n);return Promise.resolve(r)}function sA(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var vH=(()=>{let e=class e{constructor(){this.zone=T(se),this.applicationRef=T(ri)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function wH(t){return[{provide:se,useFactory:t},{provide:Ps,multi:!0,useFactory:()=>{let e=T(vH,{optional:!0});return()=>e.initialize()}},{provide:Ps,multi:!0,useFactory:()=>{let e=T(CH);return()=>{e.initialize()}}},{provide:bx,useFactory:EH}]}function EH(){let t=T(se),e=T(yr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function IH(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var CH=(()=>{let e=class e{constructor(){this.subscription=new Xe,this.initialized=!1,this.zone=T(se),this.pendingTasks=T(Nu)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{se.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{se.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function bH(){return typeof $localize<"u"&&$localize.locale||Sf}var cw=new x("",{providedIn:"root",factory:()=>T(cw,ue.Optional|ue.SkipSelf)||bH()});var MM=new x(""),RM=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=Z4(i?.ngZone,IH({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=Aq(r.moduleType,this.injector,wH(()=>s)),a=o.injector.get(yr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:u=>{a.handleError(u)}});o.onDestroy(()=>{rf(this._modules,o),c.unsubscribe()})}),mH(a,s,()=>{let c=o.injector.get(AM);return c.runInitializers(),c.donePromise.then(()=>{let u=o.injector.get(cw,Sf);return nH(u||Sf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=xM({},i);return _H(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(ri);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new B(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new B(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(MM,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(w(Pn))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),pu=null,PM=new x("");function DH(t){if(pu&&!pu.get(PM,!1))throw new B(400,!1);pH(),pu=t;let e=t.get(RM);return AH(t),e}function uw(t,e,n=[]){let r=`Platform: ${e}`,i=new x(r);return(s=[])=>{let o=NM();if(!o||o.injector.get(PM,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):DH(TH(a,r))}return SH(i)}}function TH(t=[],e){return Pn.create({name:e,providers:[{provide:Lf,useValue:"platform"},{provide:MM,useValue:new Set([()=>pu=null])},...t]})}function SH(t){let e=NM();if(!e)throw new B(401,!1);return e}function NM(){return pu?.get(RM)??null}function AH(t){t.get(Pv,null)?.forEach(n=>n())}function lw(){return!1}var kM=uw(null,"core",[]),OM=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(w(ri))},e.\u0275mod=Me({type:e}),e.\u0275inj=Re({});let t=e;return t})();var oA=!1;function xH(){oA||(oA=!0,IB(),Xq(),oH(),eH(),Rq(),gq(),F4(),B$())}function MH(t,e){return aw(t)}function FM(){return Pu([{provide:Kh,useFactory:()=>{let t=!0;return hu()&&(t=!!T(js,{optional:!0})?.get(JA,null)),t&&Ea("NgHydration"),t}},{provide:Ps,useValue:()=>{hu()&&T(Kh)&&(RH(),xH())},multi:!0},{provide:Tx,useFactory:()=>hu()&&T(Kh)},{provide:ba,useFactory:()=>{if(hu()&&T(Kh)){let t=T(ri),e=T(Pn);return()=>{MH(t,e).then(()=>{se.assertInAngularZone(),A4(t)})}}return()=>{}},multi:!0}])}function RH(){let t=Pf(),e;for(let n of t.body.childNodes)if(n.nodeType===Node.COMMENT_NODE&&n.textContent?.trim()===wB){e=n;break}if(!e)throw new B(-507,!1)}function LM(t){let e=Mi(t);if(!e)return null;let n=new fa(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var qM=null;function wr(){return qM}function HM(t){qM??=t}var Jf=class{};var nn=new x(""),gw=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>T(OH),providedIn:"platform"});let t=e;return t})(),GM=new x(""),OH=(()=>{let e=class e extends gw{constructor(){super(),this._doc=T(nn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return wr().getBaseHref(this._doc)}onPopState(r){let i=wr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=wr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function mw(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function VM(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function ii(t){return t&&t[0]!=="?"?"?"+t:t}var Hs=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>T(yw),providedIn:"root"});let t=e;return t})(),zM=new x(""),yw=(()=>{let e=class e extends Hs{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??T(nn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return mw(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+ii(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+ii(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+ii(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(w(gw),w(zM,8))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),WM=(()=>{let e=class e extends Hs{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=mw(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+ii(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+ii(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(w(gw),w(zM,8))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),Da=(()=>{let e=class e{constructor(r){this._subject=new it,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=VH(VM(jM(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+ii(i))}normalize(r){return e.stripTrailingSlash(LH(this._basePath,jM(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+ii(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+ii(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=ii,e.joinWithSlash=mw,e.stripTrailingSlash=VM,e.\u0275fac=function(i){return new(i||e)(w(Hs))},e.\u0275prov=F({token:e,factory:()=>FH(),providedIn:"root"});let t=e;return t})();function FH(){return new Da(w(Hs))}function LH(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function jM(t){return t.replace(/\/index.html$/,"")}function VH(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function KM(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var dw=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},tp=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new dw(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),UM(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);UM(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(K(Ia),K($f),K(Jv))},e.\u0275dir=$t({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function UM(t,e){t.context.$implicit=e.item}var QM=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new hw,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){BM("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){BM("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(K(Ia),K($f))},e.\u0275dir=$t({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),hw=class{constructor(){this.$implicit=null,this.ngIf=null}};function BM(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${Bt(e)}'.`)}var YM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Me({type:e}),e.\u0275inj=Re({});let t=e;return t})(),_w="browser",jH="server";function UH(t){return t===_w}function Gs(t){return t===jH}var XM=(()=>{let e=class e{};e.\u0275prov=F({token:e,providedIn:"root",factory:()=>UH(T(ot))?new fw(T(nn),window):new pw});let t=e;return t})(),fw=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=BH(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function BH(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var pw=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},ep=class{};var rp=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let r=n.indexOf(":");if(r>0){let i=n.slice(0,r),s=i.toLowerCase(),o=n.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,r)=>{this.setHeaderEntries(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,n);let i=(e.op==="a"?this.headers.get(n):void 0)||[];i.push(...r),this.headers.set(n,i);break;case"d":let s=e.value;if(!s)this.headers.delete(n),this.normalizedNames.delete(n);else{let o=this.headers.get(n);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}break}}setHeaderEntries(e,n){let r=(Array.isArray(n)?n:[n]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var sR=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(sR||{}),vw=class{constructor(e,n=oR.Ok,r="OK"){this.headers=e.headers||new rp,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}};var ip=class t extends vw{constructor(e={}){super(e),this.type=sR.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}};var oR=function(t){return t[t.Continue=100]="Continue",t[t.SwitchingProtocols=101]="SwitchingProtocols",t[t.Processing=102]="Processing",t[t.EarlyHints=103]="EarlyHints",t[t.Ok=200]="Ok",t[t.Created=201]="Created",t[t.Accepted=202]="Accepted",t[t.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",t[t.NoContent=204]="NoContent",t[t.ResetContent=205]="ResetContent",t[t.PartialContent=206]="PartialContent",t[t.MultiStatus=207]="MultiStatus",t[t.AlreadyReported=208]="AlreadyReported",t[t.ImUsed=226]="ImUsed",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.Found=302]="Found",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.Unused=306]="Unused",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.LengthRequired=411]="LengthRequired",t[t.PreconditionFailed=412]="PreconditionFailed",t[t.PayloadTooLarge=413]="PayloadTooLarge",t[t.UriTooLong=414]="UriTooLong",t[t.UnsupportedMediaType=415]="UnsupportedMediaType",t[t.RangeNotSatisfiable=416]="RangeNotSatisfiable",t[t.ExpectationFailed=417]="ExpectationFailed",t[t.ImATeapot=418]="ImATeapot",t[t.MisdirectedRequest=421]="MisdirectedRequest",t[t.UnprocessableEntity=422]="UnprocessableEntity",t[t.Locked=423]="Locked",t[t.FailedDependency=424]="FailedDependency",t[t.TooEarly=425]="TooEarly",t[t.UpgradeRequired=426]="UpgradeRequired",t[t.PreconditionRequired=428]="PreconditionRequired",t[t.TooManyRequests=429]="TooManyRequests",t[t.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",t[t.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout",t[t.HttpVersionNotSupported=505]="HttpVersionNotSupported",t[t.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",t[t.InsufficientStorage=507]="InsufficientStorage",t[t.LoopDetected=508]="LoopDetected",t[t.NotExtended=510]="NotExtended",t[t.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",t}(oR||{});var qH=new x("");var JM="b",eR="h",tR="s",nR="st",rR="u",iR="rt",np=new x(""),HH=["GET","HEAD"];function GH(t,e){let l=T(np),{isCacheActive:n}=l,r=kT(l,["isCacheActive"]),{transferCache:i,method:s}=t;if(!n||s==="POST"&&!r.includePostRequests&&!i||s!=="POST"&&!HH.includes(s)||i===!1||r.filter?.(t)===!1)return e(t);let o=T(js),a=WH(t),c=o.get(a,null),u=r.includeHeaders;if(typeof i=="object"&&i.includeHeaders&&(u=i.includeHeaders),c){let{[JM]:d,[iR]:h,[eR]:f,[tR]:p,[nR]:g,[rR]:m}=c,E=d;switch(h){case"arraybuffer":E=new TextEncoder().encode(d).buffer;break;case"blob":E=new Blob([d]);break}let S=new rp(f);return U(new ip({body:E,headers:S,status:p,statusText:g,url:m}))}return e(t).pipe(Be(d=>{d instanceof ip&&o.set(a,{[JM]:d.body,[eR]:zH(d.headers,u),[tR]:d.status,[nR]:d.statusText,[rR]:d.url||"",[iR]:t.responseType})}))}function zH(t,e){if(!e)return{};let n={};for(let r of e){let i=t.getAll(r);i!==null&&(n[r]=i)}return n}function WH(t){let{params:e,method:n,responseType:r,url:i,body:s}=t,o=e.keys().sort().map(l=>`${l}=${e.getAll(l)}`).join("&"),c=[n,r,i,typeof s=="string"?s:"",o].join("|"),u=KH(c);return u}function KH(t){let e=0;for(let n of t)e=Math.imul(31,e)+n.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function aR(t){return[{provide:np,useFactory:()=>(Ea("NgHttpTransferCache"),A({isCacheActive:!0},t))},{provide:qH,useValue:GH,multi:!0,deps:[js,np]},{provide:ba,multi:!0,useFactory:()=>{let e=T(ri),n=T(np);return()=>{aw(e).then(()=>{n.isCacheActive=!1})}}}]}var Iw=class extends Jf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Cw=class t extends Iw{static makeCurrent(){HM(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=QH();return n==null?null:YH(n)}resetBaseElement(){Fu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return KM(document.cookie,e)}},Fu=null;function QH(){return Fu=Fu||document.querySelector("base"),Fu?Fu.getAttribute("href"):null}function YH(t){return new URL(t,document.baseURI).pathname}var bw=class{addToWindow(e){un.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new B(5103,!1);return s},un.getAllAngularTestabilities=()=>e.getAllTestabilities(),un.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=un.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};un.frameworkStabilizers||(un.frameworkStabilizers=[]),un.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?wr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},XH=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),Dw=new x(""),dR=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new B(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(w(Dw),w(se))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),sp=class{constructor(e){this._doc=e}},ww="ng-app-id",hR=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Gs(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${ww}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(ww),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(ww,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(w(nn),w(Ru),w(Nv,8),w(ot))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),Ew={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Aw=/%COMP%/g,fR="%COMP%",ZH=`_nghost-${fR}`,JH=`_ngcontent-${fR}`,eG=!0,tG=new x("",{providedIn:"root",factory:()=>eG});function nG(t){return JH.replace(Aw,t)}function rG(t){return ZH.replace(Aw,t)}function pR(t,e){return e.map(n=>n.replace(Aw,t))}var cR=(()=>{let e=class e{constructor(r,i,s,o,a,c,u,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=Gs(c),this.defaultRenderer=new Lu(r,a,u,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===mr.ShadowDom&&(i=ye(A({},i),{encapsulation:mr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof op?s.applyToHost(r):s instanceof Vu&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case mr.Emulated:o=new op(u,l,i,this.appId,d,a,c,h);break;case mr.ShadowDom:return new Tw(u,l,r,i,a,c,this.nonce,h);default:o=new Vu(u,l,i,d,a,c,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(w(dR),w(hR),w(Ru),w(tG),w(nn),w(ot),w(se),w(Nv))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),Lu=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Ew[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(uR(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(uR(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new B(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=Ew[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=Ew[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Zr.DashCase|Zr.Important)?e.style.setProperty(n,r,i&Zr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Zr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=wr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function uR(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Tw=class extends Lu{constructor(e,n,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=pR(i.id,i.styles);for(let l of u){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Vu=class extends Lu{constructor(e,n,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=c?pR(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},op=class extends Vu{constructor(e,n,r,i,s,o,a,c){let u=i+"-"+r.id;super(e,n,r,s,o,a,c,u),this.contentAttr=nG(u),this.hostAttr=rG(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},iG=(()=>{let e=class e extends sp{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(w(nn))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})(),lR=["alt","control","meta","shift"],sG={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},oG={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},aG=(()=>{let e=class e extends sp{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>wr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),lR.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let u={};return u.domEventName=s,u.fullKey=a,u}static matchEventFullKeyCode(r,i){let s=sG[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),lR.forEach(a=>{if(a!==s){let c=oG[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(w(nn))},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})();function cG(){Cw.makeCurrent()}function uG(){return new yr}function lG(){return UA(document),document}var dG=[{provide:ot,useValue:_w},{provide:Pv,useValue:cG,multi:!0},{provide:nn,useFactory:lG,deps:[]}],gR=uw(kM,"browser",dG),hG=new x(""),fG=[{provide:Ou,useClass:bw,deps:[]},{provide:sw,useClass:Qf,deps:[se,Yf,Ou]},{provide:Qf,useClass:Qf,deps:[se,Yf,Ou]}],pG=[{provide:Lf,useValue:"root"},{provide:yr,useFactory:uG,deps:[]},{provide:Dw,useClass:iG,multi:!0,deps:[nn,se,ot]},{provide:Dw,useClass:aG,multi:!0,deps:[nn]},cR,hR,dR,{provide:Cu,useExisting:cR},{provide:ep,useClass:XH,deps:[]},[]],mR=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:Ru,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(w(hG,12))},e.\u0275mod=Me({type:e}),e.\u0275inj=Re({providers:[...pG,...fG],imports:[YM,OM]});let t=e;return t})();var yR=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(w(nn))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Sw=function(t){return t[t.NoHttpTransferCache=0]="NoHttpTransferCache",t[t.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",t}(Sw||{});function _R(...t){let e=[],n=new Set,r=n.has(Sw.HttpTransferCacheOptions);for(let{\u0275providers:i,\u0275kind:s}of t)n.add(s),i.length&&e.push(i);return Pu([[],FM(),n.has(Sw.NoHttpTransferCache)||r?[]:aR({}),e])}var ie="primary",Ju=Symbol("RouteTitle"),Nw=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function Ma(t){return new Nw(t)}function mG(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function yG(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Er(t[n],e[n]))return!1;return!0}function Er(t,e){let n=t?kw(t):void 0,r=e?kw(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!AR(t[i],e[i]))return!1;return!0}function kw(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function AR(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function xR(t){return t.length>0?t[t.length-1]:null}function Bi(t){return u_(t)?t:qs(t)?oe(Promise.resolve(t)):U(t)}var _G={exact:RR,subset:PR},MR={exact:vG,subset:wG,ignored:()=>!0};function wR(t,e,n){return _G[n.paths](t.root,e.root,n.matrixParams)&&MR[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function vG(t,e){return Er(t,e)}function RR(t,e,n){if(!Ws(t.segments,e.segments)||!up(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!RR(t.children[r],e.children[r],n))return!1;return!0}function wG(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>AR(t[n],e[n]))}function PR(t,e,n){return NR(t,e,e.segments,n)}function NR(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Ws(i,n)||e.hasChildren()||!up(i,n,r))}else if(t.segments.length===n.length){if(!Ws(t.segments,n)||!up(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!PR(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Ws(t.segments,i)||!up(t.segments,i,r)||!t.children[ie]?!1:NR(t.children[ie],e,s,r)}}function up(t,e,n){return e.every((r,i)=>MR[n](t[i].parameters,r.parameters))}var Vi=class{constructor(e=new Ie([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Ma(this.queryParams),this._queryParamMap}toString(){return CG.serialize(this)}},Ie=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return lp(this)}},zs=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=Ma(this.parameters),this._parameterMap}toString(){return OR(this)}};function EG(t,e){return Ws(t,e)&&t.every((n,r)=>Er(n.parameters,e[r].parameters))}function Ws(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function IG(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===ie&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==ie&&(n=n.concat(e(i,r)))}),n}var el=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>new Gu,providedIn:"root"});let t=e;return t})(),Gu=class{parse(e){let n=new Fw(e);return new Vi(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${ju(e.root,!0)}`,r=TG(e.queryParams),i=typeof e.fragment=="string"?`#${bG(e.fragment)}`:"";return`${n}${r}${i}`}},CG=new Gu;function lp(t){return t.segments.map(e=>OR(e)).join("/")}function ju(t,e){if(!t.hasChildren())return lp(t);if(e){let n=t.children[ie]?ju(t.children[ie],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==ie&&r.push(`${i}:${ju(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=IG(t,(r,i)=>i===ie?[ju(t.children[ie],!1)]:[`${i}:${ju(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[ie]!=null?`${lp(t)}/${n[0]}`:`${lp(t)}/(${n.join("//")})`}}function kR(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ap(t){return kR(t).replace(/%3B/gi,";")}function bG(t){return encodeURI(t)}function Ow(t){return kR(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function dp(t){return decodeURIComponent(t)}function ER(t){return dp(t.replace(/\+/g,"%20"))}function OR(t){return`${Ow(t.path)}${DG(t.parameters)}`}function DG(t){return Object.entries(t).map(([e,n])=>`;${Ow(e)}=${Ow(n)}`).join("")}function TG(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${ap(n)}=${ap(i)}`).join("&"):`${ap(n)}=${ap(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var SG=/^[^\/()?;#]+/;function xw(t){let e=t.match(SG);return e?e[0]:""}var AG=/^[^\/()?;=#]+/;function xG(t){let e=t.match(AG);return e?e[0]:""}var MG=/^[^=?&#]+/;function RG(t){let e=t.match(MG);return e?e[0]:""}var PG=/^[^&#]+/;function NG(t){let e=t.match(PG);return e?e[0]:""}var Fw=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ie([],{}):new Ie([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[ie]=new Ie(e,n)),r}parseSegment(){let e=xw(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new B(4009,!1);return this.capture(e),new zs(dp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=xG(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=xw(this.remaining);i&&(r=i,this.capture(r))}e[dp(n)]=dp(r)}parseQueryParam(e){let n=RG(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=NG(this.remaining);o&&(r=o,this.capture(r))}let i=ER(n),s=ER(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=xw(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new B(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ie);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[ie]:new Ie([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new B(4011,!1)}};function FR(t){return t.segments.length>0?new Ie([],{[ie]:t}):t}function LR(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=LR(i);if(r===ie&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ie(t.segments,e);return kG(n)}function kG(t){if(t.numberOfChildren===1&&t.children[ie]){let e=t.children[ie];return new Ie(t.segments.concat(e.segments),e.children)}return t}function Ra(t){return t instanceof Vi}function OG(t,e,n=null,r=null){let i=VR(t);return jR(i,e,n,r)}function VR(t){let e;function n(s){let o={};for(let c of s.children){let u=n(c);o[c.outlet]=u}let a=new Ie(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=FR(r);return e??i}function jR(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return Mw(i,i,i,n,r);let s=FG(e);if(s.toRoot())return Mw(i,i,new Ie([],{}),n,r);let o=LG(s,i,t),a=o.processChildren?$u(o.segmentGroup,o.index,s.commands):BR(o.segmentGroup,o.index,s.commands);return Mw(i,o.segmentGroup,a,n,r)}function hp(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function zu(t){return typeof t=="object"&&t!=null&&t.outlets}function Mw(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([c,u])=>{s[c]=Array.isArray(u)?u.map(l=>`${l}`):`${u}`});let o;t===e?o=n:o=UR(t,e,n);let a=FR(LR(o));return new Vi(a,s,i)}function UR(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=UR(s,e,n)}),new Ie(t.segments,r)}var fp=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&hp(r[0]))throw new B(4003,!1);let i=r.find(zu);if(i&&i!==xR(r))throw new B(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function FG(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new fp(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new fp(n,e,r)}var Aa=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function LG(t,e,n){if(t.isAbsolute)return new Aa(e,!0,0);if(!n)return new Aa(e,!1,NaN);if(n.parent===null)return new Aa(n,!0,0);let r=hp(t.commands[0])?0:1,i=n.segments.length-1+r;return VG(n,i,t.numberOfDoubleDots)}function VG(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new B(4005,!1);i=r.segments.length}return new Aa(r,!1,i-s)}function jG(t){return zu(t[0])?t[0].outlets:{[ie]:t}}function BR(t,e,n){if(t??=new Ie([],{}),t.segments.length===0&&t.hasChildren())return $u(t,e,n);let r=UG(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ie(t.segments.slice(0,r.pathIndex),{});return s.children[ie]=new Ie(t.segments.slice(r.pathIndex),t.children),$u(s,0,i)}else return r.match&&i.length===0?new Ie(t.segments,{}):r.match&&!t.hasChildren()?Lw(t,e,n):r.match?$u(t,0,i):Lw(t,e,n)}function $u(t,e,n){if(n.length===0)return new Ie(t.segments,{});{let r=jG(n),i={};if(Object.keys(r).some(s=>s!==ie)&&t.children[ie]&&t.numberOfChildren===1&&t.children[ie].segments.length===0){let s=$u(t.children[ie],e,n);return new Ie(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=BR(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ie(t.segments,i)}}function UG(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(zu(a))break;let c=`${a}`,u=r<n.length-1?n[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!CR(c,u,o))return s;r+=2}else{if(!CR(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Lw(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(zu(s)){let c=BG(s.outlets);return new Ie(r,c)}if(i===0&&hp(n[0])){let c=t.segments[e];r.push(new zs(c.path,IR(n[0]))),i++;continue}let o=zu(s)?s.outlets[ie]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&hp(a)?(r.push(new zs(o,IR(a))),i+=2):(r.push(new zs(o,{})),i++)}return new Ie(r,{})}function BG(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=Lw(new Ie([],{}),0,r))}),e}function IR(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function CR(t,e,n){return t==n.path&&Er(e,n.parameters)}var qu="imperative",_t=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(_t||{}),kn=class{constructor(e,n){this.id=e,this.url=n}},Pa=class extends kn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=_t.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},si=class extends kn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=_t.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Nn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(Nn||{}),pp=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(pp||{}),ji=class extends kn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=_t.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Ui=class extends kn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=_t.NavigationSkipped}},Wu=class extends kn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=_t.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},gp=class extends kn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=_t.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Vw=class extends kn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=_t.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},jw=class extends kn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=_t.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Uw=class extends kn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=_t.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Bw=class extends kn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=_t.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},$w=class{constructor(e){this.route=e,this.type=_t.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},qw=class{constructor(e){this.route=e,this.type=_t.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Hw=class{constructor(e){this.snapshot=e,this.type=_t.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Gw=class{constructor(e){this.snapshot=e,this.type=_t.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},zw=class{constructor(e){this.snapshot=e,this.type=_t.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ww=class{constructor(e){this.snapshot=e,this.type=_t.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mp=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=_t.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Ku=class{},Qu=class{constructor(e){this.url=e}};var Kw=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new tl,this.attachRef=null}},tl=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new Kw,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),yp=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=Qw(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=Qw(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=Yw(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Yw(e,this._root).map(n=>n.value)}};function Qw(t,e){if(t===e.value)return e;for(let n of e.children){let r=Qw(t,n);if(r)return r}return null}function Yw(t,e){if(t===e.value)return[e];for(let n of e.children){let r=Yw(t,n);if(r.length)return r.unshift(e),r}return[]}var gn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Sa(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var _p=class extends yp{constructor(e,n){super(e),this.snapshot=n,oE(this,e)}toString(){return this.snapshot.toString()}};function $R(t){let e=$G(t),n=new St([new zs("",{})]),r=new St({}),i=new St({}),s=new St({}),o=new St(""),a=new Na(n,r,s,o,i,ie,t,e.root);return a.snapshot=e.root,new _p(new gn(a,[]),e)}function $G(t){let e={},n={},r={},i="",s=new Yu([],e,r,i,n,ie,t,null,{});return new vp("",new gn(s,[]))}var Na=class{constructor(e,n,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(V(u=>u[Ju]))??U(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(V(e=>Ma(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(V(e=>Ma(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function sE(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:A(A({},e.params),t.params),data:A(A({},e.data),t.data),resolve:A(A(A(A({},t.data),e.data),i?.data),t._resolvedData)}:r={params:A({},t.params),data:A({},t.data),resolve:A(A({},t.data),t._resolvedData??{})},i&&HR(i)&&(r.resolve[Ju]=i.title),r}var Yu=class{get title(){return this.data?.[Ju]}constructor(e,n,r,i,s,o,a,c,u){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ma(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ma(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},vp=class extends yp{constructor(e,n){super(n),this.url=e,oE(this,n)}toString(){return qR(this._root)}};function oE(t,e){e.value._routerState=t,e.children.forEach(n=>oE(t,n))}function qR(t){let e=t.children.length>0?` { ${t.children.map(qR).join(", ")} } `:"";return`${t.value}${e}`}function Rw(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Er(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),Er(e.params,n.params)||t.paramsSubject.next(n.params),yG(e.url,n.url)||t.urlSubject.next(n.url),Er(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function Xw(t,e){let n=Er(t.params,e.params)&&EG(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||Xw(t.parent,e.parent))}function HR(t){return typeof t.title=="string"||t.title===null}var aE=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ie,this.activateEvents=new it,this.deactivateEvents=new it,this.attachEvents=new it,this.detachEvents=new it,this.parentContexts=T(tl),this.location=T(Ia),this.changeDetector=T(Bs),this.environmentInjector=T(fn),this.inputBinder=T(bp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new B(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new B(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new B(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new B(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new Zw(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:u,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=$t({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Us]});let t=e;return t})(),Zw=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Na?this.route:e===tl?this.childContexts:this.parent.get(e,n)}},bp=new x(""),bR=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=cu([i.queryParams,i.params,i.data]).pipe(De(([o,a,c],u)=>(c=A(A(A({},o),a),c),u===0?U(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=LM(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})();function qG(t,e,n){let r=Xu(t,e._root,n?n._root:void 0);return new _p(r,e)}function Xu(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=HG(t,e,n);return new gn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Xu(t,a)),o}}let r=GG(e.value),i=e.children.map(s=>Xu(t,s));return new gn(r,i)}}function HG(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Xu(t,r,i);return Xu(t,r)})}function GG(t){return new Na(new St(t.url),new St(t.params),new St(t.queryParams),new St(t.fragment),new St(t.data),t.outlet,t.component,t)}var GR="ngNavigationCancelingError";function zR(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=Ra(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=WR(!1,Nn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function WR(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[GR]=!0,n.cancellationCode=e,n}function zG(t){return KR(t)&&Ra(t.url)}function KR(t){return!!t&&t[GR]}var WG=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Nt({type:e,selectors:[["ng-component"]],standalone:!0,features:[DM],decls:1,vars:0,template:function(i,s){i&1&&$e(0,"router-outlet")},dependencies:[aE],encapsulation:2});let t=e;return t})();function KG(t,e){return t.providers&&!t._injector&&(t._injector=zf(t.providers,e,`Route: ${t.path}`)),t._injector??e}function cE(t){let e=t.children&&t.children.map(cE),n=e?ye(A({},t),{children:e}):A({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==ie&&(n.component=WG),n}function Ir(t){return t.outlet||ie}function QG(t,e){let n=t.filter(r=>Ir(r)===e);return n.push(...t.filter(r=>Ir(r)!==e)),n}function nl(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var YG=(t,e,n,r)=>V(i=>(new Jw(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),Jw=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Rw(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=Sa(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Sa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Sa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=Sa(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Ww(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Gw(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(Rw(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Rw(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=nl(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},wp=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},xa=class{constructor(e,n){this.component=e,this.route=n}};function XG(t,e,n){let r=t._root,i=e?e._root:null;return Uu(r,i,n,[r.value])}function ZG(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function Oa(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!BA(t)?t:e.get(t):r}function Uu(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Sa(e);return t.children.forEach(o=>{JG(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Hu(a,n.getContext(o),i)),i}function JG(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=ez(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new wp(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Uu(t,e,a?a.children:null,r,i):Uu(t,e,n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new xa(a.outlet.component,o))}else o&&Hu(e,a,i),i.canActivateChecks.push(new wp(r)),s.component?Uu(t,null,a?a.children:null,r,i):Uu(t,null,n,r,i);return i}function ez(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Ws(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Ws(t.url,e.url)||!Er(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Xw(t,e)||!Er(t.queryParams,e.queryParams);case"paramsChange":default:return!Xw(t,e)}}function Hu(t,e,n){let r=Sa(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Hu(o,e.children.getContext(s),n):Hu(o,null,n):Hu(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new xa(e.outlet.component,i)):n.canDeactivateChecks.push(new xa(null,i)):n.canDeactivateChecks.push(new xa(null,i))}function rl(t){return typeof t=="function"}function tz(t){return typeof t=="boolean"}function nz(t){return t&&rl(t.canLoad)}function rz(t){return t&&rl(t.canActivate)}function iz(t){return t&&rl(t.canActivateChild)}function sz(t){return t&&rl(t.canDeactivate)}function oz(t){return t&&rl(t.canMatch)}function QR(t){return t instanceof Kr||t?.name==="EmptyError"}var cp=Symbol("INITIAL_VALUE");function ka(){return De(t=>cu(t.map(e=>e.pipe(zn(1),As(cp)))).pipe(V(e=>{for(let n of e)if(n!==!0){if(n===cp)return cp;if(n===!1||n instanceof Vi)return n}return!0}),yt(e=>e!==cp),zn(1)))}function az(t,e){return rt(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?U(ye(A({},n),{guardsResult:!0})):cz(o,r,i,t).pipe(rt(a=>a&&tz(a)?uz(r,s,t,e):U(a)),V(a=>ye(A({},n),{guardsResult:a})))})}function cz(t,e,n,r){return oe(t).pipe(rt(i=>pz(i.component,i.route,n,e,r)),an(i=>i!==!0,!0))}function uz(t,e,n,r){return oe(e).pipe(Ti(i=>Xo(dz(i.route.parent,r),lz(i.route,r),fz(t,i.path,n),hz(t,i.route,n))),an(i=>i!==!0,!0))}function lz(t,e){return t!==null&&e&&e(new zw(t)),U(!0)}function dz(t,e){return t!==null&&e&&e(new Hw(t)),U(!0)}function hz(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return U(!0);let i=r.map(s=>qh(()=>{let o=nl(e)??n,a=Oa(s,o),c=rz(a)?a.canActivate(e,t):ei(o,()=>a(e,t));return Bi(c).pipe(an())}));return U(i).pipe(ka())}function fz(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>ZG(o)).filter(o=>o!==null).map(o=>qh(()=>{let a=o.guards.map(c=>{let u=nl(o.node)??n,l=Oa(c,u),d=iz(l)?l.canActivateChild(r,t):ei(u,()=>l(r,t));return Bi(d).pipe(an())});return U(a).pipe(ka())}));return U(s).pipe(ka())}function pz(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return U(!0);let o=s.map(a=>{let c=nl(e)??i,u=Oa(a,c),l=sz(u)?u.canDeactivate(t,e,n,r):ei(c,()=>u(t,e,n,r));return Bi(l).pipe(an())});return U(o).pipe(ka())}function gz(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return U(!0);let s=i.map(o=>{let a=Oa(o,t),c=nz(a)?a.canLoad(e,n):ei(t,()=>a(e,n));return Bi(c)});return U(s).pipe(ka(),YR(r))}function YR(t){return r_(Be(e=>{if(Ra(e))throw zR(t,e)}),V(e=>e===!0))}function mz(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return U(!0);let s=i.map(o=>{let a=Oa(o,t),c=oz(a)?a.canMatch(e,n):ei(t,()=>a(e,n));return Bi(c)});return U(s).pipe(ka(),YR(r))}var Zu=class{constructor(e){this.segmentGroup=e||null}},Ep=class extends Error{constructor(e){super(),this.urlTree=e}};function Ta(t){return Yo(new Zu(t))}function yz(t){return Yo(new B(4e3,!1))}function _z(t){return Yo(WR(!1,Nn.GuardRejected))}var eE=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return U(r);if(i.numberOfChildren>1||!i.children[ie])return yz(e.redirectTo);i=i.children[ie]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Ep(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Vi(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Ie(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new B(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},tE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function vz(t,e,n,r,i){let s=uE(t,e,n);return s.matched?(r=KG(e,r),mz(r,e,n,i).pipe(V(o=>o===!0?s:A({},tE)))):U(s)}function uE(t,e,n){if(e.path==="**")return wz(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?A({},tE):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||mG)(n,t,e);if(!i)return A({},tE);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?A(A({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function wz(t){return{matched:!0,parameters:t.length>0?xR(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function DR(t,e,n,r){return n.length>0&&Cz(t,n,r)?{segmentGroup:new Ie(e,Iz(r,new Ie(n,t.children))),slicedSegments:[]}:n.length===0&&bz(t,n,r)?{segmentGroup:new Ie(t.segments,Ez(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ie(t.segments,t.children),slicedSegments:n}}function Ez(t,e,n,r){let i={};for(let s of n)if(Dp(t,e,s)&&!r[Ir(s)]){let o=new Ie([],{});i[Ir(s)]=o}return A(A({},r),i)}function Iz(t,e){let n={};n[ie]=e;for(let r of t)if(r.path===""&&Ir(r)!==ie){let i=new Ie([],{});n[Ir(r)]=i}return n}function Cz(t,e,n){return n.some(r=>Dp(t,e,r)&&Ir(r)!==ie)}function bz(t,e,n){return n.some(r=>Dp(t,e,r))}function Dp(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function Dz(t,e,n,r){return Ir(t)!==r&&(r===ie||!Dp(e,n,t))?!1:uE(e,t,n).matched}function Tz(t,e,n){return e.length===0&&!t.children[n]}var nE=class{};function Sz(t,e,n,r,i,s,o="emptyOnly"){return new rE(t,e,n,r,i,o,s).recognize()}var Az=31,rE=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new eE(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new B(4002,`'${e.segmentGroup}'`)}recognize(){let e=DR(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(V(n=>{let r=new Yu([],Object.freeze({}),Object.freeze(A({},this.urlTree.queryParams)),this.urlTree.fragment,{},ie,this.rootComponentType,null,{}),i=new gn(r,n),s=new vp("",i),o=OG(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,ie).pipe(Di(r=>{if(r instanceof Ep)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Zu?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=sE(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(V(s=>s instanceof gn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return oe(i).pipe(Ti(s=>{let o=r.children[s],a=QG(n,s);return this.processSegmentGroup(e,a,o,s)}),fr((s,o)=>(s.push(...o),s)),Si(null),f_(),rt(s=>{if(s===null)return Ta(r);let o=XR(s);return xz(o),U(o)}))}processSegment(e,n,r,i,s,o){return oe(n).pipe(Ti(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(Di(c=>{if(c instanceof Zu)return U(null);throw c}))),an(a=>!!a),Di(a=>{if(QR(a))return Tz(r,i,s)?U(new nE):Ta(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return Dz(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):Ta(i):Ta(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:u,remainingSegments:l}=uE(n,i,s);if(!a)return Ta(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Az&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,u);return this.applyRedirects.lineralizeSegments(i,d).pipe(rt(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=vz(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(De(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(De(({routes:c})=>{let u=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new Yu(l,h,Object.freeze(A({},this.urlTree.queryParams)),this.urlTree.fragment,Rz(r),Ir(r),r.component??r._loadedComponent??null,r,Pz(r)),{segmentGroup:p,slicedSegments:g}=DR(n,l,d,c);if(g.length===0&&p.hasChildren())return this.processChildren(u,c,p).pipe(V(E=>E===null?null:new gn(f,E)));if(c.length===0&&g.length===0)return U(new gn(f,[]));let m=Ir(r)===s;return this.processSegment(u,c,p,g,m?ie:s,!0).pipe(V(E=>new gn(f,E instanceof gn?[E]:[])))}))):Ta(n)))}getChildConfig(e,n,r){return n.children?U({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?U({routes:n._loadedRoutes,injector:n._loadedInjector}):gz(e,n,r,this.urlSerializer).pipe(rt(i=>i?this.configLoader.loadChildren(e,n).pipe(Be(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):_z(n))):U({routes:[],injector:e})}};function xz(t){t.sort((e,n)=>e.value.outlet===ie?-1:n.value.outlet===ie?1:e.value.outlet.localeCompare(n.value.outlet))}function Mz(t){let e=t.value.routeConfig;return e&&e.path===""}function XR(t){let e=[],n=new Set;for(let r of t){if(!Mz(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=XR(r.children);e.push(new gn(r.value,i))}return e.filter(r=>!n.has(r))}function Rz(t){return t.data||{}}function Pz(t){return t.resolve||{}}function Nz(t,e,n,r,i,s){return rt(o=>Sz(t,e,n,r,o.extractedUrl,i,s).pipe(V(({state:a,tree:c})=>ye(A({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function kz(t,e){return rt(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return U(n);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let u of ZR(c))o.add(u);let a=0;return oe(o).pipe(Ti(c=>s.has(c)?Oz(c,r,t,e):(c.data=sE(c,c.parent,t).resolve,U(void 0))),Be(()=>a++),ea(1),rt(c=>a===o.size?U(n):Jt))})}function ZR(t){let e=t.children.map(n=>ZR(n)).flat();return[t,...e]}function Oz(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!HR(i)&&(s[Ju]=i.title),Fz(s,t,e,r).pipe(V(o=>(t._resolvedData=o,t.data=sE(t,t.parent,n).resolve,null)))}function Fz(t,e,n,r){let i=kw(t);if(i.length===0)return U({});let s={};return oe(i).pipe(rt(o=>Lz(t[o],e,n,r).pipe(an(),Be(a=>{s[o]=a}))),ea(1),h_(s),Di(o=>QR(o)?Jt:Yo(o)))}function Lz(t,e,n,r){let i=nl(e)??r,s=Oa(t,i),o=s.resolve?s.resolve(e,n):ei(i,()=>s(e,n));return Bi(o)}function Pw(t){return De(e=>{let n=t(e);return n?oe(n).pipe(V(()=>e)):U(e)})}var JR=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===ie);return i}getResolvedTitleForRoute(r){return r.data[Ju]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>T(Vz),providedIn:"root"});let t=e;return t})(),Vz=(()=>{let e=class e extends JR{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(w(yR))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),il=new x("",{providedIn:"root",factory:()=>({})}),Ip=new x(""),lE=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=T(Zf)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return U(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Bi(r.loadComponent()).pipe(V(eP),Be(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Jo(()=>{this.componentLoaders.delete(r)})),s=new Go(i,()=>new ft).pipe(Ho());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return U({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=jz(i,this.compiler,r,this.onLoadEndListener).pipe(Jo(()=>{this.childrenLoaders.delete(i)})),a=new Go(o,()=>new ft).pipe(Ho());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function jz(t,e,n,r){return Bi(t.loadChildren()).pipe(V(eP),rt(i=>i instanceof bu||Array.isArray(i)?U(i):oe(e.compileModuleAsync(i))),V(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Ip,[],{optional:!0,self:!0}).flat()),{routes:o.map(cE),injector:s}}))}function Uz(t){return t&&typeof t=="object"&&"default"in t}function eP(t){return Uz(t)?t.default:t}var dE=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>T(Bz),providedIn:"root"});let t=e;return t})(),Bz=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),tP=new x(""),nP=new x("");function $z(t,e,n){let r=t.get(nP),i=t.get(nn);return t.get(se).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(u=>{s=u}),a=i.startViewTransition(()=>(s(),qz(t))),{onViewTransitionCreated:c}=r;return c&&ei(t,()=>c({transition:a,from:e,to:n})),o})}function qz(t){return new Promise(e=>{tw(e,{injector:t})})}var hE=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new ft,this.transitionAbortSubject=new ft,this.configLoader=T(lE),this.environmentInjector=T(fn),this.urlSerializer=T(el),this.rootContexts=T(tl),this.location=T(Da),this.inputBindingEnabled=T(bp,{optional:!0})!==null,this.titleStrategy=T(JR),this.options=T(il,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=T(dE),this.createViewTransition=T(tP,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>U(void 0),this.rootComponentType=null;let r=s=>this.events.next(new $w(s)),i=s=>this.events.next(new qw(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ye(A(A({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new St({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:qu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(yt(o=>o.id!==0),V(o=>ye(A({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),De(o=>{this.currentTransition=o;let a=!1,c=!1;return U(o).pipe(Be(u=>{this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?ye(A({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),De(u=>{let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=u.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new Ui(u.id,this.urlSerializer.serialize(u.rawUrl),h,pp.IgnoredSameUrlNavigation)),u.resolve(null),Jt}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return U(u).pipe(De(h=>{let f=this.transitions?.getValue();return this.events.next(new Pa(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Jt:Promise.resolve(h)}),Nz(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Be(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ye(A({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new gp(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:m}=u,E=new Pa(h,this.urlSerializer.serialize(f),p,g);this.events.next(E);let S=$R(this.rootComponentType).snapshot;return this.currentTransition=o=ye(A({},u),{targetSnapshot:S,urlAfterRedirects:f,extras:ye(A({},m),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,U(o)}else{let h="";return this.events.next(new Ui(u.id,this.urlSerializer.serialize(u.extractedUrl),h,pp.IgnoredByUrlHandlingStrategy)),u.resolve(null),Jt}}),Be(u=>{let l=new Vw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),V(u=>(this.currentTransition=o=ye(A({},u),{guards:XG(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),o)),az(this.environmentInjector,u=>this.events.next(u)),Be(u=>{if(o.guardsResult=u.guardsResult,Ra(u.guardsResult))throw zR(this.urlSerializer,u.guardsResult);let l=new jw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),yt(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",Nn.GuardRejected),!1)),Pw(u=>{if(u.guards.canActivateChecks.length)return U(u).pipe(Be(l=>{let d=new Uw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),De(l=>{let d=!1;return U(l).pipe(kz(this.paramsInheritanceStrategy,this.environmentInjector),Be({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",Nn.NoDataFromResolver)}}))}),Be(l=>{let d=new Bw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),Pw(u=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(Be(f=>{d.component=f}),V(()=>{})));for(let f of d.children)h.push(...l(f));return h};return cu(l(u.targetSnapshot.root)).pipe(Si(null),zn(1))}),Pw(()=>this.afterPreactivation()),De(()=>{let{currentSnapshot:u,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,u.root,l.root);return d?oe(d).pipe(V(()=>o)):U(o)}),V(u=>{let l=qG(r.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=o=ye(A({},u),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),Be(()=>{this.events.next(new Ku)}),YG(this.rootContexts,r.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),zn(1),Be({next:u=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new si(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{a=!0}}),m_(this.transitionAbortSubject.pipe(Be(u=>{throw u}))),Jo(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Nn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Di(u=>{if(c=!0,KR(u))this.events.next(new ji(o.id,this.urlSerializer.serialize(o.extractedUrl),u.message,u.cancellationCode)),zG(u)?this.events.next(new Qu(u.url)):o.resolve(!1);else{this.events.next(new Wu(o.id,this.urlSerializer.serialize(o.extractedUrl),u,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(u))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return Jt}))}))}cancelNavigationTransition(r,i,s){let o=new ji(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Hz(t){return t!==qu}var Gz=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>T(zz),providedIn:"root"});let t=e;return t})(),iE=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},zz=(()=>{let e=class e extends iE{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=_a(e)))(s||e)}})(),e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),rP=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:()=>T(Wz),providedIn:"root"});let t=e;return t})(),Wz=(()=>{let e=class e extends rP{constructor(){super(...arguments),this.location=T(Da),this.urlSerializer=T(el),this.options=T(il,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=T(dE),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Vi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=$R(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Pa)this.stateMemento=this.createStateMemento();else if(r instanceof Ui)this.rawUrlTree=i.initialUrl;else if(r instanceof gp){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Ku?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof ji&&(r.code===Nn.GuardRejected||r.code===Nn.NoDataFromResolver)?this.restoreHistory(i):r instanceof Wu?this.restoreHistory(i,!0):r instanceof si&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=A(A({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=A(A({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=_a(e)))(s||e)}})(),e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Bu=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Bu||{});function iP(t,e){t.events.pipe(yt(n=>n instanceof si||n instanceof ji||n instanceof Wu||n instanceof Ui),V(n=>n instanceof si||n instanceof Ui?Bu.COMPLETE:(n instanceof ji?n.code===Nn.Redirect||n.code===Nn.SupersededByNewNavigation:!1)?Bu.REDIRECTING:Bu.FAILED),yt(n=>n!==Bu.REDIRECTING),zn(1)).subscribe(()=>{e()})}function Kz(t){throw t}var Qz={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Yz={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},qe=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=T(Kf),this.stateManager=T(rP),this.options=T(il,{optional:!0})||{},this.pendingTasks=T(Nu),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=T(hE),this.urlSerializer=T(el),this.location=T(Da),this.urlHandlingStrategy=T(dE),this._events=new ft,this.errorHandler=this.options.errorHandler||Kz,this.navigated=!1,this.routeReuseStrategy=T(Gz),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=T(Ip,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!T(bp,{optional:!0}),this.eventsSubscription=new Xe,this.isNgZoneEnabled=T(se)instanceof se&&se.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof ji&&i.code!==Nn.Redirect&&i.code!==Nn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof si)this.navigated=!0;else if(i instanceof Qu){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||Hz(s.source)};this.scheduleNavigation(a,qu,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}Zz(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),qu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let u=A({},s);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(cE),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:u}=i,l=u?this.currentUrlTree.fragment:a,d=null;switch(c){case"merge":d=A(A({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=VR(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return jR(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Ra(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,qu,null,i)}navigate(r,i={skipLocationChange:!1}){return Xz(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=A({},Qz):i===!1?s=A({},Yz):s=i,Ra(r))return wR(this.currentUrlTree,r,s);let o=this.parseUrl(r);return wR(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,u,l;a?(c=a.resolve,u=a.reject,l=a.promise):l=new Promise((h,f)=>{c=h,u=f});let d=this.pendingTasks.add();return iP(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Xz(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new B(4008,!1)}function Zz(t){return!(t instanceof Ku)&&!(t instanceof Qu)}var Cp=class{};var Jz=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(yt(r=>r instanceof si),Ti(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=zf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return oe(s).pipe(bi())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=U(null);let o=s.pipe(rt(a=>a===null?U(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return oe([o,a]).pipe(bi())}else return o})}};e.\u0275fac=function(i){return new(i||e)(w(qe),w(Zf),w(fn),w(Cp),w(lE))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),sP=new x(""),e3=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Pa?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof si?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Ui&&r.code===pp.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof mp&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new mp(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){Bx()},e.\u0275prov=F({token:e,factory:e.\u0275fac});let t=e;return t})();function t3(t){return t.routerState.root}function sl(t,e){return{\u0275kind:t,\u0275providers:e}}function n3(){let t=T(Pn);return e=>{let n=t.get(ri);if(e!==n.components[0])return;let r=t.get(qe),i=t.get(oP);t.get(fE)===1&&r.initialNavigation(),t.get(aP,null,ue.Optional)?.setUpPreloading(),t.get(sP,null,ue.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var oP=new x("",{factory:()=>new ft}),fE=new x("",{providedIn:"root",factory:()=>1});function r3(){return sl(2,[{provide:fE,useValue:0},{provide:Xf,multi:!0,deps:[Pn],useFactory:e=>{let n=e.get(GM,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(qe),s=e.get(oP);iP(i,()=>{r(!0)}),e.get(hE).afterPreactivation=()=>(r(!0),s.closed?U(void 0):s),i.initialNavigation()}))}}])}function i3(){return sl(3,[{provide:Xf,multi:!0,useFactory:()=>{let e=T(qe);return()=>{e.setUpLocationChangeListener()}}},{provide:fE,useValue:2}])}var aP=new x("");function s3(t){return sl(0,[{provide:aP,useExisting:Jz},{provide:Cp,useExisting:t}])}function o3(){return sl(8,[bR,{provide:bp,useExisting:bR}])}function a3(t){let e=[{provide:tP,useValue:$z},{provide:nP,useValue:A({skipNextTransition:!!t?.skipInitialTransition},t)}];return sl(9,e)}var TR=new x("ROUTER_FORROOT_GUARD"),c3=[Da,{provide:el,useClass:Gu},qe,tl,{provide:Na,useFactory:t3,deps:[qe]},lE,[]],pE=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[c3,[],{provide:Ip,multi:!0,useValue:r},{provide:TR,useFactory:h3,deps:[[qe,new ya,new Vv]]},{provide:il,useValue:i||{}},i?.useHash?l3():d3(),u3(),i?.preloadingStrategy?s3(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?f3(i):[],i?.bindToComponentInputs?o3().\u0275providers:[],i?.enableViewTransitions?a3().\u0275providers:[],p3()]}}static forChild(r){return{ngModule:e,providers:[{provide:Ip,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(w(TR,8))},e.\u0275mod=Me({type:e}),e.\u0275inj=Re({});let t=e;return t})();function u3(){return{provide:sP,useFactory:()=>{let t=T(XM),e=T(se),n=T(il),r=T(hE),i=T(el);return n.scrollOffset&&t.setOffset(n.scrollOffset),new e3(i,r,t,e,n)}}}function l3(){return{provide:Hs,useClass:WM}}function d3(){return{provide:Hs,useClass:yw}}function h3(t){return"guarded"}function f3(t){return[t.initialNavigation==="disabled"?i3().\u0275providers:[],t.initialNavigation==="enabledBlocking"?r3().\u0275providers:[]]}var SR=new x("");function p3(){return[{provide:SR,useFactory:n3},{provide:ba,multi:!0,useExisting:SR}]}var g3="firebase",m3="10.8.0";Zt(g3,m3,"app");var er=new Jr("ANGULARFIRE2_VERSION");var y3=(t,e)=>{let n=e?[e]:WT(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Jn=class{constructor(){return y3(_3)}},_3="app-check";function gE(){}var Tp=class{zone;delegate;constructor(e,n=a_){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},mE=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",gE,{},gE,gE)),n.pipe(Be({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},$i=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Tp(Zone.current)),this.insideAngular=n.run(()=>new Tp(Zone.current,Wr)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(w(se))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function cP(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function yE(t){return t.pipe(on(cP().outsideAngular))}function Fe(t){return v3(cP())(t)}function v3(t){return function(n){return n=n.lift(new mE(t.ngZone)),n.pipe(Gn(t.outsideAngular),on(t.insideAngular))}}var w3=new Map,E3={activated:!1,tokenObservers:[]},I3={initialized:!1,enabled:!1};function tr(t){return w3.get(t)||Object.assign({},E3)}function fP(){return I3}var C3="https://content-firebaseappcheck.googleapis.com/v1";var b3="exchangeDebugToken",uP={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Koe=24*60*60*1e3;var vE=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return y(this,null,function*(){this.stop();try{this.pending=new mt,this.pending.promise.catch(n=>{}),yield D3(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new mt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function D3(t){return new Promise(e=>{setTimeout(e,t)})}var T3={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},qi=new BT("appCheck","AppCheck",T3);function pP(t){if(!tr(t).activated)throw qi.create("use-before-activation",{appName:t.name})}function gP(r,i){return y(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(t,a)}catch(f){throw qi.create("fetch-network-error",{originalErrorMessage:f?.message})}if(c.status!==200)throw qi.create("fetch-status-error",{httpStatus:c.status});let u;try{u=yield c.json()}catch(f){throw qi.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=u.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw qi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:u.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function mP(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${C3}/projects/${n}/apps/${r}:${b3}?key=${i}`,body:{debug_token:e}}}var S3="firebase-app-check-database",A3=1,wE="firebase-app-check-store";var Ap=null;function x3(){return Ap||(Ap=new Promise((t,e)=>{try{let n=indexedDB.open(S3,A3);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(qi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(wE,{keyPath:"compositeKey"})}}}catch(n){e(qi.create("storage-open",{originalErrorMessage:n?.message}))}}),Ap)}function M3(t,e){return R3(P3(t),e)}function R3(t,e){return y(this,null,function*(){let r=(yield x3()).transaction(wE,"readwrite"),s=r.objectStore(wE).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var u;a(qi.create("storage-set",{originalErrorMessage:(u=c.target.error)===null||u===void 0?void 0:u.message}))}})})}function P3(t){return`${t.options.appId}-${t.name}`}var EE=new Ci("@firebase/app-check");function _E(t,e){return gh()?M3(t,e).catch(n=>{EE.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function yP(){return fP().enabled}function _P(){return y(this,null,function*(){let t=fP();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var N3={error:"UNKNOWN_ERROR"};function k3(t){return ph.encodeString(JSON.stringify(t),!1)}function IE(t,e=!1){return y(this,null,function*(){let n=t.app;pP(n);let r=tr(n),i=r.token,s;if(i&&!ol(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(ol(c)?i=c:yield _E(n,void 0))}if(!e&&i&&ol(i))return{token:i.token};let o=!1;if(yP()){r.exchangeTokenPromise||(r.exchangeTokenPromise=gP(mP(n,yield _P()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let c=yield r.exchangeTokenPromise;return yield _E(n,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield tr(n).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?EE.warn(c.message):EE.error(c),s=c}let a;return i?s?ol(i)?a={token:i.token,internalError:s}:a=dP(s):(a={token:i.token},r.token=i,yield _E(n,i)):a=dP(s),o&&V3(n,a),a})}function O3(t){return y(this,null,function*(){let e=t.app;pP(e);let{provider:n}=tr(e);if(yP()){let r=yield _P(),{token:i}=yield gP(mP(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function F3(t,e,n,r){let{app:i}=t,s=tr(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&ol(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),lP(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>lP(t))}function vP(t,e){let n=tr(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function lP(t){let{app:e}=t,n=tr(e),r=n.tokenRefresher;r||(r=L3(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function L3(t){let{app:e}=t;return new vE(()=>y(this,null,function*(){let n=tr(e),r;if(n.token?r=yield IE(t,!0):r=yield IE(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=tr(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},uP.RETRIAL_MIN_WAIT,uP.RETRIAL_MAX_WAIT)}function V3(t,e){let n=tr(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function ol(t){return t.expireTimeMillis-Date.now()>0}function dP(t){return{token:k3(N3),error:t}}var CE=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=tr(this.app);for(let n of e)vP(this.app,n.next);return Promise.resolve()}};function j3(t,e){return new CE(t,e)}function U3(t){return{getToken:e=>IE(t,e),getLimitedUseToken:()=>O3(t),addTokenListener:e=>F3(t,"INTERNAL",e),removeTokenListener:e=>vP(t.app,e)}}var B3="@firebase/app-check",$3="0.8.2";var q3="app-check",hP="app-check-internal";function H3(){Gr(new Dt(q3,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return j3(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(hP).initialize()})),Gr(new Dt(hP,t=>{let e=t.getProvider("app-check").getImmediate();return U3(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Zt(B3,$3)}H3();var G3=["localhost","0.0.0.0","127.0.0.1"],oae=typeof window<"u"&&G3.includes(window.location.hostname);var z3="firebase",W3="10.8.0";Ue.registerVersion(z3,W3,"app-compat");var K3=["ngOnDestroy"],EP=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(K3.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(u=>n.run(()=>u)):n.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,u)=>o.then(l=>{let d=l?.(...u);return r?.spy?.apply&&r.spy.apply(s,u,d),d})})})});var Mp=class{constructor(e){return e}},Cr=new x("angularfire2.app.options"),br=new x("angularfire2.app.name");function ai(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=Ue.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Ue.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;Q3("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Mp(o)}var Q3=(t,...e)=>{lw()&&typeof console<"u"&&console[t](...e)},Y3={provide:Mp,useFactory:ai,deps:[Cr,se,[new ya,br]]},IP=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:Cr,useValue:n},{provide:br,useValue:r}]}}constructor(n){Ue.registerVersion("angularfire",er.full,"core"),Ue.registerVersion("angularfire",er.full,"app-compat"),Ue.registerVersion("angular",TM.full,n.toString())}static \u0275fac=function(r){return new(r||t)(w(ot))};static \u0275mod=Me({type:t});static \u0275inj=Re({providers:[Y3]})}return t})();function Hi(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return X3(i,o)||(wP("error",`${e} was already initialized on the ${n} Firebase App with different settings.${Z3?" You may need to reload as Firebase is not HMR aware.":""}`),wP("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function X3(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var Z3=typeof module<"u"&&!!module.hot,wP=(t,...e)=>{lw()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var al=new x("angularfire2.auth.use-emulator"),cl=new x("angularfire2.auth.settings"),ul=new x("angularfire2.auth.tenant-id"),ll=new x("angularfire2.auth.langugage-code"),dl=new x("angularfire2.auth.use-device-language"),hl=new x("angularfire.auth.persistence"),fl=(t,e,n,r,i,s,o,a)=>Hi(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let c=e.runOutsideAngular(()=>t.auth());if(n&&c.useEmulator(...n),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[u,l]of Object.entries(o))c.settings[u]=l;return a&&c.setPersistence(a),c},[n,r,i,s,o,a]),ci=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,c,u,l,d,h,f){let p=new ft,g=U(void 0).pipe(on(o.outsideAngular),De(()=>s.runOutsideAngular(()=>import("./chunk-I554UUAX.js"))),V(()=>ai(n,s,r)),V(m=>fl(m,s,a,u,l,d,c,h)),Gh({bufferSize:1,refCount:!1}));if(Gs(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=U(null);else{g.pipe(an()).subscribe();let m=g.pipe(De(b=>b.getRedirectResult().then(k=>k,()=>null)),Fe,Gh({bufferSize:1,refCount:!1})),E=g.pipe(De(b=>new ne(k=>({unsubscribe:s.runOutsideAngular(()=>b.onAuthStateChanged(q=>k.next(q),q=>k.error(q),()=>k.complete()))})))),S=g.pipe(De(b=>new ne(k=>({unsubscribe:s.runOutsideAngular(()=>b.onIdTokenChanged(q=>k.next(q),q=>k.error(q),()=>k.complete()))}))));this.authState=m.pipe(zh(E),Gn(o.outsideAngular),on(o.insideAngular)),this.user=m.pipe(zh(S),Gn(o.outsideAngular),on(o.insideAngular)),this.idToken=this.user.pipe(De(b=>b?oe(b.getIdToken()):U(null))),this.idTokenResult=this.user.pipe(De(b=>b?oe(b.getIdTokenResult()):U(null))),this.credential=Zo(m,p,this.authState.pipe(yt(b=>!b))).pipe(V(b=>b?.user?b:null),Gn(o.outsideAngular),on(o.insideAngular))}return EP(this,g,s,{spy:{apply:(m,E,S)=>{(m.startsWith("signIn")||m.startsWith("createUser"))&&S.then(b=>p.next(b))}}})}static \u0275fac=function(r){return new(r||t)(w(Cr),w(br,8),w(ot),w(se),w($i),w(al,8),w(cl,8),w(ul,8),w(ll,8),w(dl,8),w(hl,8),w(Jn,8))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),CP=(()=>{class t{constructor(){Ue.registerVersion("angularfire",er.full,"auth-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Me({type:t});static \u0275inj=Re({providers:[ci]})}return t})();var J3=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},rr={},P,WE=WE||{},J=J3||self;function Gp(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Sl(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function eW(t){return Object.prototype.hasOwnProperty.call(t,TE)&&t[TE]||(t[TE]=++tW)}var TE="closure_uid_"+(1e9*Math.random()>>>0),tW=0;function nW(t,e,n){return t.call.apply(t.bind,arguments)}function rW(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function kt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?kt=nW:kt=rW,kt.apply(null,arguments)}function Pp(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function wt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Gi(){this.s=this.s,this.o=this.o}var iW=0;Gi.prototype.s=!1;Gi.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),iW!=0)&&eW(this)};Gi.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var FP=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function KE(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function bP(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(Gp(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Ot(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Ot.prototype.h=function(){this.defaultPrevented=!0};var sW=function(){if(!J.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};J.addEventListener("test",n,e),J.removeEventListener("test",n,e)}catch{}return t}();function vl(t){return/^[\s\xa0]*$/.test(t)}function zp(){var t=J.navigator;return t&&(t=t.userAgent)?t:""}function Dr(t){return zp().indexOf(t)!=-1}function QE(t){return QE[" "](t),t}QE[" "]=function(){};function oW(t,e){var n=KW;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var aW=Dr("Opera"),ja=Dr("Trident")||Dr("MSIE"),LP=Dr("Edge"),RE=LP||ja,VP=Dr("Gecko")&&!(zp().toLowerCase().indexOf("webkit")!=-1&&!Dr("Edge"))&&!(Dr("Trident")||Dr("MSIE"))&&!Dr("Edge"),cW=zp().toLowerCase().indexOf("webkit")!=-1&&!Dr("Edge");function jP(){var t=J.document;return t?t.documentMode:void 0}var PE;e:{if(Np="",kp=function(){var t=zp();if(VP)return/rv:([^\);]+)(\)|;)/.exec(t);if(LP)return/Edge\/([\d\.]+)/.exec(t);if(ja)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(cW)return/WebKit\/(\S+)/.exec(t);if(aW)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),kp&&(Np=kp?kp[1]:""),ja&&(Op=jP(),Op!=null&&Op>parseFloat(Np))){PE=String(Op);break e}PE=Np}var Np,kp,Op,NE;J.document&&ja?(SE=jP(),NE=SE||parseInt(PE,10)||void 0):NE=void 0;var SE,uW=NE;function wl(t,e){if(Ot.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(VP){e:{try{QE(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:lW[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&wl.$.h.call(this)}}wt(wl,Ot);var lW={2:"touch",3:"pen",4:"mouse"};wl.prototype.h=function(){wl.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Al="closure_listenable_"+(1e6*Math.random()|0),dW=0;function hW(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++dW,this.fa=this.ia=!1}function Wp(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function YE(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function fW(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function UP(t){let e={};for(let n in t)e[n]=t[n];return e}var DP="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function BP(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<DP.length;s++)n=DP[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Kp(t){this.src=t,this.g={},this.h=0}Kp.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=OE(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new hW(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function kE(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=FP(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Wp(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function OE(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var XE="closure_lm_"+(1e6*Math.random()|0),AE={};function $P(t,e,n,r,i){if(r&&r.once)return HP(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)$P(t,e[s],n,r,i);return null}return n=eI(n),t&&t[Al]?t.O(e,n,Sl(r)?!!r.capture:!!r,i):qP(t,e,n,!1,r,i)}function qP(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Sl(i)?!!i.capture:!!i,a=JE(t);if(a||(t[XE]=a=new Kp(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=pW(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)sW||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(zP(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function pW(){function t(n){return e.call(t.src,t.listener,n)}let e=gW;return t}function HP(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)HP(t,e[s],n,r,i);return null}return n=eI(n),t&&t[Al]?t.P(e,n,Sl(r)?!!r.capture:!!r,i):qP(t,e,n,!0,r,i)}function GP(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)GP(t,e[s],n,r,i);else r=Sl(r)?!!r.capture:!!r,n=eI(n),t&&t[Al]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=OE(s,n,r,i),-1<n&&(Wp(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=JE(t))&&(e=t.g[e.toString()],t=-1,e&&(t=OE(e,n,r,i)),(n=-1<t?e[t]:null)&&ZE(n))}function ZE(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Al])kE(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(zP(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=JE(e))?(kE(n,t),n.h==0&&(n.src=null,e[XE]=null)):Wp(t)}}}function zP(t){return t in AE?AE[t]:AE[t]="on"+t}function gW(t,e){if(t.fa)t=!0;else{e=new wl(e,this);var n=t.listener,r=t.la||t.src;t.ia&&ZE(t),t=n.call(r,e)}return t}function JE(t){return t=t[XE],t instanceof Kp?t:null}var xE="__closure_events_fn_"+(1e9*Math.random()>>>0);function eI(t){return typeof t=="function"?t:(t[xE]||(t[xE]=function(e){return t.handleEvent(e)}),t[xE])}function vt(){Gi.call(this),this.i=new Kp(this),this.S=this,this.J=null}wt(vt,Gi);vt.prototype[Al]=!0;vt.prototype.removeEventListener=function(t,e,n,r){GP(this,t,e,n,r)};function Mt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Ot(e,t);else if(e instanceof Ot)e.target=e.target||t;else{var i=e;e=new Ot(r,t),BP(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Fp(o,r,!0,e)&&i}if(o=e.g=t,i=Fp(o,r,!0,e)&&i,i=Fp(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Fp(o,r,!1,e)&&i}vt.prototype.N=function(){if(vt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Wp(n[r]);delete t.g[e],t.h--}}this.J=null};vt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};vt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Fp(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&kE(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var tI=J.JSON.stringify,FE=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function mW(){var t=nI;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var LE=class{constructor(){this.h=this.g=null}add(e,n){let r=WP.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},WP=new FE(()=>new VE,t=>t.reset()),VE=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function yW(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function _W(t){J.setTimeout(()=>{throw t},0)}var El,Il=!1,nI=new LE,KP=()=>{let t=J.Promise.resolve(void 0);El=()=>{t.then(vW)}},vW=()=>{for(var t;t=mW();){try{t.h.call(t.g)}catch(n){_W(n)}var e=WP;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Il=!1};function Qp(t,e){vt.call(this),this.h=t||1,this.g=e||J,this.j=kt(this.qb,this),this.l=Date.now()}wt(Qp,vt);P=Qp.prototype;P.ga=!1;P.T=null;P.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Mt(this,"tick"),this.ga&&(rI(this),this.start()))}};P.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function rI(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}P.N=function(){Qp.$.N.call(this),rI(this),delete this.g};function iI(t,e,n){if(typeof t=="function")n&&(t=kt(t,n));else if(t&&typeof t.handleEvent=="function")t=kt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:J.setTimeout(t,e||0)}function QP(t){t.g=iI(()=>{t.g=null,t.i&&(t.i=!1,QP(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var jE=class extends Gi{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:QP(this)}N(){super.N(),this.g&&(J.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Cl(t){Gi.call(this),this.h=t,this.g={}}wt(Cl,Gi);var TP=[];function YP(t,e,n,r){Array.isArray(n)||(n&&(TP[0]=n.toString()),n=TP);for(var i=0;i<n.length;i++){var s=$P(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function XP(t){YE(t.g,function(e,n){this.g.hasOwnProperty(n)&&ZE(e)},t),t.g={}}Cl.prototype.N=function(){Cl.$.N.call(this),XP(this)};Cl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Yp(){this.g=!0}Yp.prototype.Ea=function(){this.g=!1};function wW(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function EW(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function La(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+CW(t,n)+(r?" "+r:"")})}function IW(t,e){t.info(function(){return"TIMEOUT: "+e})}Yp.prototype.info=function(){};function CW(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return tI(n)}catch{return e}}var Xs={},SP=null;function Xp(){return SP=SP||new vt}Xs.Ta="serverreachability";function ZP(t){Ot.call(this,Xs.Ta,t)}wt(ZP,Ot);function bl(t){let e=Xp();Mt(e,new ZP(e))}Xs.STAT_EVENT="statevent";function JP(t,e){Ot.call(this,Xs.STAT_EVENT,t),this.stat=e}wt(JP,Ot);function qt(t){let e=Xp();Mt(e,new JP(e,t))}Xs.Ua="timingevent";function eN(t,e){Ot.call(this,Xs.Ua,t),this.size=e}wt(eN,Ot);function xl(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return J.setTimeout(function(){t()},e)}var Zp={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},tN={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function sI(){}sI.prototype.h=null;function AP(t){return t.h||(t.h=t.i())}function nN(){}var Ml={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function oI(){Ot.call(this,"d")}wt(oI,Ot);function aI(){Ot.call(this,"c")}wt(aI,Ot);var UE;function Jp(){}wt(Jp,sI);Jp.prototype.g=function(){return new XMLHttpRequest};Jp.prototype.i=function(){return{}};UE=new Jp;function Rl(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Cl(this),this.P=bW,t=RE?125:void 0,this.V=new Qp(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new rN}function rN(){this.i=null,this.g="",this.h=!1}var bW=45e3,iN={},BE={};P=Rl.prototype;P.setTimeout=function(t){this.P=t};function $E(t,e,n){t.L=1,t.A=tg(li(e)),t.u=n,t.S=!0,sN(t,null)}function sN(t,e){t.G=Date.now(),Pl(t),t.B=li(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),fN(n.i,"t",r),t.o=0,n=t.l.J,t.h=new rN,t.g=kN(t.l,n?e:null,!t.u),0<t.O&&(t.M=new jE(kt(t.Pa,t,t.g),t.O)),YP(t.U,t.g,"readystatechange",t.nb),e=t.I?UP(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),bl(),wW(t.j,t.v,t.B,t.m,t.W,t.u)}P.nb=function(t){t=t.target;let e=this.M;e&&Tr(t)==3?e.l():this.Pa(t)};P.Pa=function(t){try{if(t==this.g)e:{let l=Tr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||RE||this.g&&(this.h.h||this.g.ja()||PP(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?bl(3):bl(2)),eg(this);var n=this.g.da();this.ca=n;t:if(oN(this)){var r=PP(this.g);t="";var i=r.length,s=Tr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ks(this),_l(this);var o="";break t}this.h.i=new J.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,EW(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!vl(a)){var u=a;break t}}u=null}if(n=u)La(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,qE(this,n);else{this.i=!1,this.s=3,qt(12),Ks(this),_l(this);break e}}this.S?(aN(this,l,o),RE&&this.i&&l==3&&(YP(this.U,this.V,"tick",this.mb),this.V.start())):(La(this.j,this.m,o,null),qE(this,o)),l==4&&Ks(this),this.i&&!this.J&&(l==4?MN(this.l,this):(this.i=!1,Pl(this)))}else GW(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,qt(12)):(this.s=0,qt(13)),Ks(this),_l(this)}}}catch{}finally{}};function oN(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function aN(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=DW(t,n),i==BE){e==4&&(t.s=4,qt(14),r=!1),La(t.j,t.m,null,"[Incomplete Response]");break}else if(i==iN){t.s=4,qt(15),La(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else La(t.j,t.m,i,null),qE(t,i);oN(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,qt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),fI(e),e.M=!0,qt(11))):(La(t.j,t.m,n,"[Invalid Chunked Response]"),Ks(t),_l(t))}P.mb=function(){if(this.g){var t=Tr(this.g),e=this.g.ja();this.o<e.length&&(eg(this),aN(this,t,e),this.i&&t!=4&&Pl(this))}};function DW(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?BE:(n=Number(e.substring(n,r)),isNaN(n)?iN:(r+=1,r+n>e.length?BE:(e=e.slice(r,r+n),t.o=r+n,e)))}P.cancel=function(){this.J=!0,Ks(this)};function Pl(t){t.Y=Date.now()+t.P,cN(t,t.P)}function cN(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=xl(kt(t.lb,t),e)}function eg(t){t.C&&(J.clearTimeout(t.C),t.C=null)}P.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(IW(this.j,this.B),this.L!=2&&(bl(),qt(17)),Ks(this),this.s=2,_l(this)):cN(this,this.Y-t)};function _l(t){t.l.H==0||t.J||MN(t.l,t)}function Ks(t){eg(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,rI(t.V),XP(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function qE(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||HE(n.i,t))){if(!t.K&&HE(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Bp(n),ig(n);else break e;hI(n),qt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=xl(kt(n.ib,n),6e3));if(1>=mN(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Qs(n,11)}else if((t.K||n.g==t)&&Bp(n),!vl(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];let l=u[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=u[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=u[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(cI(s,s.h),s.h=null))}if(r.F){let g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,ke(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=NN(r,r.J?r.pa:null,r.Y),o.K){yN(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(eg(a),Pl(a)),r.g=o}else AN(r);0<n.j.length&&sg(n)}else u[0]!="stop"&&u[0]!="close"||Qs(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?Qs(n,7):dI(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}bl(4)}catch{}}function TW(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Gp(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function SW(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Gp(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function uN(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Gp(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=SW(t),r=TW(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var lN=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function AW(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ys(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ys){this.h=t.h,jp(this,t.j),this.s=t.s,this.g=t.g,Up(this,t.m),this.l=t.l;var e=t.i,n=new Dl;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),xP(this,n),this.o=t.o}else t&&(e=String(t).match(lN))?(this.h=!1,jp(this,e[1]||"",!0),this.s=ml(e[2]||""),this.g=ml(e[3]||"",!0),Up(this,e[4]),this.l=ml(e[5]||"",!0),xP(this,e[6]||"",!0),this.o=ml(e[7]||"")):(this.h=!1,this.i=new Dl(null,this.h))}Ys.prototype.toString=function(){var t=[],e=this.j;e&&t.push(yl(e,MP,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(yl(e,MP,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(yl(n,n.charAt(0)=="/"?RW:MW,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",yl(n,NW)),t.join("")};function li(t){return new Ys(t)}function jp(t,e,n){t.j=n?ml(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Up(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function xP(t,e,n){e instanceof Dl?(t.i=e,kW(t.i,t.h)):(n||(e=yl(e,PW)),t.i=new Dl(e,t.h))}function ke(t,e,n){t.i.set(e,n)}function tg(t){return ke(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function ml(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function yl(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,xW),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function xW(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var MP=/[#\/\?@]/g,MW=/[#\?:]/g,RW=/[#\?]/g,PW=/[#\?@]/g,NW=/#/g;function Dl(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function zi(t){t.g||(t.g=new Map,t.h=0,t.i&&AW(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}P=Dl.prototype;P.add=function(t,e){zi(this),this.i=null,t=Ua(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function dN(t,e){zi(t),e=Ua(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function hN(t,e){return zi(t),e=Ua(t,e),t.g.has(e)}P.forEach=function(t,e){zi(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};P.ta=function(){zi(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};P.Z=function(t){zi(this);let e=[];if(typeof t=="string")hN(this,t)&&(e=e.concat(this.g.get(Ua(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};P.set=function(t,e){return zi(this),this.i=null,t=Ua(this,t),hN(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};P.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function fN(t,e,n){dN(t,e),0<n.length&&(t.i=null,t.g.set(Ua(t,e),KE(n)),t.h+=n.length)}P.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Ua(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function kW(t,e){e&&!t.j&&(zi(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(dN(this,r),fN(this,i,n))},t)),t.j=e}var OW=class{constructor(t,e){this.g=t,this.map=e}};function pN(t){this.l=t||FW,J.PerformanceNavigationTiming?(t=J.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(J.g&&J.g.Ka&&J.g.Ka()&&J.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var FW=10;function gN(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function mN(t){return t.h?1:t.g?t.g.size:0}function HE(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function cI(t,e){t.g?t.g.add(e):t.h=e}function yN(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}pN.prototype.cancel=function(){if(this.i=_N(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function _N(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return KE(t.i)}var LW=class{stringify(t){return J.JSON.stringify(t,void 0)}parse(t){return J.JSON.parse(t,void 0)}};function VW(){this.g=new LW}function jW(t,e,n){let r=n||"";try{uN(t,function(i,s){let o=i;Sl(i)&&(o=tI(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function UW(t,e){let n=new Yp;if(J.Image){let r=new Image;r.onload=Pp(Lp,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Pp(Lp,n,r,"TestLoadImage: error",!1,e),r.onabort=Pp(Lp,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Pp(Lp,n,r,"TestLoadImage: timeout",!1,e),J.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Lp(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Nl(t){this.l=t.ec||null,this.j=t.ob||!1}wt(Nl,sI);Nl.prototype.g=function(){return new ng(this.l,this.j)};Nl.prototype.i=function(t){return function(){return t}}({});function ng(t,e){vt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=uI,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}wt(ng,vt);var uI=0;P=ng.prototype;P.open=function(t,e){if(this.readyState!=uI)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Tl(this)};P.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||J).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};P.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,kl(this)),this.readyState=uI};P.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Tl(this)),this.g&&(this.readyState=3,Tl(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof J.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vN(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function vN(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}P.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?kl(this):Tl(this),this.readyState==3&&vN(this)}};P.Za=function(t){this.g&&(this.response=this.responseText=t,kl(this))};P.Ya=function(t){this.g&&(this.response=t,kl(this))};P.ka=function(){this.g&&kl(this)};function kl(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Tl(t)}P.setRequestHeader=function(t,e){this.v.append(t,e)};P.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};P.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Tl(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(ng.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var BW=J.JSON.parse;function Ke(t){vt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=wN,this.L=this.M=!1}wt(Ke,vt);var wN="",$W=/^https?$/i,qW=["POST","PUT"];P=Ke.prototype;P.Oa=function(t){this.M=t};P.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():UE.g(),this.C=this.u?AP(this.u):AP(UE),this.g.onreadystatechange=kt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){RP(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=J.FormData&&t instanceof J.FormData,!(0<=FP(qW,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{CN(this),0<this.B&&((this.L=HW(this.g))?(this.g.timeout=this.B,this.g.ontimeout=kt(this.ua,this)):this.A=iI(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){RP(this,s)}};function HW(t){return ja&&typeof t.timeout=="number"&&t.ontimeout!==void 0}P.ua=function(){typeof WE<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Mt(this,"timeout"),this.abort(8))};function RP(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,EN(t),rg(t)}function EN(t){t.F||(t.F=!0,Mt(t,"complete"),Mt(t,"error"))}P.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Mt(this,"complete"),Mt(this,"abort"),rg(this))};P.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),rg(this,!0)),Ke.$.N.call(this)};P.La=function(){this.s||(this.G||this.v||this.l?IN(this):this.kb())};P.kb=function(){IN(this)};function IN(t){if(t.h&&typeof WE<"u"&&(!t.C[1]||Tr(t)!=4||t.da()!=2)){if(t.v&&Tr(t)==4)iI(t.La,0,t);else if(Mt(t,"readystatechange"),Tr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(lN)[1]||null;!i&&J.self&&J.self.location&&(i=J.self.location.protocol.slice(0,-1)),r=!$W.test(i?i.toLowerCase():"")}n=r}if(n)Mt(t,"complete"),Mt(t,"success");else{t.m=6;try{var s=2<Tr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",EN(t)}}finally{rg(t)}}}}function rg(t,e){if(t.g){CN(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Mt(t,"ready");try{n.onreadystatechange=r}catch{}}}function CN(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(J.clearTimeout(t.A),t.A=null)}P.isActive=function(){return!!this.g};function Tr(t){return t.g?t.g.readyState:0}P.da=function(){try{return 2<Tr(this)?this.g.status:-1}catch{return-1}};P.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};P.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),BW(e)}};function PP(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case wN:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function GW(t){let e={};t=(t.g&&2<=Tr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(vl(t[r]))continue;var n=yW(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}fW(e,function(r){return r.join(", ")})}P.Ia=function(){return this.m};P.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function bN(t){let e="";return YE(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function lI(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=bN(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):ke(t,e,n))}function pl(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function DN(t){this.Ga=0,this.j=[],this.l=new Yp,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=pl("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=pl("baseRetryDelayMs",5e3,t),this.hb=pl("retryDelaySeedMs",1e4,t),this.eb=pl("forwardChannelMaxRetries",2,t),this.xa=pl("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new pN(t&&t.concurrentRequestLimit),this.Ja=new VW,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}P=DN.prototype;P.ra=8;P.H=1;function dI(t){if(TN(t),t.H==3){var e=t.W++,n=li(t.I);if(ke(n,"SID",t.K),ke(n,"RID",e),ke(n,"TYPE","terminate"),Ol(t,n),e=new Rl(t,t.l,e),e.L=2,e.A=tg(li(n)),n=!1,J.navigator&&J.navigator.sendBeacon)try{n=J.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&J.Image&&(new Image().src=e.A,n=!0),n||(e.g=kN(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Pl(e)}PN(t)}function ig(t){t.g&&(fI(t),t.g.cancel(),t.g=null)}function TN(t){ig(t),t.u&&(J.clearTimeout(t.u),t.u=null),Bp(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&J.clearTimeout(t.m),t.m=null)}function sg(t){if(!gN(t.i)&&!t.m){t.m=!0;var e=t.Na;El||KP(),Il||(El(),Il=!0),nI.add(e,t),t.C=0}}function zW(t,e){return mN(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=xl(kt(t.Na,t,e),RN(t,t.C)),t.C++,!0)}P.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Rl(this,this.l,t),s=this.s;if(this.U&&(s?(s=UP(s),BP(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=SN(this,i,e),n=li(this.I),ke(n,"RID",t),ke(n,"CVER",22),this.F&&ke(n,"X-HTTP-Session-Id",this.F),Ol(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(bN(s)))+"&"+e:this.o&&lI(n,this.o,s)),cI(this.i,i),this.bb&&ke(n,"TYPE","init"),this.P?(ke(n,"$req",e),ke(n,"SID","null"),i.aa=!0,$E(i,n,null)):$E(i,n,e),this.H=2}}else this.H==3&&(t?NP(this,t):this.j.length==0||gN(this.i)||NP(this))};function NP(t,e){var n;e?n=e.m:n=t.W++;let r=li(t.I);ke(r,"SID",t.K),ke(r,"RID",n),ke(r,"AID",t.V),Ol(t,r),t.o&&t.s&&lI(r,t.o,t.s),n=new Rl(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=SN(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),cI(t.i,n),$E(n,r,e)}function Ol(t,e){t.na&&YE(t.na,function(n,r){ke(e,r,n)}),t.h&&uN({},function(n,r){ke(e,r,n)})}function SN(t,e,n){n=Math.min(t.j.length,n);var r=t.h?kt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let u=i[c].g,l=i[c].map;if(u-=s,0>u)s=Math.max(0,i[c].g-100),a=!1;else try{jW(l,o,"req"+u+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function AN(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;El||KP(),Il||(El(),Il=!0),nI.add(e,t),t.A=0}}function hI(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=xl(kt(t.Ma,t),RN(t,t.A)),t.A++,!0)}P.Ma=function(){if(this.u=null,xN(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=xl(kt(this.jb,this),t)}};P.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,qt(10),ig(this),xN(this))};function fI(t){t.B!=null&&(J.clearTimeout(t.B),t.B=null)}function xN(t){t.g=new Rl(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=li(t.wa);ke(e,"RID","rpc"),ke(e,"SID",t.K),ke(e,"AID",t.V),ke(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&ke(e,"TO",t.qa),ke(e,"TYPE","xmlhttp"),Ol(t,e),t.o&&t.s&&lI(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=tg(li(e)),n.u=null,n.S=!0,sN(n,t)}P.ib=function(){this.v!=null&&(this.v=null,ig(this),hI(this),qt(19))};function Bp(t){t.v!=null&&(J.clearTimeout(t.v),t.v=null)}function MN(t,e){var n=null;if(t.g==e){Bp(t),fI(t),t.g=null;var r=2}else if(HE(t.i,e))n=e.F,yN(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=Xp(),Mt(r,new eN(r,n)),sg(t)}else AN(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&zW(t,e)||r==2&&hI(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Qs(t,5);break;case 4:Qs(t,10);break;case 3:Qs(t,6);break;default:Qs(t,2)}}}function RN(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Qs(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=kt(t.pb,t);n||(n=new Ys("//www.google.com/images/cleardot.gif"),J.location&&J.location.protocol=="http"||jp(n,"https"),tg(n)),UW(n.toString(),r)}else qt(2);t.H=0,t.h&&t.h.za(e),PN(t),TN(t)}P.pb=function(t){t?(this.l.info("Successfully pinged google.com"),qt(2)):(this.l.info("Failed to ping google.com"),qt(1))};function PN(t){if(t.H=0,t.ma=[],t.h){let e=_N(t.i);(e.length!=0||t.j.length!=0)&&(bP(t.ma,e),bP(t.ma,t.j),t.i.i.length=0,KE(t.j),t.j.length=0),t.h.ya()}}function NN(t,e,n){var r=n instanceof Ys?li(n):new Ys(n);if(r.g!="")e&&(r.g=e+"."+r.g),Up(r,r.m);else{var i=J.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Ys(null);r&&jp(s,r),e&&(s.g=e),i&&Up(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&ke(r,n,e),ke(r,"VER",t.ra),Ol(t,r),r}function kN(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new Ke(new Nl({ob:n})):new Ke(t.va),e.Oa(t.J),e}P.isActive=function(){return!!this.h&&this.h.isActive(this)};function ON(){}P=ON.prototype;P.Ba=function(){};P.Aa=function(){};P.za=function(){};P.ya=function(){};P.isActive=function(){return!0};P.Va=function(){};function $p(){if(ja&&!(10<=Number(uW)))throw Error("Environmental error: no available transport.")}$p.prototype.g=function(t,e){return new mn(t,e)};function mn(t,e){vt.call(this),this.g=new DN(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!vl(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!vl(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Ba(this)}wt(mn,vt);mn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;qt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=NN(t,null,t.Y),sg(t)};mn.prototype.close=function(){dI(this.g)};mn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=tI(t),t=n);e.j.push(new OW(e.fb++,t)),e.H==3&&sg(e)};mn.prototype.N=function(){this.g.h=null,delete this.j,dI(this.g),delete this.g,mn.$.N.call(this)};function FN(t){oI.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}wt(FN,oI);function LN(){aI.call(this),this.status=1}wt(LN,aI);function Ba(t){this.g=t}wt(Ba,ON);Ba.prototype.Ba=function(){Mt(this.g,"a")};Ba.prototype.Aa=function(t){Mt(this.g,new FN(t))};Ba.prototype.za=function(t){Mt(this.g,new LN)};Ba.prototype.ya=function(){Mt(this.g,"b")};function WW(){this.blockSize=-1}function nr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}wt(nr,WW);nr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function ME(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}nr.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)ME(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){ME(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){ME(this,r),i=0;break}}this.h=i,this.i+=e};nr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Ce(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var KW={};function pI(t){return-128<=t&&128>t?oW(t,function(e){return new Ce([e|0],0>e?-1:0)}):new Ce([t|0],0>t?-1:0)}function Sr(t){if(isNaN(t)||!isFinite(t))return Va;if(0>t)return xt(Sr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=GE;return new Ce(e,0)}function VN(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return xt(VN(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Sr(Math.pow(e,8)),r=Va,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Sr(Math.pow(e,s)),r=r.R(s).add(Sr(o))):(r=r.R(n),r=r.add(Sr(o)))}return r}var GE=4294967296,Va=pI(0),zE=pI(1),kP=pI(16777216);P=Ce.prototype;P.ea=function(){if(On(this))return-xt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:GE+r)*e,e*=GE}return t};P.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(ui(this))return"0";if(On(this))return"-"+xt(this).toString(t);for(var e=Sr(Math.pow(t,6)),n=this,r="";;){var i=Hp(n,e).g;n=qp(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,ui(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};P.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function ui(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function On(t){return t.h==-1}P.X=function(t){return t=qp(this,t),On(t)?-1:ui(t)?0:1};function xt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ce(n,~t.h).add(zE)}P.abs=function(){return On(this)?xt(this):this};P.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Ce(n,n[n.length-1]&-2147483648?-1:0)};function qp(t,e){return t.add(xt(e))}P.R=function(t){if(ui(this)||ui(t))return Va;if(On(this))return On(t)?xt(this).R(xt(t)):xt(xt(this).R(t));if(On(t))return xt(this.R(xt(t)));if(0>this.X(kP)&&0>t.X(kP))return Sr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,Vp(n,2*r+2*i),n[2*r+2*i+1]+=s*c,Vp(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Vp(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Vp(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ce(n,0)};function Vp(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function gl(t,e){this.g=t,this.h=e}function Hp(t,e){if(ui(e))throw Error("division by zero");if(ui(t))return new gl(Va,Va);if(On(t))return e=Hp(xt(t),e),new gl(xt(e.g),xt(e.h));if(On(e))return e=Hp(t,xt(e)),new gl(xt(e.g),e.h);if(30<t.g.length){if(On(t)||On(e))throw Error("slowDivide_ only works with positive integers.");for(var n=zE,r=e;0>=r.X(t);)n=OP(n),r=OP(r);var i=Fa(n,1),s=Fa(r,1);for(r=Fa(r,2),n=Fa(n,2);!ui(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Fa(r,1),n=Fa(n,1)}return e=qp(t,i.R(e)),new gl(i,e)}for(i=Va;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Sr(n),o=s.R(e);On(o)||0<o.X(t);)n-=r,s=Sr(n),o=s.R(e);ui(s)&&(s=zE),i=i.add(s),t=qp(t,o)}return new gl(i,t)}P.gb=function(t){return Hp(this,t).h};P.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ce(n,this.h&t.h)};P.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ce(n,this.h|t.h)};P.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ce(n,this.h^t.h)};function OP(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ce(n,t.h)}function Fa(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ce(i,t.h)}$p.prototype.createWebChannel=$p.prototype.g;mn.prototype.send=mn.prototype.u;mn.prototype.open=mn.prototype.m;mn.prototype.close=mn.prototype.close;Zp.NO_ERROR=0;Zp.TIMEOUT=8;Zp.HTTP_ERROR=6;tN.COMPLETE="complete";nN.EventType=Ml;Ml.OPEN="a";Ml.CLOSE="b";Ml.ERROR="c";Ml.MESSAGE="d";vt.prototype.listen=vt.prototype.O;Ke.prototype.listenOnce=Ke.prototype.P;Ke.prototype.getLastError=Ke.prototype.Sa;Ke.prototype.getLastErrorCode=Ke.prototype.Ia;Ke.prototype.getStatus=Ke.prototype.da;Ke.prototype.getResponseJson=Ke.prototype.Wa;Ke.prototype.getResponseText=Ke.prototype.ja;Ke.prototype.send=Ke.prototype.ha;Ke.prototype.setWithCredentials=Ke.prototype.Oa;nr.prototype.digest=nr.prototype.l;nr.prototype.reset=nr.prototype.reset;nr.prototype.update=nr.prototype.j;Ce.prototype.add=Ce.prototype.add;Ce.prototype.multiply=Ce.prototype.R;Ce.prototype.modulo=Ce.prototype.gb;Ce.prototype.compare=Ce.prototype.X;Ce.prototype.toNumber=Ce.prototype.ea;Ce.prototype.toString=Ce.prototype.toString;Ce.prototype.getBits=Ce.prototype.D;Ce.fromNumber=Sr;Ce.fromString=VN;var jN=rr.createWebChannelTransport=function(){return new $p},UN=rr.getStatEventTarget=function(){return Xp()},og=rr.ErrorCode=Zp,BN=rr.EventType=tN,$N=rr.Event=Xs,gI=rr.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Rae=rr.FetchXmlHttpFactory=Nl,Fl=rr.WebChannel=nN,qN=rr.XhrIo=Ke,HN=rr.Md5=nr,Zs=rr.Integer=Ce;var GN="@firebase/firestore";var ut=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ut.UNAUTHENTICATED=new ut(null),ut.GOOGLE_CREDENTIALS=new ut("google-credentials-uid"),ut.FIRST_PARTY=new ut("first-party-uid"),ut.MOCK_USER=new ut("mock-user");var yc="10.8.0";var Ji=new Ci("@firebase/firestore");function za(){return Ji.logLevel}function Gk(t){Ji.setLogLevel(t)}function C(t,...e){if(Ji.logLevel<=Dn.DEBUG){let n=e.map(y0);Ji.debug(`Firestore (${yc}): ${t}`,...n)}}function Je(t,...e){if(Ji.logLevel<=Dn.ERROR){let n=e.map(y0);Ji.error(`Firestore (${yc}): ${t}`,...n)}}function Ln(t,...e){if(Ji.logLevel<=Dn.WARN){let n=e.map(y0);Ji.warn(`Firestore (${yc}): ${t}`,...n)}}function y0(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function L(t="Unexpected state"){let e=`FIRESTORE (${yc}) INTERNAL ASSERTION FAILED: `+t;throw Je(e),new Error(e)}function $(t,e){t||L()}function zk(t,e){t||L()}function N(t,e){return t}var v={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},I=class extends mh{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var lt=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var yg=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},wI=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ut.UNAUTHENTICATED))}shutdown(){}},EI=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},II=class{constructor(e){this.t=e,this.currentUser=ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new lt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new lt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>y(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{C("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(C("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new lt)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(C("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?($(typeof r.accessToken=="string"),new yg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return $(e===null||typeof e=="string"),new ut(e)}},CI=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=ut.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},bI=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new CI(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}},DI=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},TI=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&C("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,C("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{C("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):C("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?($(typeof n.token=="string"),this.R=n.token,new DI(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function QW(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var _g=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=QW(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function ee(t,e){return t<e?-1:t>e?1:0}function tc(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function Wk(t){return t+"\0"}var He=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new I(v.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new I(v.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new I(v.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new I(v.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var H=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new He(0,0))}static max(){return new t(new He(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var vg=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&L(),r===void 0?r=e.length-n:r>e.length-n&&L(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},ge=class t extends vg{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new I(v.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},YW=/^[_a-zA-Z][_a-zA-Z0-9]*$/,et=class t extends vg{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return YW.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new I(v.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new I(v.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new I(v.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new I(v.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var R=class t{constructor(e){this.path=e}static fromPath(e){return new t(ge.fromString(e))}static fromName(e){return new t(ge.fromString(e).popFirst(5))}static empty(){return new t(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new ge(e.slice()))}};var nc=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function SI(t){return t.fields.find(e=>e.kind===2)}function eo(t){return t.fields.filter(e=>e.kind!==2)}nc.UNKNOWN_ID=-1;var Za=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var Kl=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Vn.min())}};function Kk(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=H.fromTimestamp(r===1e9?new He(n+1,0):new He(n,r));return new Vn(i,R.empty(),e)}function Qk(t){return new Vn(t.readTime,t.key,-1)}var Vn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(H.min(),R.empty(),-1)}static max(){return new t(H.max(),R.empty(),-1)}};function _0(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=R.comparator(t.documentKey,e.documentKey),n!==0?n:ee(t.largestBatchId,e.largestBatchId))}var Yk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",wg=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function us(t){return y(this,null,function*(){if(t.code!==v.FAILED_PRECONDITION||t.message!==Yk)throw t;C("LocalStore","Unexpectedly lost primary lease")})}var _=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&L(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;n(e[u]).next(l=>{o[u]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Eg=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new lt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new oo(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=v0(r.target.error);this.V.reject(new oo(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new oo(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(C("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new xI(n)}},fi=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(ru())===12.2&&Je("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return C("SimpleDb","Removing database:",e),to(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!gh())return!1;if(t.C())return!0;let e=ru(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return y(this,null,function*(){return this.db||(C("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new oo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new I(v.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new I(v.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new oo(e,o))},i.onupgradeneeded=s=>{C("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{C("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db})}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return y(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=Eg.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),_.reject(u))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,u=c.name!=="FirebaseError"&&o<3;if(C("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}},AI=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return to(this.k.delete())}},oo=class extends I{constructor(e,n){super(v.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function ls(t){return t.name==="IndexedDbTransactionError"}var xI=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(C("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(C("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),to(r)}add(e){return C("SimpleDb","ADD",this.store.name,e,e),to(this.store.add(e))}get(e){return to(this.store.get(e)).next(n=>(n===void 0&&(n=null),C("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return C("SimpleDb","DELETE",this.store.name,e),to(this.store.delete(e))}count(){return C("SimpleDb","COUNT",this.store.name),to(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new _((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,c)=>{o.push(c)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new _((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){C("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new _((r,i)=>{n.onerror=s=>{let o=v0(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new _((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new AI(a),u=n(a.primaryKey,a.value,c);if(u instanceof _){let l=u.catch(d=>(c.done(),_.reject(d)));r.push(l)}c.isDone?i():c.$===null?a.continue():a.continue(c.$)}}).next(()=>_.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function to(t){return new _((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=v0(r.target.error);n(i)}})}var zN=!1;function v0(t){let e=fi.S(ru());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new I("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return zN||(zN=!0,setTimeout(()=>{throw r},0)),r}}return t}var MI=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){C("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>y(this,null,function*(){this.task=null;try{C("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){ls(n)?C("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield us(n)}yield this.ee(6e4)}))}},RI=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return y(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return _.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return C("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(C("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=Qk(s);_0(o,r)>0&&(r=o)}),new Vn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var yn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function yd(t){return t==null}function Ql(t){return t===0&&1/t==-1/0}function Xk(t){return typeof t=="number"&&Number.isInteger(t)&&!Ql(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Ht(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=WN(e)),e=XW(t.get(n),e);return WN(e)}function XW(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function WN(t){return t+""}function Ar(t){let e=t.length;if($(e>=2),e===2)return $(t.charAt(0)===""&&t.charAt(1)===""),ge.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&L(),t.charAt(o+1)){case"":let a=t.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:L()}s=o+2}return new ge(r)}var KN=["userId","batchId"];function dg(t,e){return[t,Ht(e)]}function Zk(t,e,n){return[t,Ht(e),n]}var ZW={},JW=["prefixPath","collectionGroup","readTime","documentId"],e6=["prefixPath","collectionGroup","documentId"],t6=["collectionGroup","readTime","prefixPath","documentId"],n6=["canonicalId","targetId"],r6=["targetId","path"],i6=["path","targetId"],s6=["collectionId","parent"],o6=["indexId","uid"],a6=["uid","sequenceNumber"],c6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],u6=["indexId","uid","orderedDocumentKey"],l6=["userId","collectionPath","documentId"],d6=["userId","collectionPath","largestBatchId"],h6=["userId","collectionGroup","largestBatchId"],Jk=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],f6=[...Jk,"documentOverlays"],eO=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],tO=eO,p6=[...tO,"indexConfiguration","indexState","indexEntries"];var Yl=class extends wg{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function It(t,e){let n=N(t);return fi.M(n.ae,e)}function QN(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function vo(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function nO(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Oe=class t{constructor(e,n){this.comparator=e,this.root=n||Mr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Mr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Mr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Xa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Xa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Xa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Xa(this.root,e,this.comparator,!0)}},Xa=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Mr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw L();let e=this.left.check();if(e!==this.right.check())throw L();return e+(this.isRed()?0:1)}};Mr.EMPTY=null,Mr.RED=!0,Mr.BLACK=!1;Mr.EMPTY=new class{constructor(){this.size=0}get key(){throw L()}get value(){throw L()}get color(){throw L()}get left(){throw L()}get right(){throw L()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Mr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ae=class t{constructor(e){this.comparator=e,this.data=new Oe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ig(this.data.getIterator())}getIteratorFrom(e){return new Ig(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Ig=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function $a(t){return t.hasNext()?t.getNext():void 0}var _n=class t{constructor(e){this.fields=e,e.sort(et.comparator)}static empty(){return new t([])}unionWith(e){let n=new Ae(et.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return tc(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Cg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function rO(){return typeof atob<"u"}var Et=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Cg("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Et.EMPTY_BYTE_STRING=new Et("");var g6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function es(t){if($(!!t),typeof t=="string"){let e=0,n=g6.exec(t);if($(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qe(t.seconds),nanos:Qe(t.nanos)}}function Qe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ts(t){return typeof t=="string"?Et.fromBase64String(t):Et.fromUint8Array(t)}function fm(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function w0(t){let e=t.mapValue.fields.__previous_value__;return fm(e)?w0(e):e}function Xl(t){let e=es(t.mapValue.fields.__local_write_time__.timestampValue);return new He(e.seconds,e.nanos)}var PI=class{constructor(e,n,r,i,s,o,a,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},ns=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Xi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},hg={nullValue:"NULL_VALUE"};function ao(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fm(t)?4:iO(t)?9007199254740991:10:L()}function Nr(t,e){if(t===e)return!0;let n=ao(t);if(n!==ao(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Xl(t).isEqual(Xl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=es(i.timestampValue),a=es(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ts(i.bytesValue).isEqual(ts(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Qe(i.geoPointValue.latitude)===Qe(s.geoPointValue.latitude)&&Qe(i.geoPointValue.longitude)===Qe(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Qe(i.integerValue)===Qe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Qe(i.doubleValue),a=Qe(s.doubleValue);return o===a?Ql(o)===Ql(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return tc(t.arrayValue.values||[],e.arrayValue.values||[],Nr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(QN(o)!==QN(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Nr(o[c],a[c])))return!1;return!0}(t,e);default:return L()}}function Zl(t,e){return(t.values||[]).find(n=>Nr(n,e))!==void 0}function rs(t,e){if(t===e)return 0;let n=ao(t),r=ao(e);if(n!==r)return ee(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ee(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Qe(s.integerValue||s.doubleValue),c=Qe(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return YN(t.timestampValue,e.timestampValue);case 4:return YN(Xl(t),Xl(e));case 5:return ee(t.stringValue,e.stringValue);case 6:return function(s,o){let a=ts(s),c=ts(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let l=ee(a[u],c[u]);if(l!==0)return l}return ee(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ee(Qe(s.latitude),Qe(o.latitude));return a!==0?a:ee(Qe(s.longitude),Qe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){let l=rs(a[u],c[u]);if(l)return l}return ee(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Xi.mapValue&&o===Xi.mapValue)return 0;if(s===Xi.mapValue)return 1;if(o===Xi.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},l=Object.keys(u);c.sort(),l.sort();for(let d=0;d<c.length&&d<l.length;++d){let h=ee(c[d],l[d]);if(h!==0)return h;let f=rs(a[c[d]],u[l[d]]);if(f!==0)return f}return ee(c.length,l.length)}(t.mapValue,e.mapValue);default:throw L()}}function YN(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ee(t,e);let n=es(t),r=es(e),i=ee(n.seconds,r.seconds);return i!==0?i:ee(n.nanos,r.nanos)}function rc(t){return NI(t)}function NI(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=es(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ts(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return R.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=NI(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${NI(n.fields[o])}`;return i+"}"}(t.mapValue):L()}function co(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function kI(t){return!!t&&"integerValue"in t}function Jl(t){return!!t&&"arrayValue"in t}function XN(t){return!!t&&"nullValue"in t}function ZN(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function fg(t){return!!t&&"mapValue"in t}function ql(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return vo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ql(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ql(t.arrayValue.values[n]);return e}return Object.assign({},t)}function iO(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function m6(t){return"nullValue"in t?hg:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?co(ns.empty(),R.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:L()}function y6(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?co(ns.empty(),R.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Xi:L()}function JN(t,e){let n=rs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function ek(t,e){let n=rs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var Lt=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!fg(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ql(n)}setAll(e){let n=et.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=ql(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());fg(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Nr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];fg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){vo(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(ql(this.value))}};function sO(t){let e=[];return vo(t.fields,(n,r)=>{let i=new et([n]);if(fg(r)){let s=sO(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new _n(e)}var dt=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,H.min(),H.min(),H.min(),Lt.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,H.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,H.min(),H.min(),Lt.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,H.min(),H.min(),Lt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(H.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=H.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var kr=class{constructor(e,n){this.position=e,this.inclusive=n}};function tk(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=R.comparator(R.fromName(o.referenceValue),n.key):r=rs(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function nk(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Nr(t.position[n],e.position[n]))return!1;return!0}var uo=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function _6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var bg=class{},fe=class t extends bg{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new LI(e,n,r):n==="array-contains"?new UI(e,r):n==="in"?new Dg(e,r):n==="not-in"?new BI(e,r):n==="array-contains-any"?new $I(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new VI(e,r):new jI(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(rs(n,this.value)):n!==null&&ao(this.value)===ao(n)&&this.matchesComparison(rs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return L()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},be=class t extends bg{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return ic(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function ic(t){return t.op==="and"}function OI(t){return t.op==="or"}function E0(t){return oO(t)&&ic(t)}function oO(t){for(let e of t.filters)if(e instanceof be)return!1;return!0}function FI(t){if(t instanceof fe)return t.field.canonicalString()+t.op.toString()+rc(t.value);if(E0(t))return t.filters.map(e=>FI(e)).join(",");{let e=t.filters.map(n=>FI(n)).join(",");return`${t.op}(${e})`}}function aO(t,e){return t instanceof fe?function(r,i){return i instanceof fe&&r.op===i.op&&r.field.isEqual(i.field)&&Nr(r.value,i.value)}(t,e):t instanceof be?function(r,i){return i instanceof be&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&aO(o,i.filters[a]),!0):!1}(t,e):void L()}function cO(t,e){let n=t.filters.concat(e);return be.create(n,t.op)}function uO(t){return t instanceof fe?function(n){return`${n.field.canonicalString()} ${n.op} ${rc(n.value)}`}(t):t instanceof be?function(n){return n.op.toString()+" {"+n.getFilters().map(uO).join(" ,")+"}"}(t):"Filter"}var LI=class extends fe{constructor(e,n,r){super(e,n,r),this.key=R.fromName(r.referenceValue)}matches(e){let n=R.comparator(e.key,this.key);return this.matchesComparison(n)}},VI=class extends fe{constructor(e,n){super(e,"in",n),this.keys=lO("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},jI=class extends fe{constructor(e,n){super(e,"not-in",n),this.keys=lO("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function lO(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>R.fromName(r.referenceValue))}var UI=class extends fe{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return Jl(n)&&Zl(n.arrayValue,this.value)}},Dg=class extends fe{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Zl(this.value.arrayValue,n)}},BI=class extends fe{constructor(e,n){super(e,"not-in",n)}matches(e){if(Zl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Zl(this.value.arrayValue,n)}},$I=class extends fe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!Jl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Zl(this.value.arrayValue,r))}};var qI=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function HI(t,e=null,n=[],r=[],i=null,s=null,o=null){return new qI(t,e,n,r,i,s,o)}function lo(t){let e=N(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>FI(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),yd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>rc(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>rc(r)).join(",")),e.ce=n}return e.ce}function _d(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!_6(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!aO(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!nk(t.startAt,e.startAt)&&nk(t.endAt,e.endAt)}function Tg(t){return R.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Sg(t,e){return t.filters.filter(n=>n instanceof fe&&n.field.isEqual(e))}function rk(t,e,n){let r=hg,i=!0;for(let s of Sg(t,e)){let o=hg,a=!0;switch(s.op){case"<":case"<=":o=m6(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=hg}JN({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];JN({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function ik(t,e,n){let r=Xi,i=!0;for(let s of Sg(t,e)){let o=Xi,a=!0;switch(s.op){case">=":case">":o=y6(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Xi}ek({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];ek({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var ir=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function dO(t,e,n,r,i,s,o,a){return new ir(t,e,n,r,i,s,o,a)}function _c(t){return new ir(t)}function sk(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function I0(t){return t.collectionGroup!==null}function Ja(t){let e=N(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ae(et.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new uo(s,r))}),n.has(et.keyField().canonicalString())||e.le.push(new uo(et.keyField(),r))}return e.le}function Gt(t){let e=N(t);return e.he||(e.he=v6(e,Ja(t))),e.he}function v6(t,e){if(t.limitType==="F")return HI(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new uo(i.field,s)});let n=t.endAt?new kr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new kr(t.startAt.position,t.startAt.inclusive):null;return HI(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function GI(t,e){let n=t.filters.concat([e]);return new ir(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ag(t,e,n){return new ir(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function vd(t,e){return _d(Gt(t),Gt(e))&&t.limitType===e.limitType}function hO(t){return`${lo(Gt(t))}|lt:${t.limitType}`}function Wa(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>uO(i)).join(", ")}]`),yd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>rc(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>rc(i)).join(",")),`Target(${r})`}(Gt(t))}; limitType=${t.limitType})`}function wd(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):R.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Ja(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=tk(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,Ja(r),i)||r.endAt&&!function(o,a,c){let u=tk(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,Ja(r),i))}(t,e)}function fO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function pO(t){return(e,n)=>{let r=!1;for(let i of Ja(t)){let s=w6(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function w6(t,e,n){let r=t.field.isKeyField()?R.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?rs(c,u):L()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return L()}}var Or=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){vo(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return nO(this.inner)}size(){return this.innerSize}};var E6=new Oe(R.comparator);function rn(){return E6}var gO=new Oe(R.comparator);function Bl(...t){let e=gO;for(let n of t)e=e.insert(n.key,n);return e}function mO(t){let e=gO;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function xr(){return Hl()}function yO(){return Hl()}function Hl(){return new Or(t=>t.toString(),(t,e)=>t.isEqual(e))}var I6=new Oe(R.comparator),C6=new Ae(R.comparator);function re(...t){let e=C6;for(let n of t)e=e.add(n);return e}var b6=new Ae(ee);function C0(){return b6}function _O(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ql(e)?"-0":e}}function vO(t){return{integerValue:""+t}}function wO(t,e){return Xk(e)?vO(e):_O(t,e)}var sc=class{constructor(){this._=void 0}};function D6(t,e,n){return t instanceof is?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&fm(s)&&(s=w0(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof pi?IO(t,e):t instanceof gi?CO(t,e):function(i,s){let o=EO(i,s),a=ok(o)+ok(i.Ie);return kI(o)&&kI(i.Ie)?vO(a):_O(i.serializer,a)}(t,e)}function T6(t,e,n){return t instanceof pi?IO(t,e):t instanceof gi?CO(t,e):n}function EO(t,e){return t instanceof ss?function(r){return kI(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var is=class extends sc{},pi=class extends sc{constructor(e){super(),this.elements=e}};function IO(t,e){let n=bO(e);for(let r of t.elements)n.some(i=>Nr(i,r))||n.push(r);return{arrayValue:{values:n}}}var gi=class extends sc{constructor(e){super(),this.elements=e}};function CO(t,e){let n=bO(e);for(let r of t.elements)n=n.filter(i=>!Nr(i,r));return{arrayValue:{values:n}}}var ss=class extends sc{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function ok(t){return Qe(t.integerValue||t.doubleValue)}function bO(t){return Jl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var ho=class{constructor(e,n){this.field=e,this.transform=n}};function S6(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof pi&&i instanceof pi||r instanceof gi&&i instanceof gi?tc(r.elements,i.elements,Nr):r instanceof ss&&i instanceof ss?Nr(r.Ie,i.Ie):r instanceof is&&i instanceof is}(t.transform,e.transform)}var zI=class{constructor(e,n){this.version=e,this.transformResults=n}},Ye=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function pg(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var oc=class{};function DO(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new as(t.key,Ye.none()):new os(t.key,t.data,Ye.none());{let n=t.data,r=Lt.empty(),i=new Ae(et.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new sr(t.key,r,new _n(i.toArray()),Ye.none())}}function A6(t,e,n){t instanceof os?function(i,s,o){let a=i.value.clone(),c=ck(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof sr?function(i,s,o){if(!pg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=ck(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(TO(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Gl(t,e,n,r){return t instanceof os?function(s,o,a,c){if(!pg(s.precondition,o))return a;let u=s.value.clone(),l=uk(s.fieldTransforms,c,o);return u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof sr?function(s,o,a,c){if(!pg(s.precondition,o))return a;let u=uk(s.fieldTransforms,c,o),l=o.data;return l.setAll(TO(s)),l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return pg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function x6(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=EO(r.transform,i||null);s!=null&&(n===null&&(n=Lt.empty()),n.set(r.field,s))}return n||null}function ak(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&tc(r,i,(s,o)=>S6(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var os=class extends oc{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},sr=class extends oc{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function TO(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function ck(t,e,n){let r=new Map;$(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,T6(o,a,n[i]))}return r}function uk(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,D6(s,o,e))}return r}var as=class extends oc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ed=class extends oc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var td=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&A6(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Gl(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Gl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=yO();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=DO(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(H.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),re())}isEqual(e){return this.batchId===e.batchId&&tc(this.mutations,e.mutations,(n,r)=>ak(n,r))&&tc(this.baseMutations,e.baseMutations,(n,r)=>ak(n,r))}},WI=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){$(e.mutations.length===r.length);let i=function(){return I6}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var nd=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var KI=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var at,pe;function SO(t){switch(t){default:return L();case v.CANCELLED:case v.UNKNOWN:case v.DEADLINE_EXCEEDED:case v.RESOURCE_EXHAUSTED:case v.INTERNAL:case v.UNAVAILABLE:case v.UNAUTHENTICATED:return!1;case v.INVALID_ARGUMENT:case v.NOT_FOUND:case v.ALREADY_EXISTS:case v.PERMISSION_DENIED:case v.FAILED_PRECONDITION:case v.ABORTED:case v.OUT_OF_RANGE:case v.UNIMPLEMENTED:case v.DATA_LOSS:return!0}}function AO(t){if(t===void 0)return Je("GRPC error has no .code"),v.UNKNOWN;switch(t){case at.OK:return v.OK;case at.CANCELLED:return v.CANCELLED;case at.UNKNOWN:return v.UNKNOWN;case at.DEADLINE_EXCEEDED:return v.DEADLINE_EXCEEDED;case at.RESOURCE_EXHAUSTED:return v.RESOURCE_EXHAUSTED;case at.INTERNAL:return v.INTERNAL;case at.UNAVAILABLE:return v.UNAVAILABLE;case at.UNAUTHENTICATED:return v.UNAUTHENTICATED;case at.INVALID_ARGUMENT:return v.INVALID_ARGUMENT;case at.NOT_FOUND:return v.NOT_FOUND;case at.ALREADY_EXISTS:return v.ALREADY_EXISTS;case at.PERMISSION_DENIED:return v.PERMISSION_DENIED;case at.FAILED_PRECONDITION:return v.FAILED_PRECONDITION;case at.ABORTED:return v.ABORTED;case at.OUT_OF_RANGE:return v.OUT_OF_RANGE;case at.UNIMPLEMENTED:return v.UNIMPLEMENTED;case at.DATA_LOSS:return v.DATA_LOSS;default:return L()}}(pe=at||(at={}))[pe.OK=0]="OK",pe[pe.CANCELLED=1]="CANCELLED",pe[pe.UNKNOWN=2]="UNKNOWN",pe[pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pe[pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pe[pe.NOT_FOUND=5]="NOT_FOUND",pe[pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",pe[pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",pe[pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",pe[pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pe[pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pe[pe.ABORTED=10]="ABORTED",pe[pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",pe[pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",pe[pe.INTERNAL=13]="INTERNAL",pe[pe.UNAVAILABLE=14]="UNAVAILABLE",pe[pe.DATA_LOSS=15]="DATA_LOSS";var lk=null;function xO(){return new TextEncoder}var M6=new Zs([4294967295,4294967295],0);function dk(t){let e=xO().encode(t),n=new HN;return n.update(e),new Uint8Array(n.digest())}function hk(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Zs([n,r],0),new Zs([i,s],0)]}var QI=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new so(`Invalid padding: ${n}`);if(r<0)throw new so(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new so(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new so(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Zs.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Zs.fromNumber(r)));return i.compare(M6)===1&&(i=new Zs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=dk(e),[r,i]=hk(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=dk(e),[r,i]=hk(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},so=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var rd=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,id.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(H.min(),i,new Oe(ee),rn(),re())}},id=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,re(),re(),re())}};var ec=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},xg=class{constructor(e,n){this.targetId=e,this.fe=n}},Mg=class{constructor(e,n,r=Et.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},Rg=class{constructor(){this.ge=0,this.pe=pk(),this.ye=Et.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=re(),n=re(),r=re();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:L()}}),new id(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=pk()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,$(this.ge>=0)}Be(){this.Se=!0,this.we=!0}},YI=class{constructor(e){this.Le=e,this.ke=new Map,this.qe=rn(),this.Qe=fk(),this.Ke=new Oe(ee)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:L()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(Tg(s))if(r===0){let o=new R(s.path);this.We(n,o,dt.newNoDocument(o,H.min()))}else $(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),c=a?this.et(a,e,o):1;if(c!==0){this.He(n);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}lk?.tt(function(l,d,h,f,p){var g,m,E,S,b,k;let q={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},G=d.unchangedNames;return G&&(q.bloomFilter={applied:p===0,hashCount:(g=G?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(S=(E=(m=G?.bits)===null||m===void 0?void 0:m.bitmap)===null||E===void 0?void 0:E.length)!==null&&S!==void 0?S:0,padding:(k=(b=G?.bits)===null||b===void 0?void 0:b.padding)!==null&&k!==void 0?k:0,mightContain:Ee=>{var gt;return(gt=f?.mightContain(Ee))!==null&&gt!==void 0&&gt}}),q}(o,e.fe,this.Le.nt(),a,c))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=ts(r).toUint8Array()}catch(c){if(c instanceof Cg)return Ln("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new QI(o,i,s)}catch(c){return Ln(c instanceof so?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&Tg(a.target)){let c=new R(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,dt.newNoDocument(c,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=re();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.Ye(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new rd(e,n,this.Ke,this.qe,r);return this.qe=rn(),this.Qe=fk(),this.Ke=new Oe(ee),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new Rg,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Ae(ee),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||C("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Rg),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function fk(){return new Oe(R.comparator)}function pk(){return new Oe(R.comparator)}var R6={asc:"ASCENDING",desc:"DESCENDING"},P6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},N6={and:"AND",or:"OR"},XI=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function ZI(t,e){return t.useProto3Json||yd(e)?e:{value:e}}function ac(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function MO(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function k6(t,e){return ac(t,e.toTimestamp())}function tt(t){return $(!!t),H.fromTimestamp(function(n){let r=es(n);return new He(r.seconds,r.nanos)}(t))}function b0(t,e){return JI(t,e).canonicalString()}function JI(t,e){let n=function(i){return new ge(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function RO(t){let e=ge.fromString(t);return $(BO(e)),e}function sd(t,e){return b0(t.databaseId,e.path)}function Rr(t,e){let n=RO(e);if(n.get(1)!==t.databaseId.projectId)throw new I(v.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new I(v.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new R(kO(n))}function PO(t,e){return b0(t.databaseId,e)}function NO(t){let e=RO(t);return e.length===4?ge.emptyPath():kO(e)}function eC(t){return new ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function kO(t){return $(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function gk(t,e,n){return{name:sd(t,e),fields:n.value.mapValue.fields}}function OO(t,e,n){let r=Rr(t,e.name),i=tt(e.updateTime),s=e.createTime?tt(e.createTime):H.min(),o=new Lt({mapValue:{fields:e.fields}}),a=dt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function O6(t,e){return"found"in e?function(r,i){$(!!i.found),i.found.name,i.found.updateTime;let s=Rr(r,i.found.name),o=tt(i.found.updateTime),a=i.found.createTime?tt(i.found.createTime):H.min(),c=new Lt({mapValue:{fields:i.found.fields}});return dt.newFoundDocument(s,o,a,c)}(t,e):"missing"in e?function(r,i){$(!!i.missing),$(!!i.readTime);let s=Rr(r,i.missing),o=tt(i.readTime);return dt.newNoDocument(s,o)}(t,e):L()}function F6(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:L()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,l){return u.useProto3Json?($(l===void 0||typeof l=="string"),Et.fromBase64String(l||"")):($(l===void 0||l instanceof Uint8Array),Et.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){let l=u.code===void 0?v.UNKNOWN:AO(u.code);return new I(l,u.message||"")}(o);n=new Mg(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Rr(t,r.document.name),s=tt(r.document.updateTime),o=r.document.createTime?tt(r.document.createTime):H.min(),a=new Lt({mapValue:{fields:r.document.fields}}),c=dt.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new ec(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Rr(t,r.document),s=r.readTime?tt(r.readTime):H.min(),o=dt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new ec([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Rr(t,r.document),s=r.removedTargetIds||[];n=new ec([],s,i,null)}else{if(!("filter"in e))return L();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new KI(i,s),a=r.targetId;n=new xg(a,o)}}return n}function od(t,e){let n;if(e instanceof os)n={update:gk(t,e.key,e.value)};else if(e instanceof as)n={delete:sd(t,e.key)};else if(e instanceof sr)n={update:gk(t,e.key,e.data),updateMask:$6(e.fieldMask)};else{if(!(e instanceof ed))return L();n={verify:sd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof is)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof pi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof gi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ss)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw L()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:k6(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:L()}(t,e.precondition)),n}function tC(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?Ye.updateTime(tt(s.updateTime)):s.exists!==void 0?Ye.exists(s.exists):Ye.none()}(e.currentDocument):Ye.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)$(a.setToServerValue==="REQUEST_TIME"),c=new is;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];c=new pi(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];c=new gi(l)}else"increment"in a?c=new ss(o,a.increment):L();let u=et.fromServerFormat(a.fieldPath);return new ho(u,c)}(t,i)):[];if(e.update){e.update.name;let i=Rr(t,e.update.name),s=new Lt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let u=c.fieldPaths||[];return new _n(u.map(l=>et.fromServerFormat(l)))}(e.updateMask);return new sr(i,s,o,n,r)}return new os(i,s,n,r)}if(e.delete){let i=Rr(t,e.delete);return new as(i,n)}if(e.verify){let i=Rr(t,e.verify);return new ed(i,n)}return L()}function L6(t,e){return t&&t.length>0?($(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?tt(i.updateTime):tt(s);return o.isEqual(H.min())&&(o=tt(s)),new zI(o,i.transformResults||[])}(n,e))):[]}function FO(t,e){return{documents:[PO(t,e.path)]}}function LO(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=PO(t,i);let s=function(u){if(u.length!==0)return UO(be.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(l=>function(h){return{field:Ka(h.field),direction:j6(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=ZI(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ut:n,parent:i}}function VO(t){let e=NO(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){$(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=jO(d);return h instanceof be&&E0(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new uo(Qa(p.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,yd(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(d){let h=!!d.before,f=d.values||[];return new kr(f,h)}(n.startAt));let u=null;return n.endAt&&(u=function(d){let h=!d.before,f=d.values||[];return new kr(f,h)}(n.endAt)),dO(e,i,o,s,a,"F",c,u)}function V6(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return L()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function jO(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Qa(n.unaryFilter.field);return fe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Qa(n.unaryFilter.field);return fe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Qa(n.unaryFilter.field);return fe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Qa(n.unaryFilter.field);return fe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return L()}}(t):t.fieldFilter!==void 0?function(n){return fe.create(Qa(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return L()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return be.create(n.compositeFilter.filters.map(r=>jO(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return L()}}(n.compositeFilter.op))}(t):L()}function j6(t){return R6[t]}function U6(t){return P6[t]}function B6(t){return N6[t]}function Ka(t){return{fieldPath:t.canonicalString()}}function Qa(t){return et.fromServerFormat(t.fieldPath)}function UO(t){return t instanceof fe?function(n){if(n.op==="=="){if(ZN(n.value))return{unaryFilter:{field:Ka(n.field),op:"IS_NAN"}};if(XN(n.value))return{unaryFilter:{field:Ka(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ZN(n.value))return{unaryFilter:{field:Ka(n.field),op:"IS_NOT_NAN"}};if(XN(n.value))return{unaryFilter:{field:Ka(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ka(n.field),op:U6(n.op),value:n.value}}}(t):t instanceof be?function(n){let r=n.getFilters().map(i=>UO(i));return r.length===1?r[0]:{compositeFilter:{op:B6(n.op),filters:r}}}(t):L()}function $6(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function BO(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var cc=class t{constructor(e,n,r,i,s=H.min(),o=H.min(),a=Et.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Pg=class{constructor(e){this.ct=e}};function q6(t,e){let n;if(e.document)n=OO(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=R.fromSegments(e.noDocument.path),i=po(e.noDocument.readTime);n=dt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return L();{let r=R.fromSegments(e.unknownDocument.path),i=po(e.unknownDocument.version);n=dt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new He(i[0],i[1]);return H.fromTimestamp(s)}(e.readTime)),n}function mk(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ng(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:sd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:ac(s,o.version.toTimestamp()),createTime:ac(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:fo(e.version)};else{if(!e.isUnknownDocument())return L();r.unknownDocument={path:n.path.toArray(),version:fo(e.version)}}return r}function Ng(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function fo(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function po(t){let e=new He(t.seconds,t.nanoseconds);return H.fromTimestamp(e)}function no(t,e){let n=(e.baseMutations||[]).map(s=>tC(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>tC(t.ct,s)),i=He.fromMillis(e.localWriteTimeMs);return new td(e.batchId,i,n,r)}function $l(t){let e=po(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?po(t.lastLimboFreeSnapshotVersion):H.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return $(s.documents.length===1),Gt(_c(NO(s.documents[0])))}(t.query):function(s){return Gt(VO(s))}(t.query),new cc(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Et.fromBase64String(t.resumeToken))}function $O(t,e){let n=fo(e.snapshotVersion),r=fo(e.lastLimboFreeSnapshotVersion),i;i=Tg(e.target)?FO(t.ct,e.target):LO(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:lo(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function D0(t){let e=VO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ag(e,e.limit,"L"):e}function mI(t,e){return new nd(e.largestBatchId,tC(t.ct,e.overlayMutation))}function yk(t,e){let n=e.path.lastSegment();return[t,Ht(e.path.popLast()),n]}function _k(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:fo(r.readTime),documentKey:Ht(r.documentKey.path),largestBatchId:r.largestBatchId}}var nC=class{getBundleMetadata(e,n){return vk(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:po(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return vk(e).put(function(i){return{bundleId:i.id,createTime:fo(tt(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return wk(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:D0(s.bundledQuery),readTime:po(s.readTime)}}(r)})}saveNamedQuery(e,n){return wk(e).put(function(i){return{name:i.name,readTime:fo(tt(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function vk(t){return It(t,"bundles")}function wk(t){return It(t,"namedQueries")}var kg=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return Ll(e).get(yk(this.userId,n)).next(r=>r?mI(this.serializer,r):null)}getOverlays(e,n){let r=xr();return _.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new nd(n,o);i.push(this.ht(e,a))}),_.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(Ht(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Ll(e).H("collectionPathOverlayIndex",a))}),_.waitFor(s)}getOverlaysForCollection(e,n,r){let i=xr(),s=Ht(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Ll(e).W("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let u=mI(this.serializer,c);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=xr(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Ll(e).Y({index:"collectionGroupOverlayIndex",range:a},(c,u,l)=>{let d=mI(this.serializer,u);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}ht(e,n){return Ll(e).put(function(i,s,o){let[a,c,u]=yk(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:od(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function Ll(t){return It(t,"documentOverlays")}var di=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(Qe(e.integerValue));else if("doubleValue"in e){let r=Qe(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),Ql(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(ts(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?iO(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):L()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),R.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};di.bt=new di;function H6(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function Ek(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=H6(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var rC=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Bt(e){let n=this.Lt(e),r=Ek(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Lt(e),r=Ek(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},iC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}},sC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},ro=class{constructor(){this.Gt=new rC,this.zt=new iC(this.Gt),this.jt=new sC(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var io=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function Wi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=Ik(t.arrayValue,e.arrayValue),n!==0?n:(n=Ik(t.directionalValue,e.directionalValue),n!==0?n:R.comparator(t.documentKey,e.documentKey)))}function Ik(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var Og=class{constructor(e){this.Yt=new Ae((n,r)=>et.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if($(e.collectionGroup===this.collectionId),this.en)return!1;let n=SI(e);if(n!==void 0&&!this.nn(n))return!1;let r=eo(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Ae(et.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Za(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Za(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Za(r.field,r.dir==="asc"?0:1)));return new nc(nc.UNKNOWN_ID,this.collectionId,n,Kl.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function qO(t){var e,n;if($(t instanceof fe||t instanceof be),t instanceof fe){if(t instanceof Dg){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>fe.create(t.field,"==",s)))||[];return be.create(i,"or")}return t}let r=t.filters.map(i=>qO(i));return be.create(r,t.op)}function G6(t){if(t.getFilters().length===0)return[];let e=cC(qO(t));return $(HO(e)),oC(e)||aC(e)?[e]:e.getFilters()}function oC(t){return t instanceof fe}function aC(t){return t instanceof be&&E0(t)}function HO(t){return oC(t)||aC(t)||function(n){if(n instanceof be&&OI(n)){for(let r of n.getFilters())if(!oC(r)&&!aC(r))return!1;return!0}return!1}(t)}function cC(t){if($(t instanceof fe||t instanceof be),t instanceof fe)return t;if(t.filters.length===1)return cC(t.filters[0]);let e=t.filters.map(r=>cC(r)),n=be.create(e,t.op);return n=Fg(n),HO(n)?n:($(n instanceof be),$(ic(n)),$(n.filters.length>1),n.filters.reduce((r,i)=>T0(r,i)))}function T0(t,e){let n;return $(t instanceof fe||t instanceof be),$(e instanceof fe||e instanceof be),n=t instanceof fe?e instanceof fe?function(i,s){return be.create([i,s],"and")}(t,e):Ck(t,e):e instanceof fe?Ck(e,t):function(i,s){if($(i.filters.length>0&&s.filters.length>0),ic(i)&&ic(s))return cO(i,s.getFilters());let o=OI(i)?i:s,a=OI(i)?s:i,c=o.filters.map(u=>T0(u,a));return be.create(c,"or")}(t,e),Fg(n)}function Ck(t,e){if(ic(e))return cO(e,t.getFilters());{let n=e.filters.map(r=>T0(t,r));return be.create(n,"or")}}function Fg(t){if($(t instanceof fe||t instanceof be),t instanceof fe)return t;let e=t.getFilters();if(e.length===1)return Fg(e[0]);if(oO(t))return t;let n=e.map(i=>Fg(i)),r=[];return n.forEach(i=>{i instanceof fe?r.push(i):i instanceof be&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:be.create(r,t.op)}var uC=class{constructor(){this._n=new ad}addToCollectionParentIndex(e,n){return this._n.add(n),_.resolve()}getCollectionParents(e,n){return _.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return _.resolve()}deleteFieldIndex(e,n){return _.resolve()}deleteAllFieldIndexes(e){return _.resolve()}createTargetIndexes(e,n){return _.resolve()}getDocumentsMatchingTarget(e,n){return _.resolve(null)}getIndexType(e,n){return _.resolve(0)}getFieldIndexes(e,n){return _.resolve([])}getNextCollectionGroupToUpdate(e){return _.resolve(null)}getMinOffset(e,n){return _.resolve(Vn.min())}getMinOffsetFromCollectionGroup(e,n){return _.resolve(Vn.min())}updateCollectionGroup(e,n,r){return _.resolve()}updateIndexEntries(e,n){return _.resolve()}},ad=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ae(ge.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ae(ge.comparator)).toArray()}};var ag=new Uint8Array(0),lC=class{constructor(e,n){this.databaseId=n,this.an=new ad,this.un=new Or(r=>lo(r),(r,i)=>_d(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:Ht(i)};return bk(e).put(s)}return _.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[Wk(n),""],!1,!0);return bk(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(Ar(o.parent))}return r})}addFieldIndex(e,n){let r=Vl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=Ha(e);return s.next(a=>{o.put(_k(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=Vl(e),i=Ha(e),s=qa(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=Vl(e),r=qa(e),i=Ha(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return _.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Og(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=qa(e),i=!0,s=new Map;return _.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=re(),a=[];return _.forEach(s,(c,u)=>{C("IndexedDbIndexManager",`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(k=>`${k.fieldPath}:${k.kind}`).join(",")}`}(c)} to execute ${lo(n)}`);let l=function(b,k){let q=SI(k);if(q===void 0)return null;for(let G of Sg(b,q.fieldPath))switch(G.op){case"array-contains-any":return G.value.arrayValue.values||[];case"array-contains":return[G.value]}return null}(u,c),d=function(b,k){let q=new Map;for(let G of eo(k))for(let Ee of Sg(b,G.fieldPath))switch(Ee.op){case"==":case"in":q.set(G.fieldPath.canonicalString(),Ee.value);break;case"not-in":case"!=":return q.set(G.fieldPath.canonicalString(),Ee.value),Array.from(q.values())}return null}(u,c),h=function(b,k){let q=[],G=!0;for(let Ee of eo(k)){let gt=Ee.kind===0?rk(b,Ee.fieldPath,b.startAt):ik(b,Ee.fieldPath,b.startAt);q.push(gt.value),G&&(G=gt.inclusive)}return new kr(q,G)}(u,c),f=function(b,k){let q=[],G=!0;for(let Ee of eo(k)){let gt=Ee.kind===0?ik(b,Ee.fieldPath,b.endAt):rk(b,Ee.fieldPath,b.endAt);q.push(gt.value),G&&(G=gt.inclusive)}return new kr(q,G)}(u,c),p=this.hn(c,u,h),g=this.hn(c,u,f),m=this.Pn(c,u,d),E=this.In(c.indexId,l,p,h.inclusive,g,f.inclusive,m);return _.forEach(E,S=>r.j(S,n.limit).next(b=>{b.forEach(k=>{let q=R.fromSegments(k.documentKey);o.has(q)||(o=o.add(q),a.push(q))})}))}).next(()=>a)}return _.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=G6(be.create(e.filters,"and")).map(r=>HI(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let c=(n!=null?n.length:1)*Math.max(r.length,s.length),u=c/(n!=null?n.length:1),l=[];for(let d=0;d<c;++d){let h=n?this.Tn(n[d/u]):ag,f=this.En(e,h,r[d%u],i),p=this.dn(e,h,s[d%u],o),g=a.map(m=>this.En(e,h,m,!0));l.push(...this.createRange(f,p,g))}return l}En(e,n,r,i){let s=new io(e,R.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new io(e,R.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new Og(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return _.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Ae(et.comparator),l=!1;for(let d of c.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:u=u.add(h.field));for(let d of c.orderBy)d.field.isKeyField()||(u=u.add(d.field));return u.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new ro;for(let i of eo(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);di.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new ro;return di.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new ro;return di.bt.Pt(co(this.databaseId,n),r.Ht(function(s){let o=eo(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new ro);let s=0;for(let o of eo(e)){let a=r[s++];for(let c of i)if(this.Vn(n,o.fieldPath)&&Jl(a))i=this.mn(i,o,a);else{let u=c.Ht(o.kind);di.bt.Pt(a,u)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new ro;c.seed(a.Wt()),di.bt.Pt(o,c.Ht(n.kind)),s.push(c)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof fe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=Vl(e),i=Ha(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return _.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(l,d){let h=d?new Kl(d.sequenceNumber,new Vn(po(d.readTime),new R(Ar(d.documentKey)),d.largestBatchId)):Kl.empty(),f=l.fields.map(([p,g])=>new Za(et.fromServerFormat(p),g));return new nc(l.indexId,l.collectionGroup,f,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ee(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=Vl(e),s=Ha(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>_.forEach(a,c=>s.put(_k(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return _.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?_.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),_.forEach(a,c=>this.pn(e,i,c).next(u=>{let l=this.yn(s,c);return u.isEqual(l)?_.resolve():this.wn(e,s,c,u,l)}))))})}Sn(e,n,r,i){return qa(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return qa(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=qa(e),s=new Ae(Wi);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new io(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new Ae(Wi),i=this.An(n,e);if(i==null)return r;let s=SI(n);if(s!=null){let o=e.data.field(s.fieldPath);if(Jl(o))for(let a of o.arrayValue.values||[])r=r.add(new io(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new io(n.indexId,e.key,ag,i));return r}wn(e,n,r,i,s){C("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(c,u,l,d,h){let f=c.getIterator(),p=u.getIterator(),g=$a(f),m=$a(p);for(;g||m;){let E=!1,S=!1;if(g&&m){let b=l(g,m);b<0?S=!0:b>0&&(E=!0)}else g!=null?S=!0:E=!0;E?(d(m),m=$a(p)):S?(h(g),g=$a(f)):(g=$a(f),m=$a(p))}}(i,s,Wi,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),_.waitFor(o)}gn(e){let n=1;return Ha(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Wi(o,a)).filter((o,a,c)=>!a||Wi(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Wi(o,e),c=Wi(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,ag,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,ag,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,n){return Wi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Dk)}getMinOffset(e,n){return _.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||L())).next(Dk)}};function bk(t){return It(t,"collectionParents")}function qa(t){return It(t,"indexEntries")}function Vl(t){return It(t,"indexConfiguration")}function Ha(t){return It(t,"indexState")}function Dk(t){$(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;_0(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Vn(e.readTime,e.documentKey,n)}var Tk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Fn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function GO(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,c=r.Y({range:o},(l,d,h)=>(a++,h.delete()));s.push(c.next(()=>{$(a===1)}));let u=[];for(let l of n.mutations){let d=Zk(e,l.key.path,n.batchId);s.push(i.delete(d)),u.push(l.key)}return _.waitFor(s).next(()=>u)}function Lg(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw L();e=t.noDocument}return JSON.stringify(e).length}Fn.DEFAULT_COLLECTION_PERCENTILE=10,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Fn.DEFAULT=new Fn(41943040,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Fn.DISABLED=new Fn(-1,0,0);var Vg=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){$(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ki(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=Ya(e),o=Ki(e);return o.add({}).next(a=>{$(typeof a=="number");let c=new td(a,n,r,i),u=function(f,p,g){let m=g.baseMutations.map(S=>od(f.ct,S)),E=g.mutations.map(S=>od(f.ct,S));return{userId:p,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:m,mutations:E}}(this.serializer,this.userId,c),l=[],d=new Ae((h,f)=>ee(h.canonicalString(),f.canonicalString()));for(let h of i){let f=Zk(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(u)),l.push(s.put(f,ZW))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),_.waitFor(l).next(()=>c)})}lookupMutationBatch(e,n){return Ki(e).get(n).next(r=>r?($(r.userId===this.userId),no(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?_.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Ki(e).Y({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&($(a.batchId>=r),s=no(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Ki(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ki(e).W("userMutationsIndex",n).next(r=>r.map(i=>no(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=dg(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ya(e).Y({range:i},(o,a,c)=>{let[u,l,d]=o,h=Ar(l);if(u===this.userId&&n.path.isEqual(h))return Ki(e).get(d).next(f=>{if(!f)throw L();$(f.userId===this.userId),s.push(no(this.serializer,f))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ae(ee),i=[];return n.forEach(s=>{let o=dg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Ya(e).Y({range:a},(u,l,d)=>{let[h,f,p]=u,g=Ar(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(c)}),_.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=dg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Ae(ee);return Ya(e).Y({range:o},(c,u,l)=>{let[d,h,f]=c,p=Ar(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(Ki(e).get(s).next(o=>{if(o===null)throw L();$(o.userId===this.userId),r.push(no(this.serializer,o))}))}),_.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return GO(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),_.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return _.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ya(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=Ar(s[1]);i.push(c)}else a.done()}).next(()=>{$(i.length===0)})})}containsKey(e,n){return zO(e,this.userId,n)}xn(e){return WO(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function zO(t,e,n){let r=dg(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Ya(t).Y({range:s,J:!0},(a,c,u)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),u.done()}).next(()=>o)}function Ki(t){return It(t,"mutations")}function Ya(t){return It(t,"documentMutations")}function WO(t){return It(t,"mutationQueues")}var uc=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Bn(){return new t(-1)}};var dC=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{let r=new uc(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>H.fromTimestamp(new He(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ga(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>($(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return Ga(e).Y((o,a)=>{let c=$l(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>_.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Ga(e).Y((r,i)=>{let s=$l(i);n(s)})}Ln(e){return Sk(e).get("targetGlobalKey").next(n=>($(n!==null),n))}kn(e,n){return Sk(e).put("targetGlobalKey",n)}qn(e,n){return Ga(e).put($O(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){let r=lo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Ga(e).Y({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let u=$l(a);_d(n,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Qi(e);return n.forEach(o=>{let a=Ht(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),_.waitFor(i)}removeMatchingKeys(e,n,r){let i=Qi(e);return _.forEach(n,s=>{let o=Ht(s.path);return _.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Qi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Qi(e),s=re();return i.Y({range:r,J:!0},(o,a,c)=>{let u=Ar(o[1]),l=new R(u);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=Ht(n.path),i=IDBKeyRange.bound([r],[Wk(r)],!1,!0),s=0;return Qi(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}_t(e,n){return Ga(e).get(n).next(r=>r?$l(r):null)}};function Ga(t){return It(t,"targets")}function Sk(t){return It(t,"targetGlobal")}function Qi(t){return It(t,"targetDocuments")}function Ak([t,e],[n,r]){let i=ee(t,n);return i===0?ee(e,r):i}var hC=class{constructor(e){this.Kn=e,this.buffer=new Ae(Ak),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();Ak(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},fC=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){C("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>y(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){ls(n)?C("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield us(n)}yield this.zn(3e5)}))}},pC=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return _.resolve(yn._e);let r=new hC(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(C("LruGarbageCollector","Garbage collection skipped; disabled"),_.resolve(Tk)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(C("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Tk):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,c,u,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(C("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(u=Date.now(),za()<=Dn.DEBUG&&C("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-l}ms`),_.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function z6(t,e){return new pC(t,e)}var gC=class{constructor(e,n){this.db=e,this.garbageCollector=z6(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return cg(e,r)}removeReference(e,n,r){return cg(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return cg(e,n)}er(e,n){return function(i,s){let o=!1;return WO(i).Z(a=>zO(i,a,s).next(c=>(c&&(o=!0),_.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let c=this.er(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,H.min()),Qi(e).delete(function(d){return[0,Ht(d.path)]}(o))))});i.push(c)}}).next(()=>_.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return cg(e,n)}Xn(e,n){let r=Qi(e),i,s=yn._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==yn._e&&n(new R(Ar(i)),s),s=u,i=c):s=yn._e}).next(()=>{s!==yn._e&&n(new R(Ar(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function cg(t,e){return Qi(t).put(function(r,i){return{targetId:0,path:Ht(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var jg=class{constructor(){this.changes=new Or(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,dt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?_.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var mC=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Js(e).put(r)}removeEntry(e,n,r){return Js(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Ng(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=dt.newInvalidDocument(n);return Js(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(jl(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:dt.newInvalidDocument(n)};return Js(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(jl(n))},(i,s)=>{r={document:this.nr(n,s),size:Lg(s)}}).next(()=>r)}getEntries(e,n){let r=rn();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=rn(),i=new Oe(R.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,Lg(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return _.resolve();let i=new Ae(Rk);n.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(jl(i.first()),jl(i.last())),o=i.getIterator(),a=o.getNext();return Js(e).Y({index:"documentKeyIndex",range:s},(c,u,l)=>{let d=R.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&Rk(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?l.U(jl(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Ng(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Js(e).W(IDBKeyRange.bound(a,c,!0)).next(u=>{s?.incrementDocumentReadCount(u.length);let l=rn();for(let d of u){let h=this.nr(R.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(wd(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=rn(),o=Mk(n,r),a=Mk(n,Vn.max());return Js(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,l)=>{let d=this.nr(R.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new yC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return xk(e).get("remoteDocumentGlobalKey").next(n=>($(!!n),n))}tr(e,n){return xk(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=q6(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(H.min())))return r}return dt.newInvalidDocument(e)}};function KO(t){return new mC(t)}var yC=class extends jg{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new Or(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new Ae((s,o)=>ee(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=mk(this.ar.serializer,o);i=i.add(s.path.popLast());let u=Lg(c);r+=u-a.size,n.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=mk(this.ar.serializer,o.convertToNoDocument(H.min()));n.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),_.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function xk(t){return It(t,"remoteDocumentGlobal")}function Js(t){return It(t,"remoteDocumentsV14")}function jl(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Mk(t,e){let n=e.documentKey.path.toArray();return[t,Ng(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Rk(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ee(n[s],r[s]),i)return i;return i=ee(n.length,r.length),i||(i=ee(n[n.length-2],r[r.length-2]),i||ee(n[n.length-1],r[r.length-1]))}var _C=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Ug=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Gl(r.mutation,i,_n.empty(),He.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,n,r=re()){let i=xr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Bl();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=xr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,re()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=rn(),o=Hl(),a=function(){return Hl()}();return n.forEach((c,u)=>{let l=r.get(u.key);i.has(u.key)&&(l===void 0||l.mutation instanceof sr)?s=s.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),Gl(l.mutation,u,l.mutation.getFieldMask(),He.now())):o.set(u.key,_n.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,l)=>o.set(u,l)),n.forEach((u,l)=>{var d;return a.set(u,new _C(l,(d=o.get(u))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=Hl(),i=new Oe((o,a)=>o-a),s=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=n.get(c);if(u===null)return;let l=r.get(c)||_n.empty();l=a.applyToLocalView(u,l),r.set(c,l);let d=(i.get(a.batchId)||re()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,l=c.value,d=yO();l.forEach(h=>{if(!s.has(h)){let f=DO(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return _.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return R.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):I0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):_.resolve(xr()),a=-1,c=s;return o.next(u=>_.forEach(u,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?_.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{c=c.insert(l,h)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,re())).next(l=>({batchId:a,changes:mO(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new R(n)).next(r=>{let i=Bl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=Bl();return this.indexManager.getCollectionParents(e,s).next(a=>_.forEach(a,c=>{let u=function(d,h){return new ir(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{let l=u.getKey();o.get(l)===null&&(o=o.insert(l,dt.newInvalidDocument(l)))});let a=Bl();return o.forEach((c,u)=>{let l=s.get(c);l!==void 0&&Gl(l.mutation,u,_n.empty(),He.now()),wd(n,u)&&(a=a.insert(c,u))}),a})}};var vC=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return _.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:tt(i.createTime)}}(n)),_.resolve()}getNamedQuery(e,n){return _.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:D0(i.bundledQuery),readTime:tt(i.readTime)}}(n)),_.resolve()}};var wC=class{constructor(){this.overlays=new Oe(R.comparator),this.hr=new Map}getOverlay(e,n){return _.resolve(this.overlays.get(n))}getOverlays(e,n){let r=xr();return _.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),_.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),_.resolve()}getOverlaysForCollection(e,n,r){let i=xr(),s=n.length+1,o=new R(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return _.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Oe((u,l)=>u-l),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let l=s.get(u.largestBatchId);l===null&&(l=xr(),s=s.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}let a=xr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=i)););return _.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new nd(n,r));let s=this.hr.get(n);s===void 0&&(s=re(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var cd=class{constructor(){this.Pr=new Ae(ct.Ir),this.Tr=new Ae(ct.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new ct(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new ct(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new R(new ge([])),r=new ct(n,e),i=new ct(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new R(new ge([])),r=new ct(n,e),i=new ct(n,e+1),s=re();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new ct(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},ct=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return R.comparator(e.key,n.key)||ee(e.pr,n.pr)}static Er(e,n){return ee(e.pr,n.pr)||R.comparator(e.key,n.key)}};var EC=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Ae(ct.Ir)}checkEmpty(e){return _.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new td(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new ct(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return _.resolve(o)}lookupMutationBatch(e,n){return _.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return _.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return _.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return _.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new ct(n,0),i=new ct(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),_.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ae(ee);return n.forEach(i=>{let s=new ct(i,0),o=new ct(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),_.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;R.isDocumentKey(s)||(s=s.child(""));let o=new ct(new R(s),0),a=new Ae(ee);return this.wr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.pr)),!0)},o),_.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){$(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return _.forEach(n.mutations,i=>{let s=new ct(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new ct(n,0),i=this.wr.firstAfterOrEqual(r);return _.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,_.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var IC=class{constructor(e){this.vr=e,this.docs=function(){return new Oe(R.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return _.resolve(r?r.document.mutableCopy():dt.newInvalidDocument(n))}getEntries(e,n){let r=rn();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():dt.newInvalidDocument(i))}),_.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=rn(),o=n.path,a=new R(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||_0(Qk(l),r)<=0||(i.has(l.key)||wd(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return _.resolve(s)}getAllFromCollectionGroup(e,n,r,i){L()}Fr(e,n){return _.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new CC(this)}getSize(e){return _.resolve(this.size)}},CC=class extends jg{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),_.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var bC=class{constructor(e){this.persistence=e,this.Mr=new Or(n=>lo(n),_d),this.lastRemoteSnapshotVersion=H.min(),this.highestTargetId=0,this.Or=0,this.Nr=new cd,this.targetCount=0,this.Br=uc.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),_.resolve()}getLastRemoteSnapshotVersion(e){return _.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),_.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),_.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Br=new uc(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,_.resolve()}updateTargetData(e,n){return this.qn(n),_.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,_.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),_.waitFor(s).next(()=>i)}getTargetCount(e){return _.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return _.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),_.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),_.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),_.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return _.resolve(r)}containsKey(e,n){return _.resolve(this.Nr.containsKey(n))}};var Bg=class{constructor(e,n){this.Lr={},this.overlays={},this.kr=new yn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new bC(this),this.indexManager=new uC,this.remoteDocumentCache=function(i){return new IC(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Pg(n),this.$r=new vC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new wC,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new EC(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){C("MemoryPersistence","Starting transaction:",e);let i=new DC(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return _.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}},DC=class extends wg{constructor(e){super(),this.currentSequenceNumber=e}},$g=class t{constructor(e){this.persistence=e,this.zr=new cd,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw L()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),_.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),_.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),_.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _.forEach(this.Jr,r=>{let i=R.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,H.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return _.or([()=>_.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var TC=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new Eg("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",KN,{unique:!0}),c.createObjectStore("documentMutations")}(e),Pk(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=_.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),Pk(e)),o=o.next(()=>function(c){let u=c.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:H.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").W().next(l=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",KN,{unique:!0});let d=u.store("mutations"),h=l.map(f=>d.put(f));return _.waitFor(h)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let u=c.createObjectStore("documentOverlays",{keyPath:l6});u.createIndex("collectionPathOverlayIndex",d6,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",h6,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let u=c.createObjectStore("remoteDocumentsV14",{keyPath:JW});u.createIndex("documentKeyIndex",e6),u.createIndex("collectionGroupIndex",t6)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:o6}).createIndex("sequenceNumberIndex",a6,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:c6}).createIndex("documentKeyIndex",u6,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=Lg(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>_.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>_.forEach(a,c=>{$(c.userId===s.userId);let u=no(this.serializer,c);return GO(e,s.userId,u).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let c=new ge(o),u=function(d){return[0,Ht(d)]}(c);s.push(n.get(u).next(l=>l?_.resolve():(d=>n.put({targetId:0,path:Ht(d),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>_.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:s6});let r=n.store("collectionParents"),i=new ad,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Ht(c)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let c=new ge(o);return s(c.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,c],u)=>{let l=Ar(a);return s(l.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=$l(i),o=$O(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),c=function(d){return d.document?new R(ge.fromString(d.document.name).popFirst(5)):d.noDocument?R.fromSegments(d.noDocument.path):d.unknownDocument?R.fromSegments(d.unknownDocument.path):L()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>_.waitFor(i))}si(e,n){let r=n.store("mutations"),i=KO(this.serializer),s=new Bg($g.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(c=>{var u;let l=(u=a.get(c.userId))!==null&&u!==void 0?u:re();no(this.serializer,c).keys().forEach(d=>l=l.add(d)),a.set(c.userId,l)}),_.forEach(a,(c,u)=>{let l=new ut(u),d=kg.lt(this.serializer,l),h=s.getIndexManager(l),f=Vg.lt(l,this.serializer,h,s.referenceDelegate);return new Ug(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new Yl(n,yn._e),c).next()})})}};function Pk(t){t.createObjectStore("targetDocuments",{keyPath:r6}).createIndex("documentTargetsIndex",i6,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",n6,{unique:!0}),t.createObjectStore("targetGlobal")}var yI="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",SC=class t{constructor(e,n,r,i,s,o,a,c,u,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=u,this.ai=l,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new I(v.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new gC(this,i),this.Ti=n+"main",this.serializer=new Pg(c),this.Ei=new fi(this.Ti,this.ui,new TC(this.serializer)),this.Qr=new dC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=KO(this.serializer),this.$r=new nC,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,l===!1&&Je("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new I(v.FAILED_PRECONDITION,yI);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new yn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>y(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(n=>y(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>y(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ug(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(ls(e))return C("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return C("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return Ul(e).get("owner").next(n=>_.resolve(this.Si(n)))}bi(e){return ug(e).delete(this.clientId)}Di(){return y(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=It(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return _.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?_.resolve(!0):Ul(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new I(v.FAILED_PRECONDITION,yI);return!1}}return!(!this.networkEnabled||!this.inForeground)||ug(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&C("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return y(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Yl(e,yn._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Bi()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>ug(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return Vg.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new lC(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return kg.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){C("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(c){return c===15?p6:c===14?tO:c===13?eO:c===12?f6:c===11?Jk:void L()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Yl(a,this.kr?this.kr.next():yn._e),n==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw Je(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new I(v.FAILED_PRECONDITION,Yk);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return Ul(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new I(v.FAILED_PRECONDITION,yI)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ul(e).put("owner",n)}static D(){return fi.D()}yi(e){let n=Ul(e);return n.get("owner").next(r=>this.Si(r)?(C("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):_.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(Je(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;qy()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return C("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Je("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Je("Failed to set zombie client id.",e)}}Bi(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Ul(t){return It(t,"owner")}function ug(t){return It(t,"clientMetadata")}function S0(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var AC=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=re(),i=re();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var xC=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var qg=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return qy()?8:fi.v(ru())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new xC;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(za()<=Dn.DEBUG&&C("QueryEngine","SDK will not create cache indexes for query:",Wa(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),_.resolve()):(za()<=Dn.DEBUG&&C("QueryEngine","Query:",Wa(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(za()<=Dn.DEBUG&&C("QueryEngine","The SDK decides to create cache indexes for query:",Wa(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Gt(n))):_.resolve())}ji(e,n){if(sk(n))return _.resolve(null);let r=Gt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Ag(n,null,"F"),r=Gt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=re(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.Zi(n,a);return this.Xi(n,u,o,c.readTime)?this.ji(e,Ag(n,null,"F")):this.es(e,u,n,c)}))})))}Hi(e,n,r,i){return sk(n)||i.isEqual(H.min())?_.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?_.resolve(null):(za()<=Dn.DEBUG&&C("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Wa(n)),this.es(e,o,n,Kk(i,-1)).next(a=>a))})}Zi(e,n){let r=new Ae(pO(e));return n.forEach((i,s)=>{wd(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return za()<=Dn.DEBUG&&C("QueryEngine","Using full collection scan to execute query:",Wa(n)),this.zi.getDocumentsMatchingQuery(e,n,Vn.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var MC=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new Oe(ee),this.rs=new Or(s=>lo(s),_d),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ug(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function QO(t,e,n,r){return new MC(t,e,n,r)}function YO(t,e){return y(this,null,function*(){let n=N(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=re();for(let u of i){o.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}for(let u of s){a.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}return n.localDocuments.getDocuments(r,c).next(u=>({us:u,removedBatchIds:o,addedBatchIds:a}))})})})}function W6(t,e){let n=N(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,c,u,l){let d=u.batch,h=d.keys(),f=_.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(c,p)).next(g=>{let m=u.docVersions.get(p);$(m!==null),g.version.compareTo(m)<0&&(d.applyToRemoteDocument(g,u),g.isValidDocument()&&(g.setReadTime(u.commitVersion),l.addEntry(g)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=re();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function XO(t){let e=N(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function K6(t,e){let n=N(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(Et.EMPTY_BYTE_STRING,H.min()).withLastLimboFreeSnapshotVersion(H.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(g,m,E){return g.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(h,f,l)&&a.push(n.Qr.updateTargetData(s,f))});let c=rn(),u=re();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(ZO(s,o,e.documentUpdates).next(l=>{c=l.cs,u=l.ls})),!r.isEqual(H.min())){let l=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return _.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.ns=i,s))}function ZO(t,e,n){let r=re(),i=re();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=rn();return n.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(H.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):C("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{cs:o,ls:i}})}function Q6(t,e){let n=N(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function lc(t,e){let n=N(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,_.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new cc(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function dc(t,e,n){return y(this,null,function*(){let r=N(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!ls(o))throw o;C("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function Hg(t,e,n){let r=N(t),i=H.min(),s=re();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,l){let d=N(c),h=d.rs.get(l);return h!==void 0?_.resolve(d.ns.get(h)):d.Qr.getTargetData(u,l)}(r,o,Gt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:H.min(),n?s:re())).next(a=>(t1(r,fO(e),a),{documents:a,hs:s})))}function JO(t,e){let n=N(t),r=N(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function e1(t,e){let n=N(t),r=n.ss.get(e)||H.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,Kk(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(t1(n,e,i),i))}function t1(t,e,n){let r=t.ss.get(e)||H.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function Y6(t,e,n,r){return y(this,null,function*(){let i=N(t),s=re(),o=rn();for(let u of n){let l=e.Ps(u.metadata.name);u.document&&(s=s.add(l));let d=e.Is(u);d.setReadTime(e.Ts(u.metadata.readTime)),o=o.insert(l,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield lc(i,function(l){return Gt(_c(ge.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>ZO(u,a,o).next(l=>(a.apply(u),l)).next(l=>i.Qr.removeMatchingKeysForTargetId(u,c.targetId).next(()=>i.Qr.addMatchingKeys(u,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,l.cs,l.ls)).next(()=>l.cs)))})}function X6(r,i){return y(this,arguments,function*(t,e,n=re()){let s=yield lc(t,Gt(D0(e.bundledQuery))),o=N(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=tt(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let u=s.withResumeToken(Et.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(u.targetId,u),o.Qr.updateTargetData(a,u).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function Nk(t,e){return`firestore_clients_${t}_${e}`}function kk(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function _I(t,e){return`firestore_targets_${t}_${e}`}var Gg=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new I(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(Je("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},zl=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new I(r.error.code,r.error.message))),s?new t(e,r.state,i):(Je("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},zg=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=C0();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=Xk(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(Je("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},RC=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(Je("SharedClientState",`Failed to parse online state: ${e}`),null)}},ud=class{constructor(){this.activeTargetIds=C0()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Wl=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Oe(ee),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=Nk(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new ud),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return y(this,null,function*(){let e=yield this.syncEngine.Li();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(Nk(this.persistenceKey,r));if(i){let s=zg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Bs(e,"pending")}updateMutationState(e,n,r){this.Bs(e,n,r),this.Ls(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(_I(this.persistenceKey,e));if(r){let i=zl.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(_I(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Ls(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return C("SharedClientState","READ",e,n),n}setItem(e,n){C("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){C("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(C("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void Je("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>y(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=yn._e;if(s!=null)try{let a=JSON.parse(s);$(typeof a=="number"),o=a}catch(a){Je("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==yn._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Bs(e,n,r){let i=new Gg(this.currentUser,e,n,r),s=kk(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Ls(e){let n=kk(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=_I(this.persistenceKey,e),s=new zl(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return zg.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Gg.Es(new ut(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return zl.Es(i,n)}xs(e){return RC.Es(e)}Js(e){return JSON.parse(e)}zs(e){return y(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);C("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=C0();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},Wg=class{constructor(){this.no=new ud,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new ud,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var PC=class{io(e){}shutdown(){}};var Kg=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){C("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){C("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var lg=null;function vI(){return lg===null?lg=function(){return 268435456+Math.round(2147483648*Math.random())}():lg++,"0x"+lg.toString(16)}var Z6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var NC=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var Ft="WebChannelConnection",kC=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=vI(),c=this.bo(n,r.toUriEncodedString());C("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(u,s,o),this.Co(n,c,u,i).then(l=>(C("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Ln("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",c,"request:",i),l})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+yc}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=Z6[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=vI();return new Promise((o,a)=>{let c=new qN;c.setWithCredentials(!0),c.listenOnce(BN.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case og.NO_ERROR:let l=c.getResponseJson();C(Ft,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case og.TIMEOUT:C(Ft,`RPC '${e}' ${s} timed out`),a(new I(v.DEADLINE_EXCEEDED,"Request time out"));break;case og.HTTP_ERROR:let d=c.getStatus();if(C(Ft,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let h=c.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(m){let E=m.toLowerCase().replace(/_/g,"-");return Object.values(v).indexOf(E)>=0?E:v.UNKNOWN}(f.status);a(new I(p,f.message))}else a(new I(v.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new I(v.UNAVAILABLE,"Connection failed."));break;default:L()}}finally{C(Ft,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);C(Ft,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}Fo(e,n,r){let i=vI(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=jN(),a=UN(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let l=s.join("");C(Ft,`Creating RPC '${e}' stream ${i}: ${l}`,c);let d=o.createWebChannel(l,c),h=!1,f=!1,p=new NC({lo:m=>{f?C(Ft,`Not sending because RPC '${e}' stream ${i} is closed:`,m):(h||(C(Ft,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),C(Ft,`RPC '${e}' stream ${i} sending:`,m),d.send(m))},ho:()=>d.close()}),g=(m,E,S)=>{m.listen(E,b=>{try{S(b)}catch(k){setTimeout(()=>{throw k},0)}})};return g(d,Fl.EventType.OPEN,()=>{f||C(Ft,`RPC '${e}' stream ${i} transport opened.`)}),g(d,Fl.EventType.CLOSE,()=>{f||(f=!0,C(Ft,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),g(d,Fl.EventType.ERROR,m=>{f||(f=!0,Ln(Ft,`RPC '${e}' stream ${i} transport errored:`,m),p.Vo(new I(v.UNAVAILABLE,"The operation could not be completed")))}),g(d,Fl.EventType.MESSAGE,m=>{var E;if(!f){let S=m.data[0];$(!!S);let b=S,k=b.error||((E=b[0])===null||E===void 0?void 0:E.error);if(k){C(Ft,`RPC '${e}' stream ${i} received error:`,k);let q=k.status,G=function(Cs){let NT=at[Cs];if(NT!==void 0)return AO(NT)}(q),Ee=k.message;G===void 0&&(G=v.INTERNAL,Ee="Unknown error status: "+q+" with message "+k.message),f=!0,p.Vo(new I(G,Ee)),d.close()}else C(Ft,`RPC '${e}' stream ${i} received:`,S),p.mo(S)}}),g(a,$N.STAT_EVENT,m=>{m.stat===gI.PROXY?C(Ft,`RPC '${e}' stream ${i} detected buffering proxy`):m.stat===gI.NOPROXY&&C(Ft,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function n1(){return typeof window<"u"?window:null}function gg(){return typeof document<"u"?document:null}function Ed(t){return new XI(t,!0)}var ld=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),i=Math.max(0,n-r);i>0&&C("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Lo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Bo!==null&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){this.Bo!==null&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}};var Qg=class{constructor(e,n,r,i,s,o,a,c){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new ld(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return y(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return y(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return y(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===v.RESOURCE_EXHAUSTED?(Je(n.toString()),Je("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===v.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new I(v.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>y(this,null,function*(){this.state=0,this.start()}))}__(e){return C("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(C("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},OC=class extends Qg{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=F6(this.serializer,e),r=function(s){if(!("targetChange"in s))return H.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?H.min():o.readTime?tt(o.readTime):H.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=eC(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=Tg(c)?{documents:FO(s,c)}:{query:LO(s,c).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=MO(s,o.resumeToken);let u=ZI(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(H.min())>0){a.readTime=ac(s,o.snapshotVersion.toTimestamp());let u=ZI(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=V6(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=eC(this.serializer),n.removeTarget=e,this.t_(n)}},FC=class extends Qg{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if($(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=L6(e.writeResults,e.commitTime),r=tt(e.commitTime);return this.listener.T_(r,n)}return $(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=eC(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>od(this.serializer,r))};this.t_(n)}};var LC=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new I(v.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,JI(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===v.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new I(v.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,JI(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===v.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new I(v.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var VC=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Je(n),this.g_=!1):C("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var jC=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>y(this,null,function*(){ds(this)&&(C("RemoteStore","Restarting streams for network reachability change."),yield function(c){return y(this,null,function*(){let u=N(c);u.v_.add(4),yield vc(u),u.x_.set("Unknown"),u.v_.delete(4),yield Id(u)})}(this))}))}),this.x_=new VC(r,i)}};function Id(t){return y(this,null,function*(){if(ds(t))for(let e of t.F_)yield e(!0)})}function vc(t){return y(this,null,function*(){for(let e of t.F_)yield e(!1)})}function pm(t,e){let n=N(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),M0(n)?x0(n):Ec(n).Jo()&&A0(n,e))}function dd(t,e){let n=N(t),r=Ec(n);n.C_.delete(e),r.Jo()&&r1(n,e),n.C_.size===0&&(r.Jo()?r.Xo():ds(n)&&n.x_.set("Unknown"))}function A0(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(H.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ec(t).c_(e)}function r1(t,e){t.O_.Oe(e),Ec(t).l_(e)}function x0(t){t.O_=new YI({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Ec(t).start(),t.x_.p_()}function M0(t){return ds(t)&&!Ec(t).Ho()&&t.C_.size>0}function ds(t){return N(t).v_.size===0}function i1(t){t.O_=void 0}function J6(t){return y(this,null,function*(){t.C_.forEach((e,n)=>{A0(t,e)})})}function e9(t,e){return y(this,null,function*(){i1(t),M0(t)?(t.x_.S_(e),x0(t)):t.x_.set("Unknown")})}function t9(t,e,n){return y(this,null,function*(){if(t.x_.set("Online"),e instanceof Mg&&e.state===2&&e.cause)try{yield function(i,s){return y(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){C("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Yg(t,r)}else if(e instanceof ec?t.O_.$e(e):e instanceof xg?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(H.min()))try{let r=yield XO(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let l=s.C_.get(u);l&&s.C_.set(u,l.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let l=s.C_.get(c);if(!l)return;s.C_.set(c,l.withResumeToken(Et.EMPTY_BYTE_STRING,l.snapshotVersion)),r1(s,c);let d=new cc(l.target,c,u,l.sequenceNumber);A0(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){C("RemoteStore","Failed to raise snapshot:",r),yield Yg(t,r)}})}function Yg(t,e,n){return y(this,null,function*(){if(!ls(e))throw e;t.v_.add(1),yield vc(t),t.x_.set("Offline"),n||(n=()=>XO(t.localStore)),t.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){C("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield Id(t)}))})}function s1(t,e){return e().catch(n=>Yg(t,n,e))}function wc(t){return y(this,null,function*(){let e=N(t),n=cs(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;n9(e);)try{let i=yield Q6(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,r9(e,i)}catch(i){yield Yg(e,i)}o1(e)&&a1(e)})}function n9(t){return ds(t)&&t.D_.length<10}function r9(t,e){t.D_.push(e);let n=cs(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function o1(t){return ds(t)&&!cs(t).Ho()&&t.D_.length>0}function a1(t){cs(t).start()}function i9(t){return y(this,null,function*(){cs(t).d_()})}function s9(t){return y(this,null,function*(){let e=cs(t);for(let n of t.D_)e.I_(n.mutations)})}function o9(t,e,n){return y(this,null,function*(){let r=t.D_.shift(),i=WI.from(r,e,n);yield s1(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield wc(t)})}function a9(t,e){return y(this,null,function*(){e&&cs(t).P_&&(yield function(r,i){return y(this,null,function*(){if(function(o){return SO(o)&&o!==v.ABORTED}(i.code)){let s=r.D_.shift();cs(r).Zo(),yield s1(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield wc(r)}})}(t,e)),o1(t)&&a1(t)})}function Ok(t,e){return y(this,null,function*(){let n=N(t);n.asyncQueue.verifyOperationInProgress(),C("RemoteStore","RemoteStore received new credentials");let r=ds(n);n.v_.add(3),yield vc(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield Id(n)})}function UC(t,e){return y(this,null,function*(){let n=N(t);e?(n.v_.delete(2),yield Id(n)):e||(n.v_.add(2),yield vc(n),n.x_.set("Unknown"))})}function Ec(t){return t.N_||(t.N_=function(n,r,i){let s=N(n);return s.R_(),new OC(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:J6.bind(null,t),To:e9.bind(null,t),u_:t9.bind(null,t)}),t.F_.push(e=>y(this,null,function*(){e?(t.N_.Zo(),M0(t)?x0(t):t.x_.set("Unknown")):(yield t.N_.stop(),i1(t))}))),t.N_}function cs(t){return t.B_||(t.B_=function(n,r,i){let s=N(n);return s.R_(),new FC(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:i9.bind(null,t),To:a9.bind(null,t),E_:s9.bind(null,t),T_:o9.bind(null,t)}),t.F_.push(e=>y(this,null,function*(){e?(t.B_.Zo(),yield wc(t)):(yield t.B_.stop(),t.D_.length>0&&(C("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}var BC=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new lt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new I(v.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ic(t,e){if(Je("AsyncQueue",`${e}: ${t}`),ls(t))return new I(v.UNAVAILABLE,`${e}: ${t}`);throw t}var Xg=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||R.comparator(n.key,r.key):(n,r)=>R.comparator(n.key,r.key),this.keyedMap=Bl(),this.sortedSet=new Oe(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var Zg=class{constructor(){this.L_=new Oe(R.comparator)}track(e){let n=e.doc.key,r=this.L_.get(n);r?e.type!==0&&r.type===3?this.L_=this.L_.insert(n,e):e.type===3&&r.type!==1?this.L_=this.L_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.L_=this.L_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.L_=this.L_.remove(n):e.type===1&&r.type===2?this.L_=this.L_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):L():this.L_=this.L_.insert(n,e)}k_(){let e=[];return this.L_.inorderTraversal((n,r)=>{e.push(r)}),e}},hc=class t{constructor(e,n,r,i,s,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,Xg.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var $C=class{constructor(){this.q_=void 0,this.Q_=[]}},qC=class{constructor(){this.queries=new Or(e=>hO(e),vd),this.onlineState="Unknown",this.K_=new Set}};function R0(t,e){return y(this,null,function*(){let n=N(t),r=e.query,i=!1,s=n.queries.get(r);if(s||(i=!0,s=new $C),i)try{s.q_=yield n.onListen(r)}catch(o){let a=Ic(o,`Initialization of query '${Wa(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.Q_.push(e),e.U_(n.onlineState),s.q_&&e.W_(s.q_)&&N0(n)})}function P0(t,e){return y(this,null,function*(){let n=N(t),r=e.query,i=!1,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),i=s.Q_.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}function c9(t,e){let n=N(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.W_(i)&&(r=!0);o.q_=i}}r&&N0(n)}function u9(t,e,n){let r=N(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function N0(t){t.K_.forEach(e=>{e.next()})}var hd=class{constructor(e,n,r){this.query=e,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}W_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new hc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.z_?this.H_(e)&&(this.G_.next(e),n=!0):this.J_(e,this.onlineState)&&(this.Y_(e),n=!0),this.j_=e,n}onError(e){this.G_.error(e)}U_(e){this.onlineState=e;let n=!1;return this.j_&&!this.z_&&this.J_(this.j_,e)&&(this.Y_(this.j_),n=!0),n}J_(e,n){if(!e.fromCache)return!0;let r=n!=="Offline";return(!this.options.Z_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}H_(e){if(e.docChanges.length>0)return!0;let n=this.j_&&this.j_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Y_(e){e=hc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.z_=!0,this.G_.next(e)}};var HC=class{constructor(e,n){this.X_=e,this.byteLength=n}ea(){return"metadata"in this.X_}};var Jg=class{constructor(e){this.serializer=e}Ps(e){return Rr(this.serializer,e)}Is(e){return e.metadata.exists?OO(this.serializer,e.document,!1):dt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return tt(e)}},GC=class{constructor(e,n,r){this.ta=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=c1(e)}na(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.X_.namedQuery)this.queries.push(e.X_.namedQuery);else if(e.X_.documentMetadata){this.documents.push({metadata:e.X_.documentMetadata}),e.X_.documentMetadata.exists||++n;let r=ge.fromString(e.X_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.X_.document&&(this.documents[this.documents.length-1].document=e.X_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ra(e){let n=new Map,r=new Jg(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||re()).add(s);n.set(o,a)}}return n}complete(){return y(this,null,function*(){let e=yield Y6(this.localStore,new Jg(this.serializer),this.documents,this.ta.id),n=this.ra(this.documents);for(let r of this.queries)yield X6(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ia:this.collectionGroups,sa:e}})}};function c1(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var em=class{constructor(e){this.key=e}},tm=class{constructor(e){this.key=e}},nm=class{constructor(e,n){this.query=e,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=re(),this.mutatedKeys=re(),this.ua=pO(e),this.ca=new Xg(this.ua)}get la(){return this.oa}ha(e,n){let r=n?n.Pa:new Zg,i=n?n.ca:this.ca,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=wd(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),m=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),m=!0):this.Ia(h,f)||(r.track({type:2,doc:f}),m=!0,(c&&this.ua(f,c)>0||u&&this.ua(f,u)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),m=!0):h&&!f&&(r.track({type:1,doc:h}),m=!0,(c||u)&&(a=!0)),m&&(f?(o=o.add(f),s=g?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{ca:o,Pa:r,Xi:a,mutatedKeys:s}}Ia(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.ca;this.ca=e.ca,this.mutatedKeys=e.mutatedKeys;let o=e.Pa.k_();o.sort((l,d)=>function(f,p){let g=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return L()}};return g(f)-g(p)}(l.type,d.type)||this.ua(l.doc,d.doc)),this.Ta(r),i=i!=null&&i;let a=n&&!i?this.Ea():[],c=this.aa.size===0&&this.current&&!i?1:0,u=c!==this._a;return this._a=c,o.length!==0||u?{snapshot:new hc(this.query,e.ca,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),da:a}:{da:a}}U_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new Zg,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(e){return!this.oa.has(e)&&!!this.ca.has(e)&&!this.ca.get(e).hasLocalMutations}Ta(e){e&&(e.addedDocuments.forEach(n=>this.oa=this.oa.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.oa=this.oa.delete(n)),this.current=e.current)}Ea(){if(!this.current)return[];let e=this.aa;this.aa=re(),this.ca.forEach(r=>{this.Aa(r.key)&&(this.aa=this.aa.add(r.key))});let n=[];return e.forEach(r=>{this.aa.has(r)||n.push(new tm(r))}),this.aa.forEach(r=>{e.has(r)||n.push(new em(r))}),n}Ra(e){this.oa=e.hs,this.aa=re();let n=this.ha(e.documents);return this.applyChanges(n,!0)}Va(){return hc.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,this._a===0,this.hasCachedResults)}},zC=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},WC=class{constructor(e){this.key=e,this.ma=!1}},KC=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.fa={},this.ga=new Or(a=>hO(a),vd),this.pa=new Map,this.ya=new Set,this.wa=new Oe(R.comparator),this.Sa=new Map,this.ba=new cd,this.Da={},this.Ca=new Map,this.va=uc.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return this.Fa===!0}};function l9(t,e){return y(this,null,function*(){let n=V0(t),r,i,s=n.ga.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Va();else{let o=yield lc(n.localStore,Gt(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield k0(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&pm(n.remoteStore,o)}return i})}function k0(t,e,n,r,i){return y(this,null,function*(){t.Ma=(d,h,f)=>function(g,m,E,S){return y(this,null,function*(){let b=m.view.ha(E);b.Xi&&(b=yield Hg(g.localStore,m.query,!1).then(({documents:Ee})=>m.view.ha(Ee,b)));let k=S&&S.targetChanges.get(m.targetId),q=S&&S.targetMismatches.get(m.targetId)!=null,G=m.view.applyChanges(b,g.isPrimaryClient,k,q);return QC(g,m.targetId,G.da),G.snapshot})}(t,d,h,f);let s=yield Hg(t.localStore,e,!0),o=new nm(e,s.hs),a=o.ha(s.documents),c=id.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,c);QC(t,n,u.da);let l=new zC(e,n,o);return t.ga.set(e,l),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),u.snapshot})}function d9(t,e){return y(this,null,function*(){let n=N(t),r=n.ga.get(e),i=n.pa.get(r.targetId);if(i.length>1)return n.pa.set(r.targetId,i.filter(s=>!vd(s,e))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield dc(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),dd(n.remoteStore,r.targetId),fc(n,r.targetId)}).catch(us))):(fc(n,r.targetId),yield dc(n.localStore,r.targetId,!0))})}function h9(t,e,n){return y(this,null,function*(){let r=j0(t);try{let i=yield function(o,a){let c=N(o),u=He.now(),l=a.reduce((f,p)=>f.add(p.key),re()),d,h;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=rn(),g=re();return c.os.getEntries(f,l).next(m=>{p=m,p.forEach((E,S)=>{S.isValidDocument()||(g=g.add(E))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,p)).next(m=>{d=m;let E=[];for(let S of a){let b=x6(S,d.get(S.key).overlayedDocument);b!=null&&E.push(new sr(S.key,b,sO(b.value.mapValue),Ye.exists(!0)))}return c.mutationQueue.addMutationBatch(f,u,E,a)}).next(m=>{h=m;let E=m.applyToLocalDocumentSet(d,g);return c.documentOverlayCache.saveOverlays(f,m.batchId,E)})}).then(()=>({batchId:h.batchId,changes:mO(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.Da[o.currentUser.toKey()];u||(u=new Oe(ee)),u=u.insert(a,c),o.Da[o.currentUser.toKey()]=u}(r,i.batchId,n),yield _i(r,i.changes),yield wc(r.remoteStore)}catch(i){let s=Ic(i,"Failed to persist write");n.reject(s)}})}function u1(t,e){return y(this,null,function*(){let n=N(t);try{let r=yield K6(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Sa.get(s);o&&($(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.ma=!0:i.modifiedDocuments.size>0?$(o.ma):i.removedDocuments.size>0&&($(o.ma),o.ma=!1))}),yield _i(n,r,e)}catch(r){yield us(r)}})}function Fk(t,e,n){let r=N(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ga.forEach((s,o)=>{let a=o.view.U_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=N(o);c.onlineState=a;let u=!1;c.queries.forEach((l,d)=>{for(let h of d.Q_)h.U_(a)&&(u=!0)}),u&&N0(c)}(r.eventManager,e),i.length&&r.fa.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function f9(t,e,n){return y(this,null,function*(){let r=N(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Sa.get(e),s=i&&i.key;if(s){let o=new Oe(R.comparator);o=o.insert(s,dt.newNoDocument(s,H.min()));let a=re().add(s),c=new rd(H.min(),new Map,new Oe(ee),o,a);yield u1(r,c),r.wa=r.wa.remove(s),r.Sa.delete(e),L0(r)}else yield dc(r.localStore,e,!1).then(()=>fc(r,e,n)).catch(us)})}function p9(t,e){return y(this,null,function*(){let n=N(t),r=e.batch.batchId;try{let i=yield W6(n.localStore,e);F0(n,r,null),O0(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield _i(n,i)}catch(i){yield us(i)}})}function g9(t,e,n){return y(this,null,function*(){let r=N(t);try{let i=yield function(o,a){let c=N(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let l;return c.mutationQueue.lookupMutationBatch(u,a).next(d=>($(d!==null),l=d.keys(),c.mutationQueue.removeMutationBatch(u,d))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,l,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,l)).next(()=>c.localDocuments.getDocuments(u,l))})}(r.localStore,e);F0(r,e,n),O0(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield _i(r,i)}catch(i){yield us(i)}})}function m9(t,e){return y(this,null,function*(){let n=N(t);ds(n.remoteStore)||C("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=N(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ca.get(r)||[];i.push(e),n.Ca.set(r,i)}catch(r){let i=Ic(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function O0(t,e){(t.Ca.get(e)||[]).forEach(n=>{n.resolve()}),t.Ca.delete(e)}function F0(t,e,n){let r=N(t),i=r.Da[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Da[r.currentUser.toKey()]=i}}function fc(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.pa.get(e))t.ga.delete(r),n&&t.fa.xa(r,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach(r=>{t.ba.containsKey(r)||l1(t,r)})}function l1(t,e){t.ya.delete(e.path.canonicalString());let n=t.wa.get(e);n!==null&&(dd(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),L0(t))}function QC(t,e,n){for(let r of n)r instanceof em?(t.ba.addReference(r.key,e),y9(t,r)):r instanceof tm?(C("SyncEngine","Document no longer in limbo: "+r.key),t.ba.removeReference(r.key,e),t.ba.containsKey(r.key)||l1(t,r.key)):L()}function y9(t,e){let n=e.key,r=n.path.canonicalString();t.wa.get(n)||t.ya.has(r)||(C("SyncEngine","New document in limbo: "+n),t.ya.add(r),L0(t))}function L0(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){let e=t.ya.values().next().value;t.ya.delete(e);let n=new R(ge.fromString(e)),r=t.va.next();t.Sa.set(r,new WC(n)),t.wa=t.wa.insert(n,r),pm(t.remoteStore,new cc(Gt(_c(n.path)),r,"TargetPurposeLimboResolution",yn._e))}}function _i(t,e,n){return y(this,null,function*(){let r=N(t),i=[],s=[],o=[];r.ga.isEmpty()||(r.ga.forEach((a,c)=>{o.push(r.Ma(c,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u?.fromCache?"not-current":"current"),u){i.push(u);let l=AC.Ki(c.targetId,u);s.push(l)}}))}),yield Promise.all(o),r.fa.u_(i),yield function(c,u){return y(this,null,function*(){let l=N(c);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>_.forEach(u,h=>_.forEach(h.qi,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>_.forEach(h.Qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!ls(d))throw d;C("LocalStore","Failed to update sequence numbers: "+d)}for(let d of u){let h=d.targetId;if(!d.fromCache){let f=l.ns.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);l.ns=l.ns.insert(h,g)}}})}(r.localStore,s))})}function _9(t,e){return y(this,null,function*(){let n=N(t);if(!n.currentUser.isEqual(e)){C("SyncEngine","User change. New user:",e.toKey());let r=yield YO(n.localStore,e);n.currentUser=e,function(s,o){s.Ca.forEach(a=>{a.forEach(c=>{c.reject(new I(v.CANCELLED,o))})}),s.Ca.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield _i(n,r.us)}})}function v9(t,e){let n=N(t),r=n.Sa.get(e);if(r&&r.ma)return re().add(r.key);{let i=re(),s=n.pa.get(e);if(!s)return i;for(let o of s){let a=n.ga.get(o);i=i.unionWith(a.view.la)}return i}}function w9(t,e){return y(this,null,function*(){let n=N(t),r=yield Hg(n.localStore,e.query,!0),i=e.view.Ra(r);return n.isPrimaryClient&&QC(n,e.targetId,i.da),i})}function E9(t,e){return y(this,null,function*(){let n=N(t);return e1(n.localStore,e).then(r=>_i(n,r))})}function I9(t,e,n,r){return y(this,null,function*(){let i=N(t),s=yield function(a,c){let u=N(a),l=N(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.vn(d,c).next(h=>h?u.localDocuments.getDocuments(d,h):_.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield wc(i.remoteStore):n==="acknowledged"||n==="rejected"?(F0(i,e,r||null),O0(i,e),function(a,c){N(N(a).mutationQueue).Mn(c)}(i.localStore,e)):L(),yield _i(i,s)):C("SyncEngine","Cannot apply mutation batch with id: "+e)})}function C9(t,e){return y(this,null,function*(){let n=N(t);if(V0(n),j0(n),e===!0&&n.Fa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield Lk(n,r.toArray());n.Fa=!0,yield UC(n.remoteStore,!0);for(let s of i)pm(n.remoteStore,s)}else if(e===!1&&n.Fa!==!1){let r=[],i=Promise.resolve();n.pa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(fc(n,o),dc(n.localStore,o,!0))),dd(n.remoteStore,o)}),yield i,yield Lk(n,r),function(o){let a=N(o);a.Sa.forEach((c,u)=>{dd(a.remoteStore,u)}),a.ba.mr(),a.Sa=new Map,a.wa=new Oe(R.comparator)}(n),n.Fa=!1,yield UC(n.remoteStore,!1)}})}function Lk(t,e,n){return y(this,null,function*(){let r=N(t),i=[],s=[];for(let o of e){let a,c=r.pa.get(o);if(c&&c.length!==0){a=yield lc(r.localStore,Gt(c[0]));for(let u of c){let l=r.ga.get(u),d=yield w9(r,l);d.snapshot&&s.push(d.snapshot)}}else{let u=yield JO(r.localStore,o);a=yield lc(r.localStore,u),yield k0(r,d1(u),o,!1,a.resumeToken)}i.push(a)}return r.fa.u_(s),i})}function d1(t){return dO(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function b9(t){return function(n){return N(N(n).persistence).Li()}(N(t).localStore)}function D9(t,e,n,r){return y(this,null,function*(){let i=N(t);if(i.Fa)return void C("SyncEngine","Ignoring unexpected query state notification.");let s=i.pa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield e1(i.localStore,fO(s[0])),a=rd.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Et.EMPTY_BYTE_STRING);yield _i(i,o,a);break}case"rejected":yield dc(i.localStore,e,!0),fc(i,e,r);break;default:L()}})}function T9(t,e,n){return y(this,null,function*(){let r=V0(t);if(r.Fa){for(let i of e){if(r.pa.has(i)){C("SyncEngine","Adding an already active target "+i);continue}let s=yield JO(r.localStore,i),o=yield lc(r.localStore,s);yield k0(r,d1(s),o.targetId,!1,o.resumeToken),pm(r.remoteStore,o)}for(let i of n)r.pa.has(i)&&(yield dc(r.localStore,i,!1).then(()=>{dd(r.remoteStore,i),fc(r,i)}).catch(us))}})}function V0(t){let e=N(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=u1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=v9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=f9.bind(null,e),e.fa.u_=c9.bind(null,e.eventManager),e.fa.xa=u9.bind(null,e.eventManager),e}function j0(t){let e=N(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=p9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=g9.bind(null,e),e}function S9(t,e,n){let r=N(t);(function(s,o,a){return y(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(f,p){let g=N(f),m=tt(p.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",E=>g.$r.getBundleMetadata(E,p.id)).then(E=>!!E&&E.createTime.compareTo(m)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(c1(c));let u=new GC(c,s.localStore,o.serializer),l=yield o.Oa();for(;l;){let h=yield u.na(l);h&&a._updateProgress(h),l=yield o.Oa()}let d=yield u.complete();return yield _i(s,d.sa,void 0),yield function(f,p){let g=N(f);return g.persistence.runTransaction("Save bundle","readwrite",m=>g.$r.saveBundleMetadata(m,p))}(s.localStore,c),a._completeWith(d.progress),Promise.resolve(d.ia)}catch(c){return Ln("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var fd=class{constructor(){this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){this.serializer=Ed(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return QO(this.persistence,new qg,e.initialUser,this.serializer)}createPersistence(e){return new Bg($g.Hr,this.serializer)}createSharedClientState(e){return new Wg}terminate(){return y(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var rm=class t extends fd{constructor(e,n,r){super(),this.Na=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){yield By(t.prototype,this,"initialize").call(this,e),yield this.Na.initialize(this,e),yield j0(this.Na.syncEngine),yield wc(this.Na.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return QO(this.persistence,new qg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new fC(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new RI(n,this.persistence);return new MI(e.asyncQueue,r)}createPersistence(e){let n=S0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Fn.withCacheSize(this.cacheSizeBytes):Fn.DEFAULT;return new SC(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,n1(),gg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Wg}},YC=class t extends rm{constructor(e,n){super(e,n,!1),this.Na=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return y(this,null,function*(){yield By(t.prototype,this,"initialize").call(this,e);let n=this.Na.syncEngine;this.sharedClientState instanceof Wl&&(this.sharedClientState.syncEngine={Zs:I9.bind(null,n),Xs:D9.bind(null,n),eo:T9.bind(null,n),Li:b9.bind(null,n),Ys:E9.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>y(this,null,function*(){yield C9(this.Na.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=n1();if(!Wl.D(n))throw new I(v.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=S0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Wl(n,e.asyncQueue,r,e.clientId,e.initialUser)}},pd=class{initialize(e,n){return y(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Fk(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=_9.bind(null,this.syncEngine),yield UC(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new qC}()}createDatastore(e){let n=Ed(e.databaseInfo.databaseId),r=function(s){return new kC(s)}(e.databaseInfo);return function(s,o,a,c){return new LC(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new jC(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Fk(this.syncEngine,n,0),function(){return Kg.D()?new Kg:new PC}())}createSyncEngine(e,n){return function(i,s,o,a,c,u,l){let d=new KC(i,s,o,a,c,u);return l&&(d.Fa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return y(this,null,function*(){var e;yield function(r){return y(this,null,function*(){let i=N(r);C("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield vc(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function Vk(t,e=10240){let n=0;return{read(){return y(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return y(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var pc=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ba(this.observer.next,e)}error(e){this.observer.error?this.Ba(this.observer.error,e):Je("Uncaught Error in snapshot listener:",e.toString())}La(){this.muted=!0}Ba(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var XC=class{constructor(e,n){this.ka=e,this.serializer=n,this.metadata=new lt,this.buffer=new Uint8Array,this.qa=function(){return new TextDecoder("utf-8")}(),this.Qa().then(r=>{r&&r.ea()?this.metadata.resolve(r.X_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.X_)}`))},r=>this.metadata.reject(r))}close(){return this.ka.cancel()}getMetadata(){return y(this,null,function*(){return this.metadata.promise})}Oa(){return y(this,null,function*(){return yield this.getMetadata(),this.Qa()})}Qa(){return y(this,null,function*(){let e=yield this.Ka();if(e===null)return null;let n=this.qa.decode(e),r=Number(n);isNaN(r)&&this.$a(`length string (${n}) is not valid number`);let i=yield this.Ua(r);return new HC(JSON.parse(i),e.length+r)})}Wa(){return this.buffer.findIndex(e=>e===123)}Ka(){return y(this,null,function*(){for(;this.Wa()<0&&!(yield this.Ga()););if(this.buffer.length===0)return null;let e=this.Wa();e<0&&this.$a("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ua(e){return y(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ga())&&this.$a("Reached the end of bundle when more is expected.");let n=this.qa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}$a(e){throw this.ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ga(){return y(this,null,function*(){let e=yield this.ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var ZC=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return y(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new I(v.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return y(this,null,function*(){let o=N(i),a={documents:s.map(d=>sd(o.serializer,d))},c=yield o.vo("BatchGetDocuments",o.serializer.databaseId,ge.emptyPath(),a,s.length),u=new Map;c.forEach(d=>{let h=O6(o.serializer,d);u.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=u.get(d.toString());$(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new as(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return y(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=R.fromPath(r);this.mutations.push(new ed(i,this.precondition(i)))}),yield function(r,i){return y(this,null,function*(){let s=N(r),o={writes:i.map(a=>od(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,ge.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw L();n=H.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new I(v.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(H.min())?Ye.exists(!1):Ye.updateTime(n):Ye.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(H.min()))throw new I(v.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ye.updateTime(n)}return Ye.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var JC=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.za=r.maxAttempts,this.jo=new ld(this.asyncQueue,"transaction_retry")}ja(){this.za-=1,this.Ha()}Ha(){this.jo.qo(()=>y(this,null,function*(){let e=new ZC(this.datastore),n=this.Ja(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Ya(i)}))}).catch(r=>{this.Ya(r)})}))}Ja(e){try{let n=this.updateFunction(e);return!yd(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Ya(e){this.za>0&&this.Za(e)?(this.za-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ha(),Promise.resolve()))):this.deferred.reject(e)}Za(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!SO(n)}return!1}};var e0=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ut.UNAUTHENTICATED,this.clientId=_g.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>y(this,null,function*(){C("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(C("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new I(v.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new lt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=Ic(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function mg(t,e){return y(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),C("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield YO(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function t0(t,e){return y(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield U0(t);C("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Ok(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Ok(e.remoteStore,i)),t._onlineComponents=e})}function h1(t){return t.name==="FirebaseError"?t.code===v.FAILED_PRECONDITION||t.code===v.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function U0(t){return y(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){C("FirestoreClient","Using user provided OfflineComponentProvider");try{yield mg(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!h1(n))throw n;Ln("Error using user provided cache. Falling back to memory cache: "+n),yield mg(t,new fd)}}else C("FirestoreClient","Using default OfflineComponentProvider"),yield mg(t,new fd);return t._offlineComponents})}function gm(t){return y(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(C("FirestoreClient","Using user provided OnlineComponentProvider"),yield t0(t,t._uninitializedComponentsProvider._online)):(C("FirestoreClient","Using default OnlineComponentProvider"),yield t0(t,new pd))),t._onlineComponents})}function f1(t){return U0(t).then(e=>e.persistence)}function B0(t){return U0(t).then(e=>e.localStore)}function p1(t){return gm(t).then(e=>e.remoteStore)}function $0(t){return gm(t).then(e=>e.syncEngine)}function A9(t){return gm(t).then(e=>e.datastore)}function gc(t){return y(this,null,function*(){let e=yield gm(t),n=e.eventManager;return n.onListen=l9.bind(null,e.syncEngine),n.onUnlisten=d9.bind(null,e.syncEngine),n})}function x9(t){return t.asyncQueue.enqueue(()=>y(this,null,function*(){let e=yield f1(t),n=yield p1(t);return e.setNetworkEnabled(!0),function(i){let s=N(i);return s.v_.delete(0),Id(s)}(n)}))}function M9(t){return t.asyncQueue.enqueue(()=>y(this,null,function*(){let e=yield f1(t),n=yield p1(t);return e.setNetworkEnabled(!1),function(i){return y(this,null,function*(){let s=N(i);s.v_.add(0),yield vc(s),s.x_.set("Offline")})}(n)}))}function R9(t,e){let n=new lt;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(i,s,o){return y(this,null,function*(){try{let a=yield function(u,l){let d=N(u);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new I(v.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Ic(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield B0(t),e,n)})),n.promise}function g1(t,e,n={}){let r=new lt;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(s,o,a,c,u){let l=new pc({next:h=>{o.enqueueAndForget(()=>P0(s,d));let f=h.docs.has(a);!f&&h.fromCache?u.reject(new I(v.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&c&&c.source==="server"?u.reject(new I(v.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new hd(_c(a.path),l,{includeMetadataChanges:!0,Z_:!0});return R0(s,d)}(yield gc(t),t.asyncQueue,e,n,r)})),r.promise}function P9(t,e){let n=new lt;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(i,s,o){return y(this,null,function*(){try{let a=yield Hg(i,s,!0),c=new nm(s,a.hs),u=c.ha(a.documents),l=c.applyChanges(u,!1);o.resolve(l.snapshot)}catch(a){let c=Ic(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield B0(t),e,n)})),n.promise}function m1(t,e,n={}){let r=new lt;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(s,o,a,c,u){let l=new pc({next:h=>{o.enqueueAndForget(()=>P0(s,d)),h.fromCache&&c.source==="server"?u.reject(new I(v.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new hd(a,l,{includeMetadataChanges:!0,Z_:!0});return R0(s,d)}(yield gc(t),t.asyncQueue,e,n,r)})),r.promise}function N9(t,e){let n=new pc(e);return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(i,s){N(i).K_.add(s),s.next()}(yield gc(t),n)})),()=>{n.La(),t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(i,s){N(i).K_.delete(s)}(yield gc(t),n)}))}}function k9(t,e,n,r){let i=function(o,a){let c;return c=typeof o=="string"?xO().encode(o):o,function(l,d){return new XC(l,d)}(function(l,d){if(l instanceof Uint8Array)return Vk(l,d);if(l instanceof ArrayBuffer)return Vk(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,Ed(e));t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){S9(yield $0(t),i,r)}))}function O9(t,e){return t.asyncQueue.enqueue(()=>y(this,null,function*(){return function(r,i){let s=N(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield B0(t),e)}))}function y1(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var jk=new Map;function q0(t,e,n){if(!n)throw new I(v.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function H0(t,e,n,r){if(e===!0&&r===!0)throw new I(v.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Uk(t){if(!R.isDocumentKey(t))throw new I(v.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Bk(t){if(R.isDocumentKey(t))throw new I(v.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function mm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":L()}function me(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new I(v.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=mm(t);throw new I(v.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function _1(t,e){if(e<=0)throw new I(v.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var im=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new I(v.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new I(v.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}H0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=y1((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new I(v.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new I(v.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new I(v.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},go=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new im({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new I(v.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new I(v.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new im(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new wI;switch(r.type){case"firstParty":return new bI(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new I(v.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=jk.get(n);r&&(C("ComponentProvider","Removing Datastore"),jk.delete(n),r.terminate())}(this),Promise.resolve()}};function v1(t,e,n,r={}){var i;let s=(t=me(t,go))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ln("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=ut.MOCK_USER;else{a=Vo(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new I(v.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new ut(u)}t._authCredentials=new EI(new yg(a,c))}}var Rt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Pe=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Pr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},Pr=class t extends Rt{constructor(e,n,r){super(e,n,_c(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Pe(this.firestore,null,new R(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function G0(t,e,...n){if(t=Q(t),q0("collection","path",e),t instanceof go){let r=ge.fromString(e,...n);return Bk(r),new Pr(t,null,r)}{if(!(t instanceof Pe||t instanceof Pr))throw new I(v.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ge.fromString(e,...n));return Bk(r),new Pr(t.firestore,null,r)}}function w1(t,e){if(t=me(t,go),q0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new I(v.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Rt(t,null,function(r){return new ir(ge.emptyPath(),r)}(e))}function Cd(t,e,...n){if(t=Q(t),arguments.length===1&&(e=_g.newId()),q0("doc","path",e),t instanceof go){let r=ge.fromString(e,...n);return Uk(r),new Pe(t,null,new R(r))}{if(!(t instanceof Pe||t instanceof Pr))throw new I(v.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ge.fromString(e,...n));return Uk(r),new Pe(t.firestore,t instanceof Pr?t.converter:null,new R(r))}}function z0(t,e){return t=Q(t),e=Q(e),(t instanceof Pe||t instanceof Pr)&&(e instanceof Pe||e instanceof Pr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function W0(t,e){return t=Q(t),e=Q(e),t instanceof Rt&&e instanceof Rt&&t.firestore===e.firestore&&vd(t._query,e._query)&&t.converter===e.converter}var n0=class{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new ld(this,"async_queue_retry"),this._u=()=>{let n=gg();n&&C("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=gg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.au(),this.uu(e)}enterRestrictedMode(e){if(!this.tu){this.tu=!0,this.su=e||!1;let n=gg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._u)}}enqueue(e){if(this.au(),this.tu)return new Promise(()=>{});let n=new lt;return this.uu(()=>this.tu&&this.su?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.eu.push(e),this.cu()))}cu(){return y(this,null,function*(){if(this.eu.length!==0){try{yield this.eu[0](),this.eu.shift(),this.jo.reset()}catch(e){if(!ls(e))throw e;C("AsyncQueue","Operation failed with retryable error: "+e)}this.eu.length>0&&this.jo.qo(()=>this.cu())}})}uu(e){let n=this.Xa.then(()=>(this.iu=!0,e().catch(r=>{this.ru=r,this.iu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Je("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.iu=!1,r))));return this.Xa=n,n}enqueueAfterDelay(e,n,r){this.au(),this.ou.indexOf(e)>-1&&(n=0);let i=BC.createAndSchedule(this,e,n,r,s=>this.lu(s));return this.nu.push(i),i}au(){this.ru&&L()}verifyOperationInProgress(){}hu(){return y(this,null,function*(){let e;do e=this.Xa,yield e;while(e!==this.Xa)})}Pu(e){for(let n of this.nu)if(n.timerId===e)return!0;return!1}Iu(e){return this.hu().then(()=>{this.nu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.nu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.hu()})}Tu(e){this.ou.push(e)}lu(e){let n=this.nu.indexOf(e);this.nu.splice(n,1)}};function r0(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var i0=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new lt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var E1=-1,Le=class extends go{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new n0}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||I1(this),this._firestoreClient.terminate()}};function pt(t){return t._firestoreClient||I1(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function I1(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,u,l){return new PI(a,c,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,y1(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new e0(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function C1(t,e){P1(t=me(t,Le));let n=pt(t);if(n._uninitializedComponentsProvider)throw new I(v.FAILED_PRECONDITION,"SDK cache is already specified.");Ln("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new pd;return D1(n,i,new rm(i,r.cacheSizeBytes,e?.forceOwnership))}function b1(t){P1(t=me(t,Le));let e=pt(t);if(e._uninitializedComponentsProvider)throw new I(v.FAILED_PRECONDITION,"SDK cache is already specified.");Ln("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new pd;return D1(e,r,new YC(r,n.cacheSizeBytes))}function D1(t,e,n){let r=new lt;return t.asyncQueue.enqueue(()=>y(this,null,function*(){try{yield mg(t,n),yield t0(t,e),r.resolve()}catch(i){let s=i;if(!h1(s))throw s;Ln("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function T1(t){if(t._initialized&&!t._terminated)throw new I(v.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new lt;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{yield function(r){return y(this,null,function*(){if(!fi.D())return Promise.resolve();let i=r+"main";yield fi.delete(i)})}(S0(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function S1(t){return function(n){let r=new lt;return n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return m9(yield $0(n),r)})),r.promise}(pt(t=me(t,Le)))}function A1(t){return x9(pt(t=me(t,Le)))}function x1(t){return M9(pt(t=me(t,Le)))}function M1(t,e){let n=pt(t=me(t,Le)),r=new i0;return k9(n,t._databaseId,e,r),r}function R1(t,e){return O9(pt(t=me(t,Le)),e).then(n=>n?new Rt(t,null,n.query):null)}function P1(t){if(t._initialized||t._terminated)throw new I(v.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Fr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(Et.fromBase64String(e))}catch(n){throw new I(v.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var or=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new I(v.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var mi=class{constructor(e){this._methodName=e}};var mo=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new I(v.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new I(v.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}};var F9=/^__.*__$/,s0=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new sr(e,this.data,this.fieldMask,n,this.fieldTransforms):new os(e,this.data,n,this.fieldTransforms)}},sm=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new sr(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function N1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw L()}}var om=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Eu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.mu(e),i}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.Eu(),i}gu(e){return this.Au({path:void 0,Vu:!0})}pu(e){return am(e,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Eu(){if(this.path)for(let e=0;e<this.path.length;e++)this.mu(this.path.get(e))}mu(e){if(e.length===0)throw this.pu("Document fields must not be empty");if(N1(this.du)&&F9.test(e))throw this.pu('Document fields cannot begin and end with "__"')}},o0=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Ed(e)}Su(e,n,r,i=!1){return new om({du:e,methodName:n,wu:r,path:et.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function wo(t){let e=t._freezeSettings(),n=Ed(t._databaseId);return new o0(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ym(t,e,n,r,i,s={}){let o=t.Su(s.merge||s.mergeFields?2:0,e,n,i);Y0("Data must be an object, but it was:",o,r);let a=F1(r,o),c,u;if(s.merge)c=new _n(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=d0(e,d,n);if(!o.contains(h))throw new I(v.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);V1(l,h)||l.push(h)}c=new _n(l),u=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=o.fieldTransforms;return new s0(new Lt(a),c,u)}var gd=class t extends mi{_toFieldTransform(e){if(e.du!==2)throw e.du===1?e.pu(`${this._methodName}() can only appear at the top level of your update data`):e.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function k1(t,e,n){return new om({du:3,wu:e.settings.wu,methodName:t._methodName,Vu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var a0=class t extends mi{_toFieldTransform(e){return new ho(e.path,new is)}isEqual(e){return e instanceof t}},c0=class t extends mi{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=k1(this,e,!0),r=this.bu.map(s=>Eo(s,n)),i=new pi(r);return new ho(e.path,i)}isEqual(e){return e instanceof t&&Hy(this.bu,e.bu)}},u0=class t extends mi{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=k1(this,e,!0),r=this.bu.map(s=>Eo(s,n)),i=new gi(r);return new ho(e.path,i)}isEqual(e){return e instanceof t&&Hy(this.bu,e.bu)}},l0=class t extends mi{constructor(e,n){super(e),this.Du=n}_toFieldTransform(e){let n=new ss(e.serializer,wO(e.serializer,this.Du));return new ho(e.path,n)}isEqual(e){return e instanceof t&&this.Du===e.Du}};function K0(t,e,n,r){let i=t.Su(1,e,n);Y0("Data must be an object, but it was:",i,r);let s=[],o=Lt.empty();vo(r,(c,u)=>{let l=X0(e,c,n);u=Q(u);let d=i.fu(l);if(u instanceof gd)s.push(l);else{let h=Eo(u,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new _n(s);return new sm(o,a,i.fieldTransforms)}function Q0(t,e,n,r,i,s){let o=t.Su(1,e,n),a=[d0(e,r,n)],c=[i];if(s.length%2!=0)throw new I(v.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(d0(e,s[h])),c.push(s[h+1]);let u=[],l=Lt.empty();for(let h=a.length-1;h>=0;--h)if(!V1(u,a[h])){let f=a[h],p=c[h];p=Q(p);let g=o.fu(f);if(p instanceof gd)u.push(f);else{let m=Eo(p,g);m!=null&&(u.push(f),l.set(f,m))}}let d=new _n(u);return new sm(l,d,o.fieldTransforms)}function O1(t,e,n,r=!1){return Eo(n,t.Su(r?4:3,e))}function Eo(t,e){if(L1(t=Q(t)))return Y0("Unsupported field value:",e,t),F1(t,e);if(t instanceof mi)return function(r,i){if(!N1(i.du))throw i.pu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.pu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&e.du!==4)throw e.pu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=Eo(a,i.gu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Q(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return wO(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=He.fromDate(r);return{timestampValue:ac(i.serializer,s)}}if(r instanceof He){let s=new He(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ac(i.serializer,s)}}if(r instanceof mo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Fr)return{bytesValue:MO(i.serializer,r._byteString)};if(r instanceof Pe){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.pu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:b0(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.pu(`Unsupported field value: ${mm(r)}`)}(t,e)}function F1(t,e){let n={};return nO(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vo(t,(r,i)=>{let s=Eo(i,e.Ru(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function L1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof He||t instanceof mo||t instanceof Fr||t instanceof Pe||t instanceof mi)}function Y0(t,e,n){if(!L1(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=mm(n);throw r==="an object"?e.pu(t+" a custom object"):e.pu(t+" "+r)}}function d0(t,e,n){if((e=Q(e))instanceof or)return e._internalPath;if(typeof e=="string")return X0(t,e);throw am("Field path arguments must be of type string or ",t,!1,void 0,n)}var L9=new RegExp("[~\\*/\\[\\]]");function X0(t,e,n){if(e.search(L9)>=0)throw am(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new or(...e.split("."))._internalPath}catch{throw am(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function am(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new I(v.INVALID_ARGUMENT,a+t+c)}function V1(t,e){return t.some(n=>n.isEqual(e))}var yo=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Pe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new h0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(_m("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},h0=class extends yo{data(){return super.data()}};function _m(t,e){return typeof e=="string"?X0(t,e):e instanceof or?e._internalPath:e._delegate._internalPath}function j1(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new I(v.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var md=class{},_o=class extends md{};function vi(t,e,...n){let r=[];e instanceof md&&r.push(e),r=r.concat(n),function(s){let o=s.filter(c=>c instanceof f0).length,a=s.filter(c=>c instanceof cm).length;if(o>1||o>0&&a>0)throw new I(v.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var cm=class t extends _o{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return Q1(e._query,n),new Rt(e.firestore,e.converter,GI(e._query,n))}_parse(e){let n=wo(e.firestore);return function(s,o,a,c,u,l,d){let h;if(u.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new I(v.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){qk(d,l);let f=[];for(let p of d)f.push($k(c,s,p));h={arrayValue:{values:f}}}else h=$k(c,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||qk(d,l),h=O1(a,o,d,l==="in"||l==="not-in");return fe.create(u,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function U1(t,e,n){let r=e,i=_m("where",t);return cm._create(i,r,n)}var f0=class t extends md{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:be.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)Q1(o,c),o=GI(o,c)}(e._query,n),new Rt(e.firestore,e.converter,GI(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var p0=class t extends _o{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new I(v.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new I(v.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new uo(s,o)}(e._query,this._field,this._direction);return new Rt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new ir(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function B1(t,e="asc"){let n=e,r=_m("orderBy",t);return p0._create(r,n)}var um=class t extends _o{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new Rt(e.firestore,e.converter,Ag(e._query,this._limit,this._limitType))}};function $1(t){return _1("limit",t),um._create("limit",t,"F")}function q1(t){return _1("limitToLast",t),um._create("limitToLast",t,"L")}var lm=class t extends _o{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=K1(e,this.type,this._docOrFields,this._inclusive);return new Rt(e.firestore,e.converter,function(i,s){return new ir(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function H1(...t){return lm._create("startAt",t,!0)}function G1(...t){return lm._create("startAfter",t,!1)}var dm=class t extends _o{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=K1(e,this.type,this._docOrFields,this._inclusive);return new Rt(e.firestore,e.converter,function(i,s){return new ir(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function z1(...t){return dm._create("endBefore",t,!1)}function W1(...t){return dm._create("endAt",t,!0)}function K1(t,e,n,r){if(n[0]=Q(n[0]),n[0]instanceof yo)return function(s,o,a,c,u){if(!c)throw new I(v.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of Ja(s))if(d.field.isKeyField())l.push(co(o,c.key));else{let h=c.data.field(d.field);if(fm(h))throw new I(v.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new I(v.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new kr(l,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=wo(t.firestore);return function(o,a,c,u,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new I(v.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let g=l[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new I(v.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof g}`);if(!I0(o)&&g.indexOf("/")!==-1)throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${g}' contains a slash.`);let m=o.path.child(ge.fromString(g));if(!R.isDocumentKey(m))throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${m}' is not because it contains an odd number of segments.`);let E=new R(m);f.push(co(a,E))}else{let m=O1(c,u,g);f.push(m)}}return new kr(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function $k(t,e,n){if(typeof(n=Q(n))=="string"){if(n==="")throw new I(v.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!I0(e)&&n.indexOf("/")!==-1)throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(ge.fromString(n));if(!R.isDocumentKey(r))throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return co(t,new R(r))}if(n instanceof Pe)return co(t,n._key);throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${mm(n)}.`)}function qk(t,e){if(!Array.isArray(t)||t.length===0)throw new I(v.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Q1(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new I(v.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new I(v.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var mc=class{convertValue(e,n="none"){switch(ao(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ts(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw L()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return vo(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new mo(Qe(e.latitude),Qe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=w0(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Xl(e));default:return null}}convertTimestamp(e){let n=es(e);return new He(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=ge.fromString(e);$(BO(r));let i=new ns(r.get(1),r.get(3)),s=new R(r.popFirst(5));return i.isEqual(n)||Je(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function vm(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var g0=class extends mc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Pe(this.firestore,null,n)}};var hi=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},jn=class extends yo{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Zi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(_m("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Zi=class extends jn{data(e={}){return super.data(e)}},ar=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new hi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Zi(this._firestore,this._userDataWriter,r.key,r,new hi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new I(v.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Zi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new hi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Zi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new hi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,l=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:V9(a.type),doc:c,oldIndex:u,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function V9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return L()}}function Z0(t,e){return t instanceof jn&&e instanceof jn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof ar&&e instanceof ar&&t._firestore===e._firestore&&W0(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Y1(t){t=me(t,Pe);let e=me(t.firestore,Le);return g1(pt(e),t._key).then(n=>nb(e,t,n))}var yi=class extends mc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Pe(this.firestore,null,n)}};function X1(t){t=me(t,Pe);let e=me(t.firestore,Le),n=pt(e),r=new yi(e);return R9(n,t._key).then(i=>new jn(e,r,t._key,i,new hi(i!==null&&i.hasLocalMutations,!0),t.converter))}function Z1(t){t=me(t,Pe);let e=me(t.firestore,Le);return g1(pt(e),t._key,{source:"server"}).then(n=>nb(e,t,n))}function J1(t){t=me(t,Rt);let e=me(t.firestore,Le),n=pt(e),r=new yi(e);return j1(t._query),m1(n,t._query).then(i=>new ar(e,r,t,i))}function eF(t){t=me(t,Rt);let e=me(t.firestore,Le),n=pt(e),r=new yi(e);return P9(n,t._query).then(i=>new ar(e,r,t,i))}function tF(t){t=me(t,Rt);let e=me(t.firestore,Le),n=pt(e),r=new yi(e);return m1(n,t._query,{source:"server"}).then(i=>new ar(e,r,t,i))}function J0(t,e,n){t=me(t,Pe);let r=me(t.firestore,Le),i=vm(t.converter,e,n);return Cc(r,[ym(wo(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Ye.none())])}function eb(t,e,n,...r){t=me(t,Pe);let i=me(t.firestore,Le),s=wo(i),o;return o=typeof(e=Q(e))=="string"||e instanceof or?Q0(s,"updateDoc",t._key,e,n,r):K0(s,"updateDoc",t._key,e),Cc(i,[o.toMutation(t._key,Ye.exists(!0))])}function nF(t){return Cc(me(t.firestore,Le),[new as(t._key,Ye.none())])}function rF(t,e){let n=me(t.firestore,Le),r=Cd(t),i=vm(t.converter,e);return Cc(n,[ym(wo(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Ye.exists(!1))]).then(()=>r)}function tb(t,...e){var n,r,i;t=Q(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||r0(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(r0(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let c,u,l;if(t instanceof Pe)u=me(t.firestore,Le),l=_c(t._key.path),c={next:d=>{e[o]&&e[o](nb(u,t,d))},error:e[o+1],complete:e[o+2]};else{let d=me(t,Rt);u=me(d.firestore,Le),l=d._query;let h=new yi(u);c={next:f=>{e[o]&&e[o](new ar(u,h,d,f))},error:e[o+1],complete:e[o+2]},j1(t._query)}return function(h,f,p,g){let m=new pc(g),E=new hd(f,m,p);return h.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return R0(yield gc(h),E)})),()=>{m.La(),h.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return P0(yield gc(h),E)}))}}(pt(u),l,a,c)}function iF(t,e){return N9(pt(t=me(t,Le)),r0(e)?e:{next:e})}function Cc(t,e){return function(r,i){let s=new lt;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return h9(yield $0(r),i,s)})),s.promise}(pt(t),e)}function nb(t,e,n){let r=n.docs.get(e._key),i=new yi(t);return new jn(t,i,e._key,r,new hi(n.hasPendingWrites,n.fromCache),e.converter)}var j9={maxAttempts:5};var hm=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=wo(e)}set(e,n,r){this._verifyNotCommitted();let i=Yi(e,this._firestore),s=vm(i.converter,n,r),o=ym(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Ye.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=Yi(e,this._firestore),o;return o=typeof(n=Q(n))=="string"||n instanceof or?Q0(this._dataReader,"WriteBatch.update",s._key,n,r,i):K0(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Ye.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=Yi(e,this._firestore);return this._mutations=this._mutations.concat(new as(n._key,Ye.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new I(v.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Yi(t,e){if((t=Q(t)).firestore!==e)throw new I(v.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var m0=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=wo(n)}get(n){let r=Yi(n,this._firestore),i=new g0(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return L();let o=s[0];if(o.isFoundDocument())return new yo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new yo(this._firestore,i,r._key,null,r.converter);throw L()})}set(n,r,i){let s=Yi(n,this._firestore),o=vm(s.converter,r,i),a=ym(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=Yi(n,this._firestore),a;return a=typeof(r=Q(r))=="string"||r instanceof or?Q0(this._dataReader,"Transaction.update",o._key,r,i,s):K0(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=Yi(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=Yi(e,this._firestore),r=new yi(this._firestore);return super.get(e).then(i=>new jn(this._firestore,r,n._key,i._document,new hi(!1,!1),n.converter))}};function sF(t,e,n){t=me(t,Le);let r=Object.assign(Object.assign({},j9),n);return function(s){if(s.maxAttempts<1)throw new I(v.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new lt;return s.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let u=yield A9(s);new JC(s.asyncQueue,u,a,o,c).ja()})),c.promise}(pt(t),i=>e(new m0(t,i)),r)}function oF(){return new gd("deleteField")}function aF(){return new a0("serverTimestamp")}function cF(...t){return new c0("arrayUnion",t)}function uF(...t){return new u0("arrayRemove",t)}function lF(t){return new l0("increment",t)}(function(e,n=!0){(function(i){yc=i})(jo),Gr(new Dt("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Le(new II(r.getProvider("auth-internal")),new TI(r.getProvider("app-check-internal")),function(u,l){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new I(v.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ns(u.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Zt(GN,"4.4.2",e),Zt(GN,"4.4.2","esm2017")})();var U9="@firebase/firestore-compat",B9="0.3.25";function cb(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new I("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function dF(){if(typeof Uint8Array>"u")throw new I("unimplemented","Uint8Arrays are not available in this environment.")}function hF(){if(!rO())throw new I("unimplemented","Blobs are unavailable in Firestore in this environment.")}var wm=class t{constructor(e){this._delegate=e}static fromBase64String(e){return hF(),new t(Fr.fromBase64String(e))}static fromUint8Array(e){return dF(),new t(Fr.fromUint8Array(e))}toBase64(){return hF(),this._delegate.toBase64()}toUint8Array(){return dF(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function rb(t){return $9(t,["next","error","complete"])}function $9(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var ib=class{enableIndexedDbPersistence(e,n){return C1(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return b1(e._delegate)}clearIndexedDbPersistence(e){return T1(e._delegate)}},Em=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ns||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Ln("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){v1(this._delegate,e,n,r)}enableNetwork(){return A1(this._delegate)}disableNetwork(){return x1(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,H0("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return S1(this._delegate)}onSnapshotsInSync(e){return iF(this._delegate,e)}get app(){if(!this._appCompat)throw new I("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Tc(this,G0(this._delegate,e))}catch(n){throw zt(n,"collection()","Firestore.collection()")}}doc(e){try{return new Lr(this,Cd(this._delegate,e))}catch(n){throw zt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Do(this,w1(this._delegate,e))}catch(n){throw zt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return sF(this._delegate,n=>e(new Im(this,n)))}batch(){return pt(this._delegate),new Cm(new hm(this._delegate,e=>Cc(this._delegate,e)))}loadBundle(e){return M1(this._delegate,e)}namedQuery(e){return R1(this._delegate,e).then(n=>n?new Do(this,n):null)}},bc=class extends mc{constructor(e){super(),this.firestore=e}convertBytes(e){return new wm(new Fr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return Lr.forKey(n,this.firestore,null)}};function q9(t){Gk(t)}var Im=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new bc(e)}get(e){let n=Io(e);return this._delegate.get(n).then(r=>new Co(this._firestore,new jn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=Io(e);return r?(cb("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Io(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Io(e);return this._delegate.delete(n),this}},Cm=class{constructor(e){this._delegate=e}set(e,n,r){let i=Io(e);return r?(cb("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Io(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Io(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},Dc=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Zi(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new bo(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new bc(e),n),i.set(n,s)),s}};Dc.INSTANCES=new WeakMap;var Lr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new bc(e)}static forPath(e,n,r){if(e.length%2!==0)throw new I("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new Pe(n._delegate,r,new R(e)))}static forKey(e,n,r){return new t(n,new Pe(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Tc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Tc(this.firestore,G0(this._delegate,e))}catch(n){throw zt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Q(e),e instanceof Pe?z0(this._delegate,e):!1}set(e,n){n=cb("DocumentReference.set",n);try{return n?J0(this._delegate,e,n):J0(this._delegate,e)}catch(r){throw zt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?eb(this._delegate,e):eb(this._delegate,e,n,...r)}catch(i){throw zt(i,"updateDoc()","DocumentReference.update()")}}delete(){return nF(this._delegate)}onSnapshot(...e){let n=fF(e),r=pF(e,i=>new Co(this.firestore,new jn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return tb(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=X1(this._delegate):e?.source==="server"?n=Z1(this._delegate):n=Y1(this._delegate),n.then(r=>new Co(this.firestore,new jn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Dc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function zt(t,e,n){return t.message=t.message.replace(e,n),t}function fF(t){for(let e of t)if(typeof e=="object"&&!rb(e))return e;return{}}function pF(t,e){var n,r;let i;return rb(t[0])?i=t[0]:rb(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Co=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Lr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Z0(this._delegate,e._delegate)}},bo=class extends Co{data(e){let n=this._delegate.data(e);return this._delegate._converter||zk(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},Do=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new bc(e)}where(e,n,r){try{return new t(this.firestore,vi(this._delegate,U1(e,n,r)))}catch(i){throw zt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,vi(this._delegate,B1(e,n)))}catch(r){throw zt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,vi(this._delegate,$1(e)))}catch(n){throw zt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,vi(this._delegate,q1(e)))}catch(n){throw zt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,vi(this._delegate,H1(...e)))}catch(n){throw zt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,vi(this._delegate,G1(...e)))}catch(n){throw zt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,vi(this._delegate,z1(...e)))}catch(n){throw zt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,vi(this._delegate,W1(...e)))}catch(n){throw zt(n,"endAt()","Query.endAt()")}}isEqual(e){return W0(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=eF(this._delegate):e?.source==="server"?n=tF(this._delegate):n=J1(this._delegate),n.then(r=>new bd(this.firestore,new ar(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=fF(e),r=pF(e,i=>new bd(this.firestore,new ar(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return tb(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Dc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},sb=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new bo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},bd=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new Do(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new bo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new sb(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new bo(this._firestore,r))})}isEqual(e){return Z0(this._delegate,e._delegate)}},Tc=class t extends Do{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Lr(this.firestore,e):null}doc(e){try{return e===void 0?new Lr(this.firestore,Cd(this._delegate)):new Lr(this.firestore,Cd(this._delegate,e))}catch(n){throw zt(n,"doc()","CollectionReference.doc()")}}add(e){return rF(this._delegate,e).then(n=>new Lr(this.firestore,n))}isEqual(e){return z0(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Dc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Io(t){return me(t,Pe)}var ob=class t{constructor(...e){this._delegate=new or(...e)}static documentId(){return new t(et.keyField().canonicalString())}isEqual(e){return e=Q(e),e instanceof or?this._delegate._internalPath.isEqual(e._internalPath):!1}};var ab=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=aF();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=oF();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=cF(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=uF(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=lF(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var H9={Firestore:Em,GeoPoint:mo,Timestamp:He,Blob:wm,Transaction:Im,WriteBatch:Cm,DocumentReference:Lr,DocumentSnapshot:Co,Query:Do,QueryDocumentSnapshot:bo,QuerySnapshot:bd,CollectionReference:Tc,FieldPath:ob,FieldValue:ab,setLogLevel:q9,CACHE_SIZE_UNLIMITED:E1};function G9(t,e){t.INTERNAL.registerComponent(new Dt("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},H9)))}function z9(t){G9(t,(e,n)=>new Em(e,n,new ib)),t.registerVersion(U9,B9)}z9(Ue);function W9(t,e=Wr){return new ne(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function gF(t,e){return W9(t,e)}function K9(t,e){return gF(t,e).pipe(As(void 0),lu(),V(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function db(t,e){return gF(t,e).pipe(V(n=>({payload:n,type:"query"})))}var bm=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=wF(r,n);return new Tm(i,s,this.afs)}snapshotChanges(){return K9(this.ref,this.afs.schedulers.outsideAngular).pipe(Fe)}valueChanges(e={}){return this.snapshotChanges().pipe(V(({payload:n})=>e.idField?ye(A({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return oe(this.ref.get(e)).pipe(Fe)}};function Dm(t,e){return db(t,e).pipe(As(void 0),lu(),V(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let u=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));u&&JSON.stringify(u.doc.metadata)===JSON.stringify(a.metadata)||!u&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function mF(t,e,n){return Dm(t,n).pipe(fr((r,i)=>Q9(r,i.map(s=>s.payload),e),[]),uu(),V(r=>r.map(i=>({type:i.type,payload:i}))))}function Q9(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=Y9(t,r))}),t}function ub(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function Y9(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return ub(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return ub(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return ub(t,e.oldIndex,1);break}return t}function yF(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var Tm=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Dm(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(V(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(As(void 0),lu(),yt(([r,i])=>i.length>0||!r),V(([,r])=>r),Fe)}auditTrail(e){return this.stateChanges(e).pipe(fr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=yF(e);return mF(this.query,n,this.afs.schedulers.outsideAngular).pipe(Fe)}valueChanges(e={}){return db(this.query,this.afs.schedulers.outsideAngular).pipe(V(n=>n.payload.docs.map(r=>e.idField?ye(A({},r.data()),{[e.idField]:r.id}):r.data())),Fe)}get(e){return oe(this.query.get(e)).pipe(Fe)}add(e){return this.ref.add(e)}doc(e){return new bm(this.ref.doc(e),this.afs)}},lb=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Dm(this.query,this.afs.schedulers.outsideAngular).pipe(Fe):Dm(this.query,this.afs.schedulers.outsideAngular).pipe(V(n=>n.filter(r=>e.indexOf(r.type)>-1)),yt(n=>n.length>0),Fe)}auditTrail(e){return this.stateChanges(e).pipe(fr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=yF(e);return mF(this.query,n,this.afs.schedulers.outsideAngular).pipe(Fe)}valueChanges(e={}){return db(this.query,this.afs.schedulers.outsideAngular).pipe(V(r=>r.payload.docs.map(i=>e.idField?A({[e.idField]:i.id},i.data()):i.data())),Fe)}get(e){return oe(this.query.get(e)).pipe(Fe)}},_F=new x("angularfire2.enableFirestorePersistence"),vF=new x("angularfire2.firestore.persistenceSettings"),X9=new x("angularfire2.firestore.settings"),Z9=new x("angularfire2.firestore.use-emulator");function wF(t,e=n=>n){return{query:e(t),ref:t}}var Dd=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,c,u,l,d,h,f,p,g,m,E,S){this.schedulers=c;let b=ai(n,a,r),k=l;d&&fl(b,a,h,p,g,m,f,E),[this.firestore,this.persistenceEnabled$]=Hi(`${b.name}.firestore`,"AngularFirestore",b.name,()=>{let q=a.runOutsideAngular(()=>b.firestore());if(s&&q.settings(s),k&&q.useEmulator(...k),i&&!Gs(o)){let G=()=>{try{return oe(q.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(Ee){return typeof console<"u"&&console.warn(Ee),U(!1)}};return[q,a.runOutsideAngular(G)]}else return[q,U(!1)]},[s,k,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=wF(i,r),a=this.schedulers.ngZone.run(()=>s);return new Tm(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new lb(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new bm(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(w(Cr),w(br,8),w(_F,8),w(X9,8),w(ot),w(se),w($i),w(vF,8),w(Z9,8),w(ci,8),w(al,8),w(cl,8),w(ul,8),w(ll,8),w(dl,8),w(hl,8),w(Jn,8))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),EF=(()=>{class t{constructor(){Ue.registerVersion("angularfire",er.full,"fst-compat")}static enablePersistence(n){return{ngModule:t,providers:[{provide:_F,useValue:!0},{provide:vF,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Me({type:t});static \u0275inj=Re({providers:[Dd]})}return t})();var Un=(()=>{let e=class e{constructor(r,i,s){this.afs=r,this.afAuth=i,this.router=s,this.adminEmails=["dhavalll63@gmail.com","dhaval00033@gmail.com"]}isAdmin(r){return this.adminEmails.includes(r)}SignUp(r,i){return y(this,null,function*(){try{let s=yield this.afAuth.createUserWithEmailAndPassword(r,i),o=r.substring(0,5);yield this.createCollection(o),yield this.SendVerificationMail()}catch(s){window.alert(s)}})}SendVerificationMail(){return y(this,null,function*(){try{let r=yield this.afAuth.currentUser;r&&r.email&&!r.emailVerified?(yield r.sendEmailVerification(),console.log("Verification email sent."),this.router.navigate(["/verify-email"]),yield this.saveuserEmail(r.email)):r&&r.email&&r.emailVerified?console.log("Email is already verified."):console.log("No user found or email not available.")}catch(r){console.error("Error sending verification email:",r)}})}saveuserEmail(r){return y(this,null,function*(){try{let i=yield this.afAuth.currentUser;if(i){let s=i.uid;yield this.afs.collection("AdminUser").doc(s).set({email:r}),console.log("User email saved to Firestore")}else console.log("User not available")}catch(i){console.error("Error saving user email to Firestore:",i)}})}SignIn(r,i){return this.afAuth.signInWithEmailAndPassword(r,i).then(s=>{if(s.user){let o=s.user.email||"";this.navigateBasedOnUserRole(o),this.userCollectionName=this.isAdmin(o)?"AdminUser":o.substring(0,5),localStorage.setItem("isLoggedIn","true")}else console.log("No user found.")}).catch(s=>{window.alert(s.message)})}SignUpWithGoogle(){return y(this,null,function*(){try{let r=new Wy;r.setCustomParameters({prompt:"select_account"});let i=yield this.afAuth.signInWithPopup(r);if(i.user){let s=i.user.email||"";this.isAdmin(s)?this.router.navigate(["/admin-dashboard"]):(this.router.navigate(["/dashboard"]),yield this.saveuserEmail(s))}else console.log("No user found.")}catch(r){console.error("Error during Google sign-up:",r)}})}ForgotPassword(r){return y(this,null,function*(){try{yield this.afAuth.sendPasswordResetEmail(r),window.alert("Password reset email sent, check your inbox.")}catch(i){window.alert(i)}})}navigateBasedOnUserRole(r){this.router.navigate(this.isAdmin(r)?["admin-dashboard"]:["dashboard"])}SignOut(){return this.afAuth.signOut().then(()=>{localStorage.removeItem("user"),this.router.navigate(["login"])})}deleteByEmail(r){return y(this,null,function*(){try{let i=yield this.afs.collection("AdminUser",s=>s.where("email","==",r)).get().toPromise();i?(i.forEach(s=>s.ref.delete()),console.log(`User with email ${r} deleted successfully`)):console.error("Error: Snapshot is undefined.")}catch(i){console.error("Error deleting user:",i)}})}isLoggedIn(){return this.afAuth.authState.pipe(V(r=>!!r))}getAlluser(){return this.afs.collection("AdminUser").get().pipe(V(r=>r.docs.map(i=>i.data().email)))}createCollection(r){return y(this,null,function*(){try{return yield this.afs.collection(r).doc("placeholder").set({created_at:new Date}),r}catch(i){throw i}})}};e.\u0275fac=function(i){return new(i||e)(w(Dd),w(ci),w(qe))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var CF=(()=>{let e=class e{constructor(r,i){this.authService=r,this.r=i}ngOnInit(){}navigatetosignup(){this.r.navigate(["/sign-up"])}ntofpage(){this.r.navigate(["/forget-password"])}};e.\u0275fac=function(i){return new(i||e)(K(Un),K(qe))},e.\u0275cmp=Nt({type:e,selectors:[["app-sign-in"]],decls:41,vars:0,consts:[[1,"font-mono"],[1,"flex","h-screen"],["src","assets/naruto1.jpg",1,"w-1/2","hidden","lg:block"],[1,"flex","flex-col","justify-center","items-center","w-full","lg:w-1/2"],[1,"text-xl","text-center","font-bold","lg:text-left"],[1,"text-green-600"],[1,"text-3xl","text-center","font-bold","lg:text-left"],[1,"mt-8","w-[80%]","lg:w-96","mx-auto","space-y-4"],["type","email","placeholder","Enter Your Email",1,"border","w-full","px-4","py-2"],["email",""],["type","password","placeholder","Enter Your Password",1,"border","w-full","px-4","py-2","mt-5"],["password",""],[1,"text-blue-500","cursor-pointer","hover:text-blue-700"],["routerLink","/forgot-password",3,"click"],[1,"w-full","bg-green-400","text-white","font-bold","hover:bg-green-600","py-2","rounded",3,"click"],[1,"text-center","space-y-4","mt-4"],[1,"flex","justify-center","items-center","gap-8"],[1,"fa-brands","fa-google","text-3xl","cursor-pointer","opacity-30","hover:opacity-100",3,"click"],[1,"fa-brands","fa-facebook","text-3xl","cursor-pointer"],[1,"fa-brands","fa-instagram","text-3xl","cursor-pointer"],[1,"mt-4","text-sm","text-center","cursor-pointer"],[1,"text-blue-600","cursor-pointer","hover:text-blue-400",3,"click"]],template:function(i,s){if(i&1){let o=Zn();M(0,"title"),j(1,"Login"),O(),M(2,"div",0)(3,"div",1),$e(4,"img",2),M(5,"div",3)(6,"div")(7,"div",4)(8,"span",5),j(9,"\u25B2"),O(),M(10,"span"),j(11," AngularJS!!!"),O()(),M(12,"div",6)(13,"h2"),j(14,"Hello,"),O(),M(15,"h2"),j(16,"Welcome BAck"),O()(),M(17,"div",7)(18,"h4"),j(19,"Login to Manage your account."),O(),$e(20,"input",8,9)(22,"input",10,11),M(24,"div",12)(25,"span",13),we("click",function(){return s.ntofpage()}),j(26,"Forgot Your Password"),O()(),M(27,"button",14),we("click",function(){xn(o);let c=Li(21),u=Li(23);return Mn(s.authService.SignIn(c.value,u.value))}),j(28,"Login"),O()()(),M(29,"div",15)(30,"span"),j(31,"OR"),O(),M(32,"div",16)(33,"i",17),we("click",function(){return s.authService.SignUpWithGoogle()}),O(),$e(34,"i",18)(35,"i",19),O()(),M(36,"div",20)(37,"span"),j(38," Don't have account ? "),M(39,"a",21),we("click",function(){return s.navigatetosignup()}),j(40," Sign up here "),O()()()()()()}}});let t=e;return t})();var bF=(()=>{let e=class e{constructor(r,i){this.authService=r,this.router=i}ngOnInit(){this.authService.isLoggedIn()||this.router.navigate(["/login"])}ntologin(){this.router.navigate(["/login"])}ntofpage(){this.router.navigate(["/forget-password"])}sup(r,i){return y(this,null,function*(){yield this.authService.SignUp(r,i)})}};e.\u0275fac=function(i){return new(i||e)(K(Un),K(qe))},e.\u0275cmp=Nt({type:e,selectors:[["app-sign-up"]],decls:37,vars:0,consts:[[1,"font-mono"],[1,"flex","h-screen"],["src","assets/n3.jpg",1,"w-1/2","hidden","lg:block"],[1,"flex","flex-col","justify-center","items-center","w-full","lg:w-1/2"],[1,"text-xl","text-center","font-bold","lg:text-left"],[1,"text-red-600"],[1,"text-3xl","text-center","font-bold","lg:text-left"],[1,"mt-8","w-[80%]","lg:w-96","mx-auto","space-y-4"],["autocomplete","off","name","email","type","email","placeholder","Enter Your Email",1,"border","w-full","px-4","py-2"],["email",""],["autocomplete","off","name","password","type","password","placeholder","Enter Your Password",1,"border","w-full","px-4","py-2","mt-5"],["password",""],[1,"text-blue-500","cursor-pointer","hover:text-blue-700","hover:border-black",3,"click"],["type","submit",1,"w-full","border","bg-red-500","text-black","font-bold","hover:bg-red-600","py-2","rounded",3,"click"],[1,"text-center","space-y-4","mt-4"],[1,"flex","justify-center","items-center","gap-8"],[1,"fa-brands","fa-google","text-3xl","cursor-pointer","opacity-30","hover:opacity-100",3,"click"],[1,"fa-brands","fa-facebook","text-3xl","cursor-pointer"],[1,"fa-brands","fa-instagram","text-3xl","cursor-pointer"],[1,"mt-4","text-sm","text-center"],[1,"text-blue-600","cursor-pointer","hover:text-blue-400",3,"click"]],template:function(i,s){if(i&1){let o=Zn();M(0,"div",0)(1,"div",1),$e(2,"img",2),M(3,"div",3)(4,"div")(5,"div",4)(6,"span",5),j(7,"\u25B2"),O(),M(8,"span"),j(9," AngularJS!!!"),O()(),M(10,"div",6)(11,"h2"),j(12,"Hello,"),O(),M(13,"h2"),j(14,"Welcome BAck"),O()(),M(15,"div",7)(16,"h4"),j(17,"Signup to create your account."),O(),$e(18,"input",8,9)(20,"input",10,11),M(22,"div",12),we("click",function(){return s.ntofpage()}),j(23,"Forgot Your Password"),O(),M(24,"button",13),we("click",function(){xn(o);let c=Li(19),u=Li(21);return Mn(s.sup(c.value,u.value))}),j(25,"Sign Up"),O()()(),M(26,"div",14)(27,"span"),j(28,"OR"),O(),M(29,"div",15)(30,"i",16),we("click",function(){return s.authService.SignUpWithGoogle()}),O(),$e(31,"i",17)(32,"i",18),O()(),M(33,"div",19),j(34," Already have account ? "),M(35,"a",20),we("click",function(){return s.ntologin()}),j(36," Sign In "),O()()()()()}}});let t=e;return t})();var NF=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(K(wa),K(Ls))},e.\u0275dir=$t({type:e});let t=e;return t})(),kF=(()=>{let e=class e extends NF{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=_a(e)))(s||e)}})(),e.\u0275dir=$t({type:e,features:[ti]});let t=e;return t})(),gb=new x("");var J9={provide:gb,useExisting:Vs(()=>Om),multi:!0};function e5(){let t=wr()?wr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var t5=new x(""),Om=(()=>{let e=class e extends NF{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!e5())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(K(wa),K(Ls),K(t5,8))},e.\u0275dir=$t({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&we("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[ku([J9]),ti]});let t=e;return t})();function hs(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function OF(t){return t!=null&&typeof t.length=="number"}var FF=new x(""),LF=new x(""),n5=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,xc=class{static min(e){return r5(e)}static max(e){return i5(e)}static required(e){return s5(e)}static requiredTrue(e){return o5(e)}static email(e){return a5(e)}static minLength(e){return c5(e)}static maxLength(e){return u5(e)}static pattern(e){return l5(e)}static nullValidator(e){return VF(e)}static compose(e){return HF(e)}static composeAsync(e){return zF(e)}};function r5(t){return e=>{if(hs(e.value)||hs(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}function i5(t){return e=>{if(hs(e.value)||hs(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}function s5(t){return hs(t.value)?{required:!0}:null}function o5(t){return t.value===!0?null:{required:!0}}function a5(t){return hs(t.value)||n5.test(t.value)?null:{email:!0}}function c5(t){return e=>hs(e.value)||!OF(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function u5(t){return e=>OF(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function l5(t){if(!t)return VF;let e,n;return typeof t=="string"?(n="",t.charAt(0)!=="^"&&(n+="^"),n+=t,t.charAt(t.length-1)!=="$"&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),r=>{if(hs(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:n,actualValue:i}}}}function VF(t){return null}function jF(t){return t!=null}function UF(t){return qs(t)?oe(t):t}function BF(t){let e={};return t.forEach(n=>{e=n!=null?A(A({},e),n):e}),Object.keys(e).length===0?null:e}function $F(t,e){return e.map(n=>n(t))}function d5(t){return!t.validate}function qF(t){return t.map(e=>d5(e)?e:n=>e.validate(n))}function HF(t){if(!t)return null;let e=t.filter(jF);return e.length==0?null:function(n){return BF($F(n,e))}}function GF(t){return t!=null?HF(qF(t)):null}function zF(t){if(!t)return null;let e=t.filter(jF);return e.length==0?null:function(n){let r=$F(n,e).map(UF);return l_(r).pipe(V(BF))}}function WF(t){return t!=null?zF(qF(t)):null}function DF(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function KF(t){return t._rawValidators}function QF(t){return t._rawAsyncValidators}function hb(t){return t?Array.isArray(t)?t:[t]:[]}function xm(t,e){return Array.isArray(t)?t.includes(e):t===e}function TF(t,e){let n=hb(e);return hb(t).forEach(i=>{xm(n,i)||n.push(i)}),n}function SF(t,e){return hb(e).filter(n=>!xm(t,n))}var Mm=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=GF(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=WF(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Mc=class extends Mm{get formDirective(){return null}get path(){return null}},Ad=class extends Mm{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Rm=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},h5={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Oce=ye(A({},h5),{"[class.ng-submitted]":"isSubmitted"}),YF=(()=>{let e=class e extends Rm{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(K(Ad,2))},e.\u0275dir=$t({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Wf("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[ti]});let t=e;return t})(),XF=(()=>{let e=class e extends Rm{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(K(Mc,10))},e.\u0275dir=$t({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&Wf("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[ti]});let t=e;return t})();var Td="VALID",Sm="INVALID",Ac="PENDING",Sd="DISABLED";function mb(t){return(Fm(t)?t.validators:t)||null}function f5(t){return Array.isArray(t)?GF(t):t||null}function yb(t,e){return(Fm(e)?e.asyncValidators:t)||null}function p5(t){return Array.isArray(t)?WF(t):t||null}function Fm(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function ZF(t,e,n){let r=t.controls;if(!(e?Object.keys(r):r).length)throw new B(1e3,"");if(!r[n])throw new B(1001,"")}function JF(t,e,n){t._forEachChild((r,i)=>{if(n[i]===void 0)throw new B(1002,"")})}var Rc=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Td}get invalid(){return this.status===Sm}get pending(){return this.status==Ac}get disabled(){return this.status===Sd}get enabled(){return this.status!==Sd}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(TF(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(TF(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(SF(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(SF(e,this._rawAsyncValidators))}hasValidator(e){return xm(this._rawValidators,e)}hasAsyncValidator(e){return xm(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Ac,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Sd,this.errors=null,this._forEachChild(r=>{r.disable(ye(A({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ye(A({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Td,this._forEachChild(r=>{r.enable(ye(A({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ye(A({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Td||this.status===Ac)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Sd:Td}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Ac,this._hasOwnPendingAsyncValidator=!0;let n=UF(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new it,this.statusChanges=new it}_calculateStatus(){return this._allControlsDisabled()?Sd:this.errors?Sm:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ac)?Ac:this._anyControlsHaveStatus(Sm)?Sm:Td}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Fm(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=f5(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=p5(this._rawAsyncValidators)}},Pm=class extends Rc{constructor(e,n,r){super(mb(n),yb(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){JF(this,!0,e),Object.keys(e).forEach(r=>{ZF(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>r._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,s)=>{r=n(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var fb=class extends Pm{};var _b=new x("CallSetDisabledState",{providedIn:"root",factory:()=>Lm}),Lm="always";function g5(t,e){return[...e.path,t]}function AF(t,e,n=Lm){vb(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),y5(t,e),v5(t,e),_5(t,e),m5(t,e)}function xF(t,e,n=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),km(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function Nm(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function m5(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function vb(t,e){let n=KF(t);e.validator!==null?t.setValidators(DF(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=QF(t);e.asyncValidator!==null?t.setAsyncValidators(DF(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();Nm(e._rawValidators,i),Nm(e._rawAsyncValidators,i)}function km(t,e){let n=!1;if(t!==null){if(e.validator!==null){let i=KF(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(n=!0,t.setValidators(s))}}if(e.asyncValidator!==null){let i=QF(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(n=!0,t.setAsyncValidators(s))}}}let r=()=>{};return Nm(e._rawValidators,r),Nm(e._rawAsyncValidators,r),n}function y5(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&eL(t,e)})}function _5(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&eL(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function eL(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function v5(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function w5(t,e){t==null,vb(t,e)}function E5(t,e){return km(t,e)}function I5(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function C5(t){return Object.getPrototypeOf(t.constructor)===kF}function b5(t,e){t._syncPendingControls(),e.forEach(n=>{let r=n.control;r.updateOn==="submit"&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function D5(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===Om?n=s:C5(s)?r=s:i=s}),i||r||n||null}function T5(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function MF(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function RF(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var Am=class extends Rc{constructor(e=null,n,r){super(mb(n),yb(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Fm(n)&&(n.nonNullable||n.initialValueIsDefault)&&(RF(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){MF(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){MF(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){RF(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var S5=t=>t instanceof Am;var tL=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=$t({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})(),A5={provide:gb,useExisting:Vs(()=>wb),multi:!0},wb=(()=>{let e=class e extends kF{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=_a(e)))(s||e)}})(),e.\u0275dir=$t({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&we("input",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},features:[ku([A5]),ti]});let t=e;return t})();var nL=new x("");var x5={provide:Mc,useExisting:Vs(()=>Eb)},Eb=(()=>{let e=class e extends Mc{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new it,this._setValidators(r),this._setAsyncValidators(i)}ngOnChanges(r){this._checkFormPresent(),r.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(km(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(r){let i=this.form.get(r.path);return AF(i,r,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(r),i}getControl(r){return this.form.get(r.path)}removeControl(r){xF(r.control||null,r,!1),T5(this.directives,r)}addFormGroup(r){this._setUpFormContainer(r)}removeFormGroup(r){this._cleanUpFormContainer(r)}getFormGroup(r){return this.form.get(r.path)}addFormArray(r){this._setUpFormContainer(r)}removeFormArray(r){this._cleanUpFormContainer(r)}getFormArray(r){return this.form.get(r.path)}updateModel(r,i){this.form.get(r.path).setValue(i)}onSubmit(r){return this.submitted=!0,b5(this.form,this.directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_updateDomValue(){this.directives.forEach(r=>{let i=r.control,s=this.form.get(r.path);i!==s&&(xF(i||null,r),S5(s)&&(AF(s,r,this.callSetDisabledState),r.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(r){let i=this.form.get(r.path);w5(i,r),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(r){if(this.form){let i=this.form.get(r.path);i&&E5(i,r)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){vb(this.form,this),this._oldForm&&km(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(K(FF,10),K(LF,10),K(_b,8))},e.\u0275dir=$t({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,s){i&1&&we("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{form:[dn.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ku([x5]),ti,Us]});let t=e;return t})();var M5={provide:Ad,useExisting:Vs(()=>Ib)},Ib=(()=>{let e=class e extends Ad{set isDisabled(r){}constructor(r,i,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new it,this._ngModelWarningSent=!1,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=D5(this,o)}ngOnChanges(r){this._added||this._setUpControl(),I5(r,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}get path(){return g5(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(K(Mc,13),K(FF,10),K(LF,10),K(gb,10),K(nL,8))},e.\u0275dir=$t({type:e,selectors:[["","formControlName",""]],inputs:{name:[dn.None,"formControlName","name"],isDisabled:[dn.None,"disabled","isDisabled"],model:[dn.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[ku([M5]),ti,Us]});let t=e;return t})();var rL=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Me({type:e}),e.\u0275inj=Re({});let t=e;return t})(),pb=class extends Rc{constructor(e,n,r){super(mb(n),yb(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,n={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(e,n,r={}){this.controls.splice(e,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,n={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(e,n,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),n&&(this.controls.splice(i,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,n={}){JF(this,!1,e),e.forEach((r,i)=>{ZF(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e=[],n={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((n,r)=>r._syncPendingControls()?!0:n,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((n,r)=>{e(n,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(n=>n.enabled&&e(n))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function PF(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var iL=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let r=new e;return r.useNonNullable=!0,r}group(r,i=null){let s=this._reduceControls(r),o={};return PF(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new Pm(s,o)}record(r,i=null){let s=this._reduceControls(r);return new fb(s,i)}control(r,i,s){let o={};return this.useNonNullable?(PF(i)?o=i:(o.validators=i,o.asyncValidators=s),new Am(r,ye(A({},o),{nonNullable:!0}))):new Am(r,i,s)}array(r,i,s){let o=r.map(a=>this._createControl(a));return new pb(o,i,s)}_reduceControls(r){let i={};return Object.keys(r).forEach(s=>{i[s]=this._createControl(r[s])}),i}_createControl(r){if(r instanceof Am)return r;if(r instanceof Rc)return r;if(Array.isArray(r)){let i=r[0],s=r.length>1?r[1]:null,o=r.length>2?r[2]:null;return this.control(i,s,o)}else return this.control(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var sL=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:_b,useValue:r.callSetDisabledState??Lm}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Me({type:e}),e.\u0275inj=Re({imports:[rL]});let t=e;return t})(),oL=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:nL,useValue:r.warnOnNgModelWithFormControl??"always"},{provide:_b,useValue:r.callSetDisabledState??Lm}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Me({type:e}),e.\u0275inj=Re({imports:[rL]});let t=e;return t})();var aL=(()=>{let e=class e{constructor(r){this.afs=r}addDocument(r,i){return this.afs.collection(r).add(i)}deleteDecument(r,i){return this.afs.collection(r).doc(i).delete()}updateDocument(r,i,s){return this.afs.collection(r).doc(i).update(s)}getAlldocument(r){return this.afs.collection(r).snapshotChanges()}};e.\u0275fac=function(i){return new(i||e)(w(Dd))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function N5(t,e){if(t&1){let n=Zn();M(0,"div",15)(1,"div",16)(2,"form",17)(3,"div",18),$e(4,"input",19),M(5,"label",20),j(6,"Task Name"),O()(),M(7,"div",18),$e(8,"input",21),M(9,"label",22),j(10,"Description"),O()(),M(11,"div",18),$e(12,"input",23),M(13,"label",24),j(14,"Duration"),O()(),M(15,"button",25),we("click",function(){xn(n);let i=$s();return Mn(i.addStudent())}),j(16,"Add Student"),O(),M(17,"button",26),we("click",function(){xn(n);let i=$s();return Mn(i.toggleform())}),$e(18,"i",27),O()()()()}if(t&2){let n=$s();pn(2),Fi("formGroup",n.studentForm)}}function k5(t,e){if(t&1){let n=Zn();M(0,"tr",11)(1,"td",28),j(2),O(),M(3,"td",29),j(4),O(),M(5,"td",29),j(6),O(),M(7,"td",29),j(8),O(),M(9,"td",30)(10,"button",31),we("click",function(){let s=xn(n).$implicit,o=$s();return Mn(o.deleteStudent(s))}),j(11,"Delete"),O()()()}if(t&2){let n=e.$implicit,r=e.index;pn(2),ni(r+1),pn(2),ni(n.name),pn(2),ni(n.desc),pn(2),ni(n.mobile)}}function O5(t,e){t&1&&(M(0,"tr")(1,"td",32),j(2,"No todos found."),O()())}var cL=(()=>{let e=class e{constructor(r,i,s,o){this.authService=r,this.r=i,this.ds=s,this.fb=o,this.studentList=[]}ngOnInit(){this.userCollectionName=this.authService.userCollectionName,this.studentForm=this.fb.group({task:["",xc.required],desc:["",xc.required],mobile:["",xc.required]}),this.userCollectionName?this.getAllStudents():console.error("User collection name not found."),this.authService.isLoggedIn()||this.r.navigate(["/login"])}resetForm(){this.studentForm.reset(),this.studentForm.markAsPristine(),this.studentForm.markAsUntouched()}getAllStudents(){this.ds.getAlldocument(this.userCollectionName).subscribe(r=>{this.studentList=r.map(i=>{let s=i.payload.doc.data(),o=i.payload.doc.id;return A({id:o},s)}).filter(i=>!!i)},r=>{console.error("Error while fetching data: ",r)})}addStudent(){if(this.studentForm.invalid){alert("Please fill all the fields correctly");return}let r={name:this.studentForm.get("task").value,desc:this.studentForm.get("desc").value,mobile:this.studentForm.get("mobile").value};this.ds.addDocument(this.userCollectionName,r).then(i=>{console.log("Document written with ID: ",i.id),this.resetForm()}).catch(i=>{console.error("Error adding student: ",i),alert("Error adding student. Please try again.")})}deleteStudent(r){if(!r.id){console.error("Invalid student ID");return}window.confirm("Are you sure you want to delete "+r.name)&&this.ds.deleteDecument(this.userCollectionName,r.id)}toggleform(){this.formvisible=!this.formvisible,this.resetForm()}};e.\u0275fac=function(i){return new(i||e)(K(Un),K(qe),K(aL),K(iL))},e.\u0275cmp=Nt({type:e,selectors:[["app-dashboard"]],decls:28,vars:3,consts:[[1,"bg-green-300","w-screen","flex","justify-between","items-center","py-4","px-3"],[1,"text-center","text-3xl"],[1,"flex","items-center"],[1,"bg-blue-400","px-4","py-2","border","rounded","hover:bg-blue-600","hover:border-black",3,"click"],[1,"bg-red-400","px-4","py-2","border","rounded","hover:bg-red-600","hover:border-black","ml-4",3,"click"],[1,"fas","fa-sign-out-alt"],[1,"container","mx-auto","my-8","relative"],["class","form-container absolute top-0 left-0 right-0 flex justify-center items-center bg-transparent z-10",4,"ngIf"],[1,"table-container","relative"],[1,"w-full","border-collapse","border","border-black","bg-white","p-8","rounded-lg","shadow-lg"],[1,"bg-gray-100"],[1,"border-b","border-black"],[1,"px-6","py-3","border-b","border-black","text-center"],["class","border-b border-black",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"form-container","absolute","top-0","left-0","right-0","flex","justify-center","items-center","bg-transparent","z-10"],[1,"bg-gray-100","p-8","rounded-lg","shadow-lg"],[1,"card","border-0","shadow","p-3",3,"formGroup"],[1,"mb-3"],["type","text","id","task","placeholder","","formControlName","task",1,"form-control"],["for","task"],["type","text","id","desc","placeholder","name@example.com","formControlName","desc",1,"form-control"],["for","desc"],["type","number","id","mobile","placeholder","Mobile no","formControlName","mobile",1,"form-control"],["for","mobile"],["type","button",1,"btn","btn-outline-success",3,"click"],["type","button",1,"absolute","top-0","right-0","m-2",3,"click"],[1,"fas","fa-times","text-gray-500"],[1,"px-6","py-4","whitespace-nowrap","border-r","border-black","text-center"],[1,"px-6","py-4","whitespace-nowrap","border-r","border-black"],[1,"px-6","py-4","whitespace-nowrap","text-center"],[1,"bg-red-400","hover:bg-red-700","rounded","p-2",3,"click"],["colspan","5",1,"px-6","py-4","whitespace-nowrap","text-center"]],template:function(i,s){i&1&&(M(0,"nav",0)(1,"h1",1),j(2,"Todo List"),O(),M(3,"div",2)(4,"button",3),we("click",function(){return s.toggleform()}),j(5,"Add Todo"),O(),M(6,"button",4),we("click",function(){return s.authService.SignOut()}),$e(7,"i",5),j(8," Log out "),O()()(),M(9,"div",6),Ca(10,N5,19,1,"div",7),O(),M(11,"div",8)(12,"table",9)(13,"thead",10)(14,"tr",11)(15,"th",12),j(16,"Index"),O(),M(17,"th",12),j(18,"Todo"),O(),M(19,"th",12),j(20,"Description"),O(),M(21,"th",12),j(22,"Mobile"),O(),M(23,"th",12),j(24,"Action"),O()()(),M(25,"tbody"),Ca(26,k5,12,4,"tr",13)(27,O5,3,0,"tr",14),O()()()),i&2&&(pn(10),Fi("ngIf",s.formvisible),pn(16),Fi("ngForOf",s.studentList),pn(),Fi("ngIf",s.studentList.length===0))},dependencies:[tp,QM,tL,Om,wb,YF,XF,Eb,Ib],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin:auto}"]});let t=e;return t})();var uL=(()=>{let e=class e{constructor(r,i){this.authService=r,this.r=i}ngOnInit(){}ntologin(){this.r.navigate(["/login"])}};e.\u0275fac=function(i){return new(i||e)(K(Un),K(qe))},e.\u0275cmp=Nt({type:e,selectors:[["app-forgot-password"]],decls:16,vars:0,consts:[[1,"flex","justify-center","items-center","h-screen"],[1,"authBlock","max-w-xs","p-4","border","rounded","container","bg-green-300"],[1,"text-lg","font-semibold"],[1,"text-center","text-sm","mb-4"],[1,"formGroup","mb-4"],["type","email","placeholder","Email Address","required","",1,"border","w-full","px-4","py-2"],["passwordResetEmail",""],[1,"formGroup"],["type","submit","value","Reset Password",1,"btn","btnPrimary","w-full","bg-green-400","px-4","py-2","border-black","hover:bg-green-600",3,"click"],[1,"ml-4","text-sm"],[1,"text-black"],[1,"text-blue-500","cursor-pointer",3,"click"]],template:function(i,s){if(i&1){let o=Zn();M(0,"div",0)(1,"div",1)(2,"h3",2),j(3,"Reset Password"),O(),M(4,"p",3),j(5,"Please enter your email address to request a password reset."),O(),M(6,"div",4),$e(7,"input",5,6),O(),M(9,"div",7)(10,"input",8),we("click",function(){xn(o);let c=Li(8);return Mn(s.authService.ForgotPassword(c.value))}),O()(),M(11,"div",9)(12,"span",10),j(13,"Go back to "),M(14,"span",11),we("click",function(){return s.ntologin()}),j(15,"Log In"),O()()()()()}}});let t=e;return t})();var lL=(()=>{let e=class e{constructor(r,i){this.authService=r,this.router=i}ngOnInit(){}navigateToLogin(){this.router.navigate(["/login"])}};e.\u0275fac=function(i){return new(i||e)(K(Un),K(qe))},e.\u0275cmp=Nt({type:e,selectors:[["app-verify-email"]],decls:14,vars:0,consts:[[1,"font-mono"],[1,"flex","h-screen","w-screen","justify-center","items-center"],[1,"authBlock","max-w-3xl","p-4","px-7","border","rounded","container","bg-green-300"],[1,"text-3xl","font-bold","mb-4"],[1,"mb-4"],["type","button",1,"btn","btnPrimary",3,"click"],[1,"fas","fa-redo-alt"],[1,"border","border-black","px-4","py-2","rounded","text-black","font-bold","bg-green-400","hover:bg-green-600",3,"click"]],template:function(i,s){i&1&&(M(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),j(4,"Thank You for Registering"),O(),M(5,"h2",3),j(6,"Verification Email Sent"),O(),M(7,"p",4),j(8,"A verification email has been sent to your email address."),O(),M(9,"button",5),we("click",function(){return s.authService.SendVerificationMail()}),$e(10,"i",6),j(11," Resend Verification Email "),O(),M(12,"button",7),we("click",function(){return s.navigateToLogin()}),j(13,"Close"),O()()()())}});let t=e;return t})();function F5(t,e){if(t&1){let n=Zn();M(0,"tr",8)(1,"td",9),j(2),O(),M(3,"td",9),j(4),O(),M(5,"td",9)(6,"button",10),we("click",function(){let s=xn(n).$implicit,o=$s();return Mn(o.deleteUser(s))}),j(7,"Delete"),O()()()}if(t&2){let n=e.$implicit,r=e.index;pn(2),ni(r+1),pn(2),ni(n)}}var dL=(()=>{let e=class e{constructor(r,i){this.aservice=r,this.r=i,this.userEmails=[]}ngOnInit(){this.getuseremails(),this.aservice.isLoggedIn()||this.r.navigate(["/login"])}getuseremails(){this.aservice.getAlluser().subscribe(r=>{this.userEmails=r})}deleteUser(r){this.aservice.deleteByEmail(r).then(()=>{this.getuseremails()})}};e.\u0275fac=function(i){return new(i||e)(K(Un),K(qe))},e.\u0275cmp=Nt({type:e,selectors:[["app-admin-dashboard"]],decls:17,vars:1,consts:[[1,"font-mono"],[1,"text-3xl","font-bold","text-center","bg","bg-red-300"],[1,"overflow-x-auto"],[1,"w-full","bg-white","shadow-md","rounded"],[1,"bg-green-600","text-white"],[1,"px-6","py-3","border","border-black","text-left","font-semibold","uppercase"],["class","bg-green-100",4,"ngFor","ngForOf"],[1,"block","mx-auto","mt-8","bg-red-500","hover:bg-red-700","text-white","font-bold","py-2","px-4","rounded","focus:outline-none","focus:shadow-outline",3,"click"],[1,"bg-green-100"],[1,"px-6","py-4","border","border-black"],[1,"bg-green-500","hover:bg-green-700","text-white","font-bold","py-2","px-4","rounded","focus:outline-none","focus:shadow-outline",3,"click"]],template:function(i,s){i&1&&(M(0,"div",0)(1,"h1",1),j(2,"Admin Dashboard (User Lists)"),O(),M(3,"div",2)(4,"table",3)(5,"thead")(6,"tr",4)(7,"th",5),j(8,"Index"),O(),M(9,"th",5),j(10,"Emails"),O(),M(11,"th",5),j(12,"Action"),O()()(),M(13,"tbody"),Ca(14,F5,8,2,"tr",6),O()()(),M(15,"button",7),we("click",function(){return s.aservice.SignOut()}),j(16,"Log Out"),O()()),i&2&&(pn(14),Fi("ngForOf",s.userEmails))},dependencies:[tp]});let t=e;return t})();var Vm=(()=>{let e=class e{constructor(r,i){this.afAuth=r,this.router=i}canActivate(){return this.afAuth.authState.pipe(zn(1),V(r=>r?!0:(this.router.navigate(["/login"]),!1)))}};e.\u0275fac=function(i){return new(i||e)(w(ci),w(qe))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var L5=[{path:"",redirectTo:"/sign-up",pathMatch:"full"},{path:"sign-up",component:bF},{path:"login",component:CF},{path:"forget-password",component:uL},{path:"verify-email",component:lL},{path:"dashboard",component:cL,canActivate:[Vm]},{path:"admin-dashboard",component:dL,canActivate:[Vm]}],hL=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Me({type:e}),e.\u0275inj=Re({providers:[Vm],imports:[pE.forRoot(L5,{enableTracing:!1}),pE]});let t=e;return t})();var fL=(()=>{let e=class e{constructor(){this.title="aFirebase"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Nt({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(i,s){i&1&&$e(0,"router-outlet")},dependencies:[aE],styles:['*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:before, [_ngcontent-%COMP%]:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}[_ngcontent-%COMP%]:before, [_ngcontent-%COMP%]:after{--tw-content: ""}html[_ngcontent-%COMP%], [_nghost-%COMP%]{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body[_ngcontent-%COMP%]{margin:0;line-height:inherit}hr[_ngcontent-%COMP%]{height:0;color:inherit;border-top-width:1px}abbr[_ngcontent-%COMP%]:where([title]){text-decoration:underline dotted}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{font-size:inherit;font-weight:inherit}a[_ngcontent-%COMP%]{color:inherit;text-decoration:inherit}b[_ngcontent-%COMP%], strong[_ngcontent-%COMP%]{font-weight:bolder}code[_ngcontent-%COMP%], kbd[_ngcontent-%COMP%], samp[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small[_ngcontent-%COMP%]{font-size:80%}sub[_ngcontent-%COMP%], sup[_ngcontent-%COMP%]{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub[_ngcontent-%COMP%]{bottom:-.25em}sup[_ngcontent-%COMP%]{top:-.5em}table[_ngcontent-%COMP%]{text-indent:0;border-color:inherit;border-collapse:collapse}button[_ngcontent-%COMP%], input[_ngcontent-%COMP%], optgroup[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{text-transform:none}button[_ngcontent-%COMP%], [type=button][_ngcontent-%COMP%], [type=reset][_ngcontent-%COMP%], [type=submit][_ngcontent-%COMP%]{-webkit-appearance:button;background-color:transparent;background-image:none}[_ngcontent-%COMP%]:-moz-focusring{outline:auto}[_ngcontent-%COMP%]:-moz-ui-invalid{box-shadow:none}progress[_ngcontent-%COMP%]{vertical-align:baseline}[_ngcontent-%COMP%]::-webkit-inner-spin-button, [_ngcontent-%COMP%]::-webkit-outer-spin-button{height:auto}[type=search][_ngcontent-%COMP%]{-webkit-appearance:textfield;outline-offset:-2px}[_ngcontent-%COMP%]::-webkit-search-decoration{-webkit-appearance:none}[_ngcontent-%COMP%]::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary[_ngcontent-%COMP%]{display:list-item}blockquote[_ngcontent-%COMP%], dl[_ngcontent-%COMP%], dd[_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%], hr[_ngcontent-%COMP%], figure[_ngcontent-%COMP%], p[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{margin:0}fieldset[_ngcontent-%COMP%]{margin:0;padding:0}legend[_ngcontent-%COMP%]{padding:0}ol[_ngcontent-%COMP%], ul[_ngcontent-%COMP%], menu[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}dialog[_ngcontent-%COMP%]{padding:0}textarea[_ngcontent-%COMP%]{resize:vertical}input[_ngcontent-%COMP%]::placeholder, textarea[_ngcontent-%COMP%]::placeholder{opacity:1;color:#9ca3af}button[_ngcontent-%COMP%], [role=button][_ngcontent-%COMP%]{cursor:pointer}[_ngcontent-%COMP%]:disabled{cursor:default}img[_ngcontent-%COMP%], svg[_ngcontent-%COMP%], video[_ngcontent-%COMP%], canvas[_ngcontent-%COMP%], audio[_ngcontent-%COMP%], iframe[_ngcontent-%COMP%], embed[_ngcontent-%COMP%], object[_ngcontent-%COMP%]{display:block;vertical-align:middle}img[_ngcontent-%COMP%], video[_ngcontent-%COMP%]{max-width:100%;height:auto}[hidden][_ngcontent-%COMP%]{display:none}*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:before, [_ngcontent-%COMP%]:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }[_ngcontent-%COMP%]::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.container[_ngcontent-%COMP%]{width:100%}@media (min-width: 640px){.container[_ngcontent-%COMP%]{max-width:640px}}@media (min-width: 768px){.container[_ngcontent-%COMP%]{max-width:768px}}@media (min-width: 1024px){.container[_ngcontent-%COMP%]{max-width:1024px}}@media (min-width: 1280px){.container[_ngcontent-%COMP%]{max-width:1280px}}@media (min-width: 1536px){.container[_ngcontent-%COMP%]{max-width:1536px}}.absolute[_ngcontent-%COMP%]{position:absolute}.relative[_ngcontent-%COMP%]{position:relative}.left-0[_ngcontent-%COMP%]{left:0}.right-0[_ngcontent-%COMP%]{right:0}.top-0[_ngcontent-%COMP%]{top:0}.z-10[_ngcontent-%COMP%]{z-index:10}.m-2[_ngcontent-%COMP%]{margin:.5rem}.mx-auto[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto}.my-8[_ngcontent-%COMP%]{margin-top:2rem;margin-bottom:2rem}.mb-3[_ngcontent-%COMP%]{margin-bottom:.75rem}.mb-4[_ngcontent-%COMP%]{margin-bottom:1rem}.ml-4[_ngcontent-%COMP%]{margin-left:1rem}.mt-4[_ngcontent-%COMP%]{margin-top:1rem}.mt-5[_ngcontent-%COMP%]{margin-top:1.25rem}.mt-8[_ngcontent-%COMP%]{margin-top:2rem}.block[_ngcontent-%COMP%]{display:block}.flex[_ngcontent-%COMP%]{display:flex}.table[_ngcontent-%COMP%]{display:table}.hidden[_ngcontent-%COMP%]{display:none}.h-screen[_ngcontent-%COMP%]{height:100vh}.w-1\\/2[_ngcontent-%COMP%]{width:50%}.w-\\__ph-0__[_ngcontent-%COMP%]{width:80%}.w-full[_ngcontent-%COMP%]{width:100%}.w-screen[_ngcontent-%COMP%]{width:100vw}.max-w-3xl[_ngcontent-%COMP%]{max-width:48rem}.max-w-xs[_ngcontent-%COMP%]{max-width:20rem}.border-collapse[_ngcontent-%COMP%]{border-collapse:collapse}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.flex-col[_ngcontent-%COMP%]{flex-direction:column}.items-center[_ngcontent-%COMP%]{align-items:center}.justify-center[_ngcontent-%COMP%]{justify-content:center}.justify-between[_ngcontent-%COMP%]{justify-content:space-between}.gap-8[_ngcontent-%COMP%]{gap:2rem}.space-y-4[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.overflow-x-auto[_ngcontent-%COMP%]{overflow-x:auto}.whitespace-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.rounded[_ngcontent-%COMP%]{border-radius:.25rem}.rounded-lg[_ngcontent-%COMP%]{border-radius:.5rem}.border[_ngcontent-%COMP%]{border-width:1px}.border-0[_ngcontent-%COMP%]{border-width:0px}.border-b[_ngcontent-%COMP%]{border-bottom-width:1px}.border-r[_ngcontent-%COMP%]{border-right-width:1px}.border-black[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(0 0 0 / var(--tw-border-opacity))}.bg-blue-400[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(96 165 250 / var(--tw-bg-opacity))}.bg-gray-100[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity))}.bg-green-100[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity))}.bg-green-300[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(134 239 172 / var(--tw-bg-opacity))}.bg-green-400[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(74 222 128 / var(--tw-bg-opacity))}.bg-green-500[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity))}.bg-green-600[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity))}.bg-orange-400[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(251 146 60 / var(--tw-bg-opacity))}.bg-red-300[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(252 165 165 / var(--tw-bg-opacity))}.bg-red-400[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(248 113 113 / var(--tw-bg-opacity))}.bg-red-500[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity))}.bg-transparent[_ngcontent-%COMP%]{background-color:transparent}.bg-white[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.p-2[_ngcontent-%COMP%]{padding:.5rem}.p-3[_ngcontent-%COMP%]{padding:.75rem}.p-4[_ngcontent-%COMP%]{padding:1rem}.p-8[_ngcontent-%COMP%]{padding:2rem}.px-3[_ngcontent-%COMP%]{padding-left:.75rem;padding-right:.75rem}.px-4[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.px-6[_ngcontent-%COMP%]{padding-left:1.5rem;padding-right:1.5rem}.px-7[_ngcontent-%COMP%]{padding-left:1.75rem;padding-right:1.75rem}.py-2[_ngcontent-%COMP%]{padding-top:.5rem;padding-bottom:.5rem}.py-3[_ngcontent-%COMP%]{padding-top:.75rem;padding-bottom:.75rem}.py-4[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:1rem}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.font-mono[_ngcontent-%COMP%]{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.text-3xl[_ngcontent-%COMP%]{font-size:1.875rem;line-height:2.25rem}.text-lg[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1.75rem}.text-sm[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.text-xl[_ngcontent-%COMP%]{font-size:1.25rem;line-height:1.75rem}.font-bold[_ngcontent-%COMP%]{font-weight:700}.font-semibold[_ngcontent-%COMP%]{font-weight:600}.uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-black[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity))}.text-blue-500[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity))}.text-blue-600[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity))}.text-gray-500[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity))}.text-green-600[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity))}.text-red-600[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity))}.text-white[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.opacity-0[_ngcontent-%COMP%]{opacity:0}.opacity-30[_ngcontent-%COMP%]{opacity:.3}.shadow[_ngcontent-%COMP%]{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg[_ngcontent-%COMP%]{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-md[_ngcontent-%COMP%]{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.filter[_ngcontent-%COMP%]{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.hover\\:border-black[_ngcontent-%COMP%]:hover{--tw-border-opacity: 1;border-color:rgb(0 0 0 / var(--tw-border-opacity))}.hover\\:bg-blue-600[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity))}.hover\\:bg-green-600[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity))}.hover\\:bg-green-700[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(21 128 61 / var(--tw-bg-opacity))}.hover\\:bg-red-600[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity))}.hover\\:bg-red-700[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity))}.hover\\:text-blue-400[_ngcontent-%COMP%]:hover{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity))}.hover\\:text-blue-700[_ngcontent-%COMP%]:hover{--tw-text-opacity: 1;color:rgb(29 78 216 / var(--tw-text-opacity))}.hover\\:opacity-100[_ngcontent-%COMP%]:hover{opacity:1}.hover\\:opacity-30[_ngcontent-%COMP%]:hover{opacity:.3}.focus\\:outline-none[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px}@media (min-width: 1024px){.lg\\:block[_ngcontent-%COMP%]{display:block}.lg\\:w-1\\/2[_ngcontent-%COMP%]{width:50%}.lg\\:w-96[_ngcontent-%COMP%]{width:24rem}.lg\\:text-left[_ngcontent-%COMP%]{text-align:left}}']});let t=e;return t})();var IL="firebasestorage.googleapis.com",CL="storageBucket",V5=2*60*1e3,j5=10*60*1e3,U5=1e3;var Ge=class t extends mh{constructor(e,n,r=0){super(Cb(e),`Firebase Storage: ${n} (${Cb(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Cb(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Ve=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(Ve||{});function Cb(t){return"storage/"+t}function Rb(){let t="An unknown error occurred, please check the error payload for server response.";return new Ge(Ve.UNKNOWN,t)}function B5(t){return new Ge(Ve.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function $5(t){return new Ge(Ve.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function q5(){let t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ge(Ve.UNAUTHENTICATED,t)}function H5(){return new Ge(Ve.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function G5(t){return new Ge(Ve.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function bL(){return new Ge(Ve.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function DL(){return new Ge(Ve.CANCELED,"User canceled the upload/download.")}function z5(t){return new Ge(Ve.INVALID_URL,"Invalid URL '"+t+"'.")}function W5(t){return new Ge(Ve.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function K5(){return new Ge(Ve.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+CL+"' property when initializing the app?")}function TL(){return new Ge(Ve.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Q5(){return new Ge(Ve.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function Y5(){return new Ge(Ve.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function X5(t){return new Ge(Ve.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function To(t){return new Ge(Ve.INVALID_ARGUMENT,t)}function SL(){return new Ge(Ve.APP_DELETED,"The Firebase app was deleted.")}function Pb(t){return new Ge(Ve.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Md(t,e){return new Ge(Ve.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function xd(t){throw new Ge(Ve.INTERNAL_ERROR,"Internal error: "+t)}var Wt=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(r.path==="")return r;throw W5(e)}static makeFromUrl(e,n){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(k){k.path.charAt(k.path.length-1)==="/"&&(k.path_=k.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function u(k){k.path_=decodeURIComponent(k.path)}let l="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",f=new RegExp(`^https?://${d}/${l}/b/${i}/o${h}`,"i"),p={bucket:1,path:3},g=n===IL?"(?:storage.googleapis.com|storage.cloud.google.com)":n,m="([^?#]*)",E=new RegExp(`^https?://${g}/${i}/${m}`,"i"),b=[{regex:a,indices:c,postModify:s},{regex:f,indices:p,postModify:u},{regex:E,indices:{bucket:1,path:2},postModify:u}];for(let k=0;k<b.length;k++){let q=b[k],G=q.regex.exec(e);if(G){let Ee=G[q.indices.bucket],gt=G[q.indices.path];gt||(gt=""),r=new t(Ee,gt),q.postModify(r);break}}if(r==null)throw z5(e);return r}},Db=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function Z5(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let u=!1;function l(...m){u||(u=!0,e.apply(null,m))}function d(m){i=setTimeout(()=>{i=null,t(f,c())},m)}function h(){s&&clearTimeout(s)}function f(m,...E){if(u){h();return}if(m){h(),l.call(null,m,...E);return}if(c()||o){h(),l.call(null,m,...E);return}r<64&&(r*=2);let b;a===1?(a=2,b=0):b=(r+Math.random())*1e3,d(b)}let p=!1;function g(m){p||(p=!0,h(),!u&&(i!==null?(m||(a=2),clearTimeout(i),d(0)):m||(a=1)))}return d(0),s=setTimeout(()=>{o=!0,g(!0)},n),g}function J5(t){t(!1)}function e8(t){return t!==void 0}function t8(t){return typeof t=="function"}function n8(t){return typeof t=="object"&&!Array.isArray(t)}function Bm(t){return typeof t=="string"||t instanceof String}function pL(t){return Nb()&&t instanceof Blob}function Nb(){return typeof Blob<"u"}function Tb(t,e,n,r){if(r<e)throw To(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw To(`Invalid value for '${t}'. Expected ${n} or less.`)}function fs(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function AL(t){let e=encodeURIComponent,n="?";for(let r in t)if(t.hasOwnProperty(r)){let i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var kc=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(kc||{});function xL(t,e){let n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}var Sb=class{constructor(e,n,r,i,s,o,a,c,u,l,d,h=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=l,this.connectionFactory_=d,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,p)=>{this.resolve_=f,this.reject_=p,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Nc(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===kc.NO_ERROR,c=s.getStatus();if(!a||xL(c,this.additionalRetryCodes_)&&this.retry){let l=s.getErrorCode()===kc.ABORT;r(!1,new Nc(!1,null,l));return}let u=this.successCodes_.indexOf(c)!==-1;r(!0,new Nc(u,s))})},n=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());e8(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=Rb();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?SL():DL();o(c)}else{let c=bL();o(c)}};this.canceled_?n(!1,new Nc(!1,null,!0)):this.backoffId_=Z5(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&J5(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Nc=class{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}};function r8(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function i8(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function s8(t,e){e&&(t["X-Firebase-GMPID"]=e)}function o8(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function a8(t,e,n,r,i,s,o=!0){let a=AL(t.urlParams),c=t.url+a,u=Object.assign({},t.headers);return s8(u,e),r8(u,n),i8(u,s),o8(u,r),new Sb(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}function c8(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function u8(...t){let e=c8();if(e!==void 0){let n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Nb())return new Blob(t);throw new Ge(Ve.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function l8(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function d8(t){if(typeof atob>"u")throw X5("base-64");return atob(t)}var vn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Rd=class{constructor(e,n){this.data=e,this.contentType=n||null}};function kb(t,e){switch(t){case vn.RAW:return new Rd(ML(e));case vn.BASE64:case vn.BASE64URL:return new Rd(RL(t,e));case vn.DATA_URL:return new Rd(f8(e),p8(e))}throw Rb()}function ML(t){let e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function h8(t){let e;try{e=decodeURIComponent(t)}catch{throw Md(vn.DATA_URL,"Malformed data URL.")}return ML(e)}function RL(t,e){switch(t){case vn.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Md(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case vn.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Md(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=d8(e)}catch(i){throw i.message.includes("polyfill")?i:Md(t,"Invalid character found")}let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}var Um=class{constructor(e){this.base64=!1,this.contentType=null;let n=e.match(/^data:([^,]+)?,/);if(n===null)throw Md(vn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=n[1]||null;r!=null&&(this.base64=g8(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function f8(t){let e=new Um(t);return e.base64?RL(vn.BASE64,e.rest):h8(e.rest)}function p8(t){return new Um(t).contentType}function g8(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}var Oc=class t{constructor(e,n){let r=0,i="";pL(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(pL(this.data_)){let r=this.data_,i=l8(r,e,n);return i===null?null:new t(i)}else{let r=new Uint8Array(this.data_.buffer,e,n-e);return new t(r,!0)}}static getBlob(...e){if(Nb()){let n=e.map(r=>r instanceof t?r.data_:r);return new t(u8.apply(null,n))}else{let n=e.map(o=>Bm(o)?kb(vn.RAW,o).data:o.data_),r=0;n.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new t(i,!0)}}uploadData(){return this.data_}};function Ob(t){let e;try{e=JSON.parse(t)}catch{return null}return n8(e)?e:null}function m8(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function y8(t,e){let n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function PL(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}function _8(t,e){return e}var Pt=class{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||_8}},jm=null;function v8(t){return!Bm(t)||t.length<2?t:PL(t)}function $m(){if(jm)return jm;let t=[];t.push(new Pt("bucket")),t.push(new Pt("generation")),t.push(new Pt("metageneration")),t.push(new Pt("name","fullPath",!0));function e(s,o){return v8(o)}let n=new Pt("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}let i=new Pt("size");return i.xform=r,t.push(i),t.push(new Pt("timeCreated")),t.push(new Pt("updated")),t.push(new Pt("md5Hash",null,!0)),t.push(new Pt("cacheControl",null,!0)),t.push(new Pt("contentDisposition",null,!0)),t.push(new Pt("contentEncoding",null,!0)),t.push(new Pt("contentLanguage",null,!0)),t.push(new Pt("contentType",null,!0)),t.push(new Pt("metadata","customMetadata",!0)),jm=t,jm}function w8(t,e){function n(){let r=t.bucket,i=t.fullPath,s=new Wt(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function E8(t,e,n){let r={};r.type="file";let i=n.length;for(let s=0;s<i;s++){let o=n[s];r[o.local]=o.xform(r,e[o.server])}return w8(r,t),r}function NL(t,e,n){let r=Ob(e);return r===null?null:E8(t,r,n)}function I8(t,e,n,r){let i=Ob(e);if(i===null||!Bm(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(u=>{let l=t.bucket,d=t.fullPath,h="/b/"+o(l)+"/o/"+o(d),f=fs(h,n,r),p=AL({alt:"media",token:u});return f+p})[0]}function Fb(t,e){let n={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}var gL="prefixes",mL="items";function C8(t,e,n){let r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[gL])for(let i of n[gL]){let s=i.replace(/\/$/,""),o=t._makeStorageReference(new Wt(e,s));r.prefixes.push(o)}if(n[mL])for(let i of n[mL]){let s=t._makeStorageReference(new Wt(e,i.name));r.items.push(s)}return r}function b8(t,e,n){let r=Ob(n);return r===null?null:C8(t,e,r)}var cr=class{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function jr(t){if(!t)throw Rb()}function qm(t,e){function n(r,i){let s=NL(t,i,e);return jr(s!==null),s}return n}function D8(t,e){function n(r,i){let s=b8(t,e,i);return jr(s!==null),s}return n}function T8(t,e){function n(r,i){let s=NL(t,i,e);return jr(s!==null),I8(s,i,t.host,t._protocol)}return n}function Vc(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=H5():i=q5():n.getStatus()===402?i=$5(t.bucket):n.getStatus()===403?i=G5(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function Hm(t){let e=Vc(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=B5(t.path)),s.serverResponse=i.serverResponse,s}return n}function kL(t,e,n){let r=e.fullServerUrl(),i=fs(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new cr(i,s,qm(t,n),o);return a.errorHandler=Hm(e),a}function S8(t,e,n,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=fs(o,t.host,t._protocol),c="GET",u=t.maxOperationRetryTime,l=new cr(a,c,D8(t,e.bucket),u);return l.urlParams=s,l.errorHandler=Vc(e),l}function A8(t,e,n){let r=e.fullServerUrl(),i=fs(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new cr(i,s,T8(t,n),o);return a.errorHandler=Hm(e),a}function x8(t,e,n,r){let i=e.fullServerUrl(),s=fs(i,t.host,t._protocol),o="PATCH",a=Fb(n,r),c={"Content-Type":"application/json; charset=utf-8"},u=t.maxOperationRetryTime,l=new cr(s,o,qm(t,r),u);return l.headers=c,l.body=a,l.errorHandler=Hm(e),l}function M8(t,e){let n=e.fullServerUrl(),r=fs(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(c,u){}let a=new cr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=Hm(e),a}function R8(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function OL(t,e,n){let r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=R8(null,e)),r}function P8(t,e,n,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let b="";for(let k=0;k<2;k++)b=b+Math.random().toString().slice(2);return b}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let u=OL(e,r,i),l=Fb(u,n),d="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+l+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,h=`\r
--`+c+"--",f=Oc.getBlob(d,r,h);if(f===null)throw TL();let p={name:u.fullPath},g=fs(s,t.host,t._protocol),m="POST",E=t.maxUploadRetryTime,S=new cr(g,m,qm(t,n),E);return S.urlParams=p,S.headers=o,S.body=f.uploadData(),S.errorHandler=Vc(e),S}var Fc=class{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}};function Lb(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{jr(!1)}return jr(!!n&&(e||["active"]).indexOf(n)!==-1),n}function N8(t,e,n,r,i){let s=e.bucketOnlyServerUrl(),o=OL(e,r,i),a={name:o.fullPath},c=fs(s,t.host,t._protocol),u="POST",l={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},d=Fb(o,n),h=t.maxUploadRetryTime;function f(g){Lb(g);let m;try{m=g.getResponseHeader("X-Goog-Upload-URL")}catch{jr(!1)}return jr(Bm(m)),m}let p=new cr(c,u,f,h);return p.urlParams=a,p.headers=l,p.body=d,p.errorHandler=Vc(e),p}function k8(t,e,n,r){let i={"X-Goog-Upload-Command":"query"};function s(u){let l=Lb(u,["active","final"]),d=null;try{d=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{jr(!1)}d||jr(!1);let h=Number(d);return jr(!isNaN(h)),new Fc(h,r.size(),l==="final")}let o="POST",a=t.maxUploadRetryTime,c=new cr(n,o,s,a);return c.headers=i,c.errorHandler=Vc(e),c}var yL=256*1024;function O8(t,e,n,r,i,s,o,a){let c=new Fc(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw Q5();let u=c.total-c.current,l=u;i>0&&(l=Math.min(l,i));let d=c.current,h=d+l,f="";l===0?f="finalize":u===l?f="upload, finalize":f="upload";let p={"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":`${c.current}`},g=r.slice(d,h);if(g===null)throw TL();function m(k,q){let G=Lb(k,["active","final"]),Ee=c.current+l,gt=r.size(),Cs;return G==="final"?Cs=qm(e,s)(k,q):Cs=null,new Fc(Ee,gt,G==="final",Cs)}let E="POST",S=e.maxUploadRetryTime,b=new cr(n,E,m,S);return b.headers=p,b.body=g.uploadData(),b.progressCallback=a||null,b.errorHandler=Vc(t),b}var FL={STATE_CHANGED:"state_changed"},Vt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function bb(t){switch(t){case"running":case"pausing":case"canceling":return Vt.RUNNING;case"paused":return Vt.PAUSED;case"success":return Vt.SUCCESS;case"canceled":return Vt.CANCELED;case"error":return Vt.ERROR;default:return Vt.ERROR}}var Ab=class{constructor(e,n,r){if(t8(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function Pc(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}var _L=null,xb=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=kc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=kc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=kc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw xd("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw xd("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw xd("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw xd("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw xd("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},Mb=class extends xb{initXhr(){this.xhr_.responseType="text"}};function Vr(){return _L?_L():new Mb}var Pd=class{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=$m(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Ve.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(xL(i.status,[]))if(s)i=bL();else{this.sleepTime=Math.max(this.sleepTime*2,U5),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Ve.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{let r=N8(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Vr,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((n,r)=>{let i=k8(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Vr,n,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=yL*this._chunkMultiplier,n=new Fc(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=O8(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let a=this._ref.storage._makeRequest(o,Vr,i,s,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){yL*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{let r=kL(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Vr,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{let r=P8(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Vr,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=DL(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=bb(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){let s=new Ab(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(bb(this._state)){case Vt.SUCCESS:Pc(this._resolve.bind(null,this.snapshot))();break;case Vt.CANCELED:case Vt.ERROR:let n=this._reject;Pc(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(bb(this._state)){case Vt.RUNNING:case Vt.PAUSED:e.next&&Pc(e.next.bind(e,this.snapshot))();break;case Vt.SUCCESS:e.complete&&Pc(e.complete.bind(e))();break;case Vt.CANCELED:case Vt.ERROR:e.error&&Pc(e.error.bind(e,this._error))();break;default:e.error&&Pc(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var Lc=class t{constructor(e,n){this._service=e,n instanceof Wt?this._location=n:this._location=Wt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new Wt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return PL(this._location.path)}get storage(){return this._service}get parent(){let e=m8(this._location.path);if(e===null)return null;let n=new Wt(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw Pb(e)}};function F8(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new Pd(t,new Oc(e),n)}function L8(t){let e={prefixes:[],items:[]};return LL(t,e).then(()=>e)}function LL(t,e,n){return y(this,null,function*(){let i=yield VL(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield LL(t,e,i.nextPageToken))})}function VL(t,e){e!=null&&typeof e.maxResults=="number"&&Tb("options.maxResults",1,1e3,e.maxResults);let n=e||{},r=S8(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,Vr)}function V8(t){t._throwIfRoot("getMetadata");let e=kL(t.storage,t._location,$m());return t.storage.makeRequestWithTokens(e,Vr)}function j8(t,e){t._throwIfRoot("updateMetadata");let n=x8(t.storage,t._location,e,$m());return t.storage.makeRequestWithTokens(n,Vr)}function U8(t){t._throwIfRoot("getDownloadURL");let e=A8(t.storage,t._location,$m());return t.storage.makeRequestWithTokens(e,Vr).then(n=>{if(n===null)throw Y5();return n})}function B8(t){t._throwIfRoot("deleteObject");let e=M8(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Vr)}function jL(t,e){let n=y8(t._location.path,e),r=new Wt(t._location.bucket,n);return new Lc(t.storage,r)}function $8(t){return/^[A-Za-z]+:\/\//.test(t)}function q8(t,e){return new Lc(t,e)}function UL(t,e){if(t instanceof Nd){let n=t;if(n._bucket==null)throw K5();let r=new Lc(n,n._bucket);return e!=null?UL(r,e):r}else return e!==void 0?jL(t,e):t}function H8(t,e){if(e&&$8(e)){if(t instanceof Nd)return q8(t,e);throw To("To use ref(service, url), the first argument must be a Storage instance.")}else return UL(t,e)}function vL(t,e){let n=e?.[CL];return n==null?null:Wt.makeFromBucketSpec(n,t)}function G8(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";let{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Vo(i,t.app.options.projectId))}var Nd=class{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=IL,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=V5,this._maxUploadRetryTime=j5,this._requests=new Set,i!=null?this._bucket=Wt.makeFromBucketSpec(i,this._host):this._bucket=vL(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Wt.makeFromBucketSpec(this._url,e):this._bucket=vL(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Tb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Tb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return y(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=yield e.getToken();if(n!==null)return n.accessToken}return null})}_getAppCheckToken(){return y(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Lc(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new Db(SL());{let o=a8(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){return y(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()})}},wL="@firebase/storage",EL="0.12.1";var z8="storage";function BL(t,e,n){return t=Q(t),F8(t,e,n)}function $L(t){return t=Q(t),V8(t)}function qL(t,e){return t=Q(t),j8(t,e)}function HL(t,e){return t=Q(t),VL(t,e)}function GL(t){return t=Q(t),L8(t)}function zL(t){return t=Q(t),U8(t)}function WL(t){return t=Q(t),B8(t)}function Vb(t,e){return t=Q(t),H8(t,e)}function KL(t,e){return jL(t,e)}function QL(t,e,n,r={}){G8(t,e,n,r)}function W8(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Nd(n,r,i,e,jo)}function K8(){Gr(new Dt(z8,W8,"PUBLIC").setMultipleInstances(!0)),Zt(wL,EL,""),Zt(wL,EL,"esm2017")}K8();var jc=class{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var Gm=class{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new jc(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new jc(r,this,this._ref))},n)}on(e,n,r,i){let s;return n&&(typeof n=="function"?s=o=>n(new jc(o,this,this._ref)):s={next:n.next?o=>n.next(new jc(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},zm=class{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new So(e,this._service))}get items(){return this._delegate.items.map(e=>new So(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var So=class t{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let n=KL(this._delegate,e);return new t(n,this.storage)}get root(){return new t(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new t(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new Gm(BL(this._delegate,e,n),this)}putString(e,n=vn.RAW,r){this._throwIfRoot("putString");let i=kb(n,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new Gm(new Pd(this._delegate,new Oc(i.data,!0),s),this)}listAll(){return GL(this._delegate).then(e=>new zm(e,this.storage))}list(e){return HL(this._delegate,e||void 0).then(n=>new zm(n,this.storage))}getMetadata(){return $L(this._delegate)}updateMetadata(e){return qL(this._delegate,e)}getDownloadURL(){return zL(this._delegate)}delete(){return this._throwIfRoot("delete"),WL(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw Pb(e)}};var Wm=class{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(YL(e))throw To("ref() expected a child path but got a URL, use refFromURL instead.");return new So(Vb(this._delegate,e),this)}refFromURL(e){if(!YL(e))throw To("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Wt.makeFromUrl(e,this._delegate.host)}catch{throw To("refFromUrl() expected a valid full URL but got an invalid one.")}return new So(Vb(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){QL(this._delegate,e,n,r)}};function YL(t){return/^[A-Za-z]+:\/\//.test(t)}var Q8="@firebase/storage-compat",Y8="0.3.4";var X8="storage-compat";function Z8(t,{instanceIdentifier:e}){let n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new Wm(n,r)}function J8(t){let e={TaskState:Vt,TaskEvent:FL,StringFormat:vn,Storage:Wm,Reference:So};t.INTERNAL.registerComponent(new Dt(X8,Z8,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(Q8,Y8)}J8(Ue);function eK(t){return new ne(e=>{let n=o=>e.next(o),r=o=>e.error(o),i=()=>e.complete();n(t.snapshot);let s=t.on("state_changed",n);return t.then(o=>{n(o),i()},o=>{n(t.snapshot),r(o)}),function(){s()}}).pipe(d_(0))}function XL(t){let e=eK(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(V(n=>n.bytesTransferred/n.totalBytes*100))}}function Km(t){return{getDownloadURL:()=>U(void 0).pipe(yE,De(()=>t.getDownloadURL()),Fe),getMetadata:()=>U(void 0).pipe(yE,De(()=>t.getMetadata()),Fe),delete:()=>oe(t.delete()),child:e=>Km(t.child(e)),updateMetadata:e=>oe(t.updateMetadata(e)),put:(e,n)=>{let r=t.put(e,n);return XL(r)},putString:(e,n,r)=>{let i=t.putString(e,n,r);return XL(i)},list:e=>oe(t.list(e)),listAll:()=>oe(t.listAll())}}var tK=new x("angularfire2.storageBucket"),nK=new x("angularfire2.storage.maxUploadRetryTime"),rK=new x("angularfire2.storage.maxOperationRetryTime"),iK=new x("angularfire2.storage.use-emulator"),sK=(()=>{class t{storage;constructor(n,r,i,s,o,a,c,u,l,d){let h=ai(n,o,r);this.storage=Hi(`${h.name}.storage.${i}`,"AngularFireStorage",h.name,()=>{let f=o.runOutsideAngular(()=>h.storage(i||void 0)),p=l;return p&&f.useEmulator(...p),c&&f.setMaxUploadRetryTime(c),u&&f.setMaxOperationRetryTime(u),f},[c,u])}ref(n){return Km(this.storage.ref(n))}refFromURL(n){return Km(this.storage.refFromURL(n))}upload(n,r,i){let s=this.storage.ref(n);return Km(s).put(r,i)}static \u0275fac=function(r){return new(r||t)(w(Cr),w(br,8),w(tK,8),w(ot),w(se),w($i),w(nK,8),w(rK,8),w(iK,8),w(Jn,8))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var oK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Me({type:t});static \u0275inj=Re({})}return t})(),ZL=(()=>{class t{constructor(){Ue.registerVersion("angularfire",er.full,"gcs-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Me({type:t});static \u0275inj=Re({providers:[sK],imports:[oK]})}return t})();var JL="@firebase/database",eV="1.0.3";var YD="";function XD(t){YD=t}var zb=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),nt(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:yh(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var Wb=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return bn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var RV=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new zb(e)}}catch{}return new Wb},xo=RV("localStorage"),Kb=RV("sessionStorage");var qc=new Ci("@firebase/database"),PV=function(){let t=1;return function(){return t++}}(),NV=function(t){let e=zT(t),n=new GT;n.update(e);let r=n.digest();return ph.encodeByteArray(r)},rh=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=rh.apply(null,r):typeof r=="object"?e+=nt(r):e+=r,e+=" "}return e},Mo=null,tV=!0,kV=function(t,e){D(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(qc.logLevel=Dn.VERBOSE,Mo=qc.log.bind(qc),e&&Kb.set("logging_enabled",!0)):typeof t=="function"?Mo=t:(Mo=null,Kb.remove("logging_enabled"))},Ct=function(...t){if(tV===!0&&(tV=!1,Mo===null&&Kb.get("logging_enabled")===!0&&kV(!0)),Mo){let e=rh.apply(null,t);Mo(e)}},ih=function(t){return function(...e){Ct(t,...e)}},Qb=function(...t){let e="FIREBASE INTERNAL ERROR: "+rh(...t);qc.error(e)},$r=function(...t){let e=`FIREBASE FATAL ERROR: ${rh(...t)}`;throw qc.error(e),new Error(e)},jt=function(...t){let e="FIREBASE WARNING: "+rh(...t);qc.warn(e)},aK=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&jt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Iy=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},cK=function(t){if(dr()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ys="[MIN_NAME]",wi="[MAX_NAME]",Po=function(t,e){if(t===e)return 0;if(t===ys||e===wi)return-1;if(e===ys||t===wi)return 1;{let n=nV(t),r=nV(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},uK=function(t,e){return t===e?0:t<e?-1:1},kd=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+nt(e))},ZD=function(t){if(typeof t!="object"||t===null)return nt(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=nt(e[r]),n+=":",n+=ZD(t[e[r]]);return n+="}",n},OV=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function bt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var FV=function(t){D(!Iy(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let u=[];for(c=n;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();let l=u.join(""),d="";for(c=0;c<64;c+=8){let h=parseInt(l.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},lK=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},dK=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function hK(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var fK=new RegExp("^-?(0*)\\d{1,10}$"),pK=-2147483648,gK=2147483647,nV=function(t){if(fK.test(t)){let e=Number(t);if(e>=pK&&e<=gK)return e}return null},Zc=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw jt("Exception was thrown by user callback.",n),e},Math.floor(0))}},mK=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Vd=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var Yb=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){jt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Xb=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Ct("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',jt(e)}},jd=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Ym="5",LV="v",VV="s",jV="r",UV="f",BV=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,$V="ls",qV="p",Zb="ac",HV="websocket",GV="long_polling";var Xm=class{constructor(e,n,r,i,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=xo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&xo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function yK(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function zV(t,e,n){D(typeof e=="string","typeof type must == string"),D(typeof n=="object","typeof params must == object");let r;if(e===HV)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===GV)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);yK(t)&&(n.ns=t.namespace);let i=[];return bt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var Jb=class{constructor(){this.counters_={}}incrementCounter(e,n=1){bn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return jT(this.counters_)}};var jb={},Ub={};function JD(t){let e=t.toString();return jb[e]||(jb[e]=new Jb),jb[e]}function _K(t,e){let n=t.toString();return Ub[n]||(Ub[n]=e()),Ub[n]}var eD=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Zc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var rV="start",vK="close",wK="pLPCommand",EK="pRTLPCB",WV="id",KV="pw",QV="ser",IK="cb",CK="seg",bK="ts",DK="d",TK="dframe",YV=1870,XV=30,SK=YV-XV,AK=25e3,xK=3e4,qd=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ih(e),this.stats_=JD(n),this.urlFn=c=>(this.appCheckToken&&(c[Zb]=this.appCheckToken),zV(n,GV,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new eD(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(xK)),cK(()=>{if(this.isClosed_)return;this.scriptTagHolder=new tD((...s)=>{let[o,a,c,u,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===rV)this.id=a,this.password=c;else if(o===vK)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[rV]="t",r[QV]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[IK]=this.scriptTagHolder.uniqueCallbackIdentifier),r[LV]=Ym,this.transportSessionId&&(r[VV]=this.transportSessionId),this.lastSessionId&&(r[$V]=this.lastSessionId),this.applicationId&&(r[qV]=this.applicationId),this.appCheckToken&&(r[Zb]=this.appCheckToken),typeof location<"u"&&location.hostname&&BV.test(location.hostname)&&(r[jV]=UV);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return dr()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!lK()&&!dK()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=nt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=VT(n),i=OV(r,SK);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(dr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[TK]="t",r[WV]=e,r[KV]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=nt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},tD=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,dr())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=PV(),window[wK+this.uniqueCallbackIdentifier]=e,window[EK+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ct("frame writing exception"),a.stack&&Ct(a.stack),Ct(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ct("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[WV]=this.myID,e[KV]=this.myPW,e[QV]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+XV+r.length<=YV;){let o=this.pendingSegs.shift();r=r+"&"+CK+i+"="+o.seg+"&"+bK+i+"="+o.ts+"&"+DK+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(AK)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){dr()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Ct("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var MK=16384,RK=45e3,Zm=null;typeof MozWebSocket<"u"?Zm=MozWebSocket:typeof WebSocket<"u"&&(Zm=WebSocket);var Bc=(()=>{class t{constructor(n,r,i,s,o,a,c){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ih(this.connId),this.stats_=JD(r),this.connURL=t.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[LV]=Ym,!dr()&&typeof location<"u"&&location.hostname&&BV.test(location.hostname)&&(a[jV]=UV),r&&(a[VV]=r),i&&(a[$V]=i),s&&(a[Zb]=s),o&&(a[qV]=o),zV(n,HV,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,xo.set("previous_websocket_failure",!0);try{let i;if(dr()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Ym}/${YD}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Zm(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Zm!==null&&!t.forceDisallow_}static previouslyFailed(){return xo.isInMemoryStorage||xo.get("previous_websocket_failure")===!0}markConnectionHealthy(){xo.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=yh(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(D(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=nt(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=OV(r,MK);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(RK))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),ZV=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[qd,Bc]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Bc&&Bc.isAvailable(),i=r&&!Bc.previouslyFailed();if(n.webSocketOnly&&(r||jt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Bc];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),PK=6e4,NK=5e3,kK=10*1024,OK=100*1024,Bb="t",iV="d",FK="s",sV="r",LK="e",oV="o",aV="a",cV="n",uV="p",VK="h",nD=class{constructor(e,n,r,i,s,o,a,c,u,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ih("c:"+this.id+":"),this.transportManager_=new ZV(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Vd(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>OK?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>kK?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Bb in e){let n=e[Bb];n===aV?this.upgradeIfSecondaryHealthy_():n===sV?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===oV&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=kd("t",e),r=kd("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:uV,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:aV,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:cV,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=kd("t",e),r=kd("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=kd(Bb,e);if(iV in e){let r=e[iV];if(n===VK){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===cV){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===FK?this.onConnectionShutdown_(r):n===sV?this.onReset_(r):n===LK?Qb("Server Error: "+r):n===oV?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Qb("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Ym!==r&&jt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Vd(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(PK))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Vd(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(NK))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:uV,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(xo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Jm=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var ey=class{constructor(e){this.allowedEvents_=e,this.listeners_={},D(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){D(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var ty=class t extends ey{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!$y()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return D(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var lV=32,dV=768,ve=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function _e(){return new ve("")}function ae(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function _s(t){return t.pieces_.length-t.pieceNum_}function xe(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new ve(t.pieces_,e)}function eT(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function jK(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Hd(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function JV(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new ve(e,0)}function je(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof ve)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new ve(n,0)}function ce(t){return t.pieceNum_>=t.pieces_.length}function Kt(t,e){let n=ae(t),r=ae(e);if(n===null)return e;if(n===r)return Kt(xe(t),xe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function UK(t,e){let n=Hd(t,0),r=Hd(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=Po(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function tT(t,e){if(_s(t)!==_s(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Bn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(_s(t)>_s(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var rD=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Hd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=su(this.parts_[r]);e2(this)}};function BK(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=su(e),e2(t)}function $K(t){let e=t.parts_.pop();t.byteLength_-=su(e),t.parts_.length>0&&(t.byteLength_-=1)}function e2(t){if(t.byteLength_>dV)throw new Error(t.errorPrefix_+"has a key path longer than "+dV+" bytes ("+t.byteLength_+").");if(t.parts_.length>lV)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+lV+") or object contains a cycle "+Ao(t))}function Ao(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var iD=class t extends ey{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return D(e==="visible","Unknown event type: "+e),[this.visible_]}};var Od=1e3,qK=60*5*1e3,hV=30*1e3,HK=1.3,GK=3e4,zK="server_kill",fV=3,nT=(()=>{class t extends Jm{constructor(n,r,i,s,o,a,c,u){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=t.nextPersistentConnectionId_++,this.log_=ih("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Od,this.maxReconnectDelay_=qK,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!dr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");iD.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&ty.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(nt(o)),D(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new mt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),D(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let u=c.d,l=c.s;t.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",c),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,u))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&bn(n,"w")){let i=Ii(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();jt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||qT(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=hV)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=$T(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+nt(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):Qb("Unrecognized action received from server: "+nt(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){D(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Od,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Od,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>GK&&(this.reconnectDelay_=Od),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*HK)}this.onConnectStatus_(!1)}establishConnection_(){return y(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},l=function(h){D(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(h)};this.realtime_={close:u,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?Ct("getToken() completed but was canceled"):(Ct("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,c=new nD(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{jt(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(zK)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&jt(h),u())}}})}interrupt(n){Ct("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Ct("Resuming connection for reason: "+n),delete this.interruptReasons_[n],_h(this.interruptReasons_)&&(this.reconnectDelay_=Od,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>ZD(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new ve(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Ct("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=fV&&(this.reconnectDelay_=hV,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Ct("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=fV&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";dr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+YD.replace(/\./g,"-")]=1,$y()?n["framework.cordova"]=1:UT()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=ty.getInstance().currentlyOnline();return _h(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),de=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Hc=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new de(ys,e),i=new de(ys,n);return this.compare(r,i)!==0}minPost(){return de.MIN}};var Qm,ny=class extends Hc{static get __EMPTY_NODE(){return Qm}static set __EMPTY_NODE(e){Qm=e}compare(e,n){return Po(e.name,n.name)}isDefinedOn(e){throw Lo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return de.MIN}maxPost(){return new de(wi,Qm)}makePost(e,n){return D(typeof e=="string","KeyIndex indexValue must always be a string."),new de(e,Qm)}toString(){return".key"}},Br=new ny;var $c=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},ur=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??$n.EMPTY_NODE,this.right=o??$n.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return $n.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return $n.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),sD=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new ur(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},$n=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,ur.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ur.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new $c(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new $c(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new $c(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new $c(this.root_,null,this.comparator_,!0,e)}};$n.EMPTY_NODE=new sD;function WK(t,e){return Po(t.name,e.name)}function rT(t,e){return Po(t,e)}var oD;function KK(t){oD=t}var t2=function(t){return typeof t=="number"?"number:"+FV(t):"string:"+t},n2=function(t){if(t.isLeafNode()){let e=t.val();D(typeof e=="string"||typeof e=="number"||typeof e=="object"&&bn(e,".sv"),"Priority must be a string or number.")}else D(t===oD||t.isEmpty(),"priority of unexpected type.");D(t===oD||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var pV,Gc=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,D(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),n2(this.priorityNode_)}static set __childrenNodeConstructor(n){pV=n}static get __childrenNodeConstructor(){return pV}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return ce(n)?this:ae(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=ae(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(D(i!==".priority"||_s(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(xe(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+t2(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=FV(this.value_):n+=this.value_,this.lazyHash_=NV(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(D(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return D(s>=0,"Unknown leaf type: "+r),D(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),r2,i2;function QK(t){r2=t}function YK(t){i2=t}var aD=class extends Hc{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?Po(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return de.MIN}maxPost(){return new de(wi,new Gc("[PRIORITY-POST]",i2))}makePost(e,n){let r=r2(e);return new de(n,new Gc("[PRIORITY-POST]",r))}toString(){return".priority"}},Ne=new aD;var XK=Math.log(2),cD=class{constructor(e){let n=s=>parseInt(Math.log(s)/XK,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},ry=function(t,e,n,r){t.sort(e);let i=function(c,u){let l=u-c,d,h;if(l===0)return null;if(l===1)return d=t[c],h=n?n(d):d,new ur(h,d.node,ur.BLACK,null,null);{let f=parseInt(l/2,10)+c,p=i(c,f),g=i(f+1,u);return d=t[f],h=n?n(d):d,new ur(h,d.node,ur.BLACK,p,g)}},s=function(c){let u=null,l=null,d=t.length,h=function(p,g){let m=d-p,E=d;d-=p;let S=i(m+1,E),b=t[m],k=n?n(b):b;f(new ur(k,b.node,g,null,S))},f=function(p){u?(u.left=p,u=p):(l=p,u=p)};for(let p=0;p<c.count;++p){let g=c.nextBitIsOne(),m=Math.pow(2,c.count-(p+1));g?h(m,ur.BLACK):(h(m,ur.BLACK),h(m,ur.RED))}return l},o=new cD(t.length),a=s(o);return new $n(r||e,a)};var $b,Uc={},zc=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return D(Uc&&Ne,"ChildrenNode.ts has not been loaded"),$b=$b||new t({".priority":Uc},{".priority":Ne}),$b}get(e){let n=Ii(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof $n?n:null}hasIndex(e){return bn(this.indexSet_,e.toString())}addIndex(e,n){D(e!==Br,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(de.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=ry(r,e.getCompare()):a=Uc;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let l=Object.assign({},this.indexes_);return l[c]=a,new t(l,u)}addToIndexes(e,n){let r=iu(this.indexes_,(i,s)=>{let o=Ii(this.indexSet_,s);if(D(o,"Missing index implementation for "+s),i===Uc)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(de.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),ry(a,o.getCompare())}else return Uc;else{let a=n.get(e.name),c=i;return a&&(c=c.remove(new de(e.name,a))),c.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=iu(this.indexes_,i=>{if(i===Uc)return i;{let s=n.get(e.name);return s?i.remove(new de(e.name,s)):i}});return new t(r,this.indexSet_)}};var Fd,te=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&n2(this.priorityNode_),this.children_.isEmpty()&&D(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Fd||(Fd=new t(new $n(rT),null,zc.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Fd}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Fd:r}}getChild(n){let r=ae(n);return r===null?this:this.getImmediateChild(r).getChild(xe(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(D(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new de(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Fd:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=ae(n);if(i===null)return r;{D(ae(n)!==".priority"||_s(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(xe(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Ne,(a,c)=>{r[a]=c.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+t2(this.getPriority().val())+":"),this.forEachChild(Ne,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":NV(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new de(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new de(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new de(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,de.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,de.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===sh?-1:0}withIndex(n){if(n===Br||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Br||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Ne),s=r.getIterator(Ne),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Br?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),uD=class extends te{constructor(){super(new $n(rT),te.EMPTY_NODE,zc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return te.EMPTY_NODE}isEmpty(){return!1}},sh=new uD;Object.defineProperties(de,{MIN:{value:new de(ys,te.EMPTY_NODE)},MAX:{value:new de(wi,sh)}});ny.__EMPTY_NODE=te.EMPTY_NODE;Gc.__childrenNodeConstructor=te;KK(sh);YK(sh);var ZK=!0;function ze(t,e=null){if(t===null)return te.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),D(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Gc(n,ze(e))}if(!(t instanceof Array)&&ZK){let n=[],r=!1;if(bt(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=ze(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new de(o,c)))}}),n.length===0)return te.EMPTY_NODE;let s=ry(n,WK,o=>o.name,rT);if(r){let o=ry(n,Ne.getCompare());return new te(s,ze(e),new zc({".priority":o},{".priority":Ne}))}else return new te(s,ze(e),zc.Default)}else{let n=te.EMPTY_NODE;return bt(t,(r,i)=>{if(bn(t,r)&&r.substring(0,1)!=="."){let s=ze(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(ze(e))}}QK(ze);var Gd=class extends Hc{constructor(e){super(),this.indexPath_=e,D(!ce(e)&&ae(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?Po(e.name,n.name):s}makePost(e,n){let r=ze(e),i=te.EMPTY_NODE.updateChild(this.indexPath_,r);return new de(n,i)}maxPost(){let e=te.EMPTY_NODE.updateChild(this.indexPath_,sh);return new de(wi,e)}toString(){return Hd(this.indexPath_,0).join("/")}};var lD=class extends Hc{compare(e,n){let r=e.node.compareTo(n.node);return r===0?Po(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return de.MIN}maxPost(){return de.MAX}makePost(e,n){let r=ze(e);return new de(n,r)}toString(){return".value"}},iT=new lD;function s2(t){return{type:"value",snapshotNode:t}}function Wc(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function zd(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Wd(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function JK(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Kd=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){D(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(zd(n,a)):D(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Wc(n,r)):o.trackChildChange(Wd(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ne,(i,s)=>{n.hasChild(i)||r.trackChildChange(zd(i,s))}),n.isLeafNode()||n.forEachChild(Ne,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Wd(i,s,o))}else r.trackChildChange(Wc(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?te.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var iy=class t{constructor(e){this.indexedFilter_=new Kd(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new de(n,r))||(r=te.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=te.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(te.EMPTY_NODE);let s=this;return n.forEachChild(Ne,(o,a)=>{s.matches(new de(o,a))||(i=i.updateImmediateChild(o,te.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var dD=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new iy(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new de(n,r))||(r=te.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=te.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=te.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(te.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,te.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;D(a.numChildren()===this.limit_,"");let c=new de(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,u,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,c);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(Wd(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(zd(n,d));let g=a.updateImmediateChild(n,te.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Wc(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:l&&o(u,c)>=0?(s!=null&&(s.trackChildChange(zd(u.name,u.node)),s.trackChildChange(Wc(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,te.EMPTY_NODE)):e}};var Qd=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ne}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return D(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return D(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ys}hasEnd(){return this.endSet_}getIndexEndValue(){return D(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return D(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:wi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return D(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ne}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function eQ(t){return t.loadsAllData()?new Kd(t.getIndex()):t.hasLimit()?new dD(t):new iy(t)}function tQ(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function nQ(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function hD(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function rQ(t,e,n){let r;return t.index_===Br||n?r=hD(t,e,n):r=hD(t,e,wi),r.startAfterSet_=!0,r}function fD(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function iQ(t,e,n){let r;return t.index_===Br||n?r=fD(t,e,n):r=fD(t,e,ys),r.endBeforeSet_=!0,r}function Cy(t,e){let n=t.copy();return n.index_=e,n}function gV(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Ne?n="$priority":t.index_===iT?n="$value":t.index_===Br?n="$key":(D(t.index_ instanceof Gd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=nt(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=nt(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+nt(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=nt(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+nt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function mV(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ne&&(e.i=t.index_.toString()),e}var pD=class t extends Jm{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=ih("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(D(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let c=gV(e._queryParams);this.restRequest_(s+".json",c,(u,l)=>{let d=l;if(u===404&&(d=null,u=null),u===null&&this.onDataUpdate_(s,d,!1,r),Ii(this.listens_,o)===a){let h;u?u===401?h="permission_denied":h="rest_error:"+u:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=gV(e._queryParams),r=e._path.toString(),i=new mt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+HT(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=yh(a.responseText)}catch{jt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&jt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var gD=class{constructor(){this.rootNode_=te.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function sy(){return{value:null,children:new Map}}function Jc(t,e,n){if(ce(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=ae(e);t.children.has(r)||t.children.set(r,sy());let i=t.children.get(r);e=xe(e),Jc(i,e,n)}}function mD(t,e){if(ce(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Ne,(r,i)=>{Jc(t,new ve(r),i)}),mD(t,e)}}else if(t.children.size>0){let n=ae(e);return e=xe(e),t.children.has(n)&&mD(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function yD(t,e,n){t.value!==null?n(e,t.value):sQ(t,(r,i)=>{let s=new ve(e.toString()+"/"+r);yD(i,s,n)})}function sQ(t,e){t.children.forEach((n,r)=>{e(r,n)})}var _D=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&bt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var yV=10*1e3,oQ=30*1e3,aQ=5*60*1e3,vD=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new _D(e);let r=yV+(oQ-yV)*Math.random();Vd(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;bt(e,(i,s)=>{s>0&&bn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Vd(this.reportStats_.bind(this),Math.floor(Math.random()*2*aQ))}};var Ur=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Ur||{});function sT(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function oT(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function aT(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var wD=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Ur.ACK_USER_WRITE,this.source=sT()}operationForChild(e){if(ce(this.path)){if(this.affectedTree.value!=null)return D(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new ve(e));return new t(_e(),n,this.revert)}}else return D(ae(this.path)===e,"operationForChild called for unrelated child."),new t(xe(this.path),this.affectedTree,this.revert)}};var oy=class t{constructor(e,n){this.source=e,this.path=n,this.type=Ur.LISTEN_COMPLETE}operationForChild(e){return ce(this.path)?new t(this.source,_e()):new t(this.source,xe(this.path))}};var Kc=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Ur.OVERWRITE}operationForChild(e){return ce(this.path)?new t(this.source,_e(),this.snap.getImmediateChild(e)):new t(this.source,xe(this.path),this.snap)}};var Yd=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Ur.MERGE}operationForChild(e){if(ce(this.path)){let n=this.children.subtree(new ve(e));return n.isEmpty()?null:n.value?new Kc(this.source,_e(),n.value):new t(this.source,_e(),n)}else return D(ae(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,xe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var qr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ce(e))return this.isFullyInitialized()&&!this.filtered_;let n=ae(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var ED=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function cQ(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(JK(o.childName,o.snapshotNode))}),Ld(t,i,"child_removed",e,r,n),Ld(t,i,"child_added",e,r,n),Ld(t,i,"child_moved",s,r,n),Ld(t,i,"child_changed",e,r,n),Ld(t,i,"value",e,r,n),i}function Ld(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,c)=>lQ(t,a,c)),o.forEach(a=>{let c=uQ(t,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,t.query_))})})}function uQ(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function lQ(t,e,n){if(e.childName==null||n.childName==null)throw Lo("Should only compare child_ events.");let r=new de(e.childName,e.snapshotNode),i=new de(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function by(t,e){return{eventCache:t,serverCache:e}}function Ud(t,e,n,r){return by(new qr(e,n,r),t.serverCache)}function o2(t,e,n,r){return by(t.eventCache,new qr(e,n,r))}function ay(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ro(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var qb,dQ=()=>(qb||(qb=new $n(uK)),qb),Qt=class t{constructor(e,n=dQ()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return bt(e,(r,i)=>{n=n.set(new ve(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:_e(),value:this.value};if(ce(e))return null;{let r=ae(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(xe(e),n);return s!=null?{path:je(new ve(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ce(e))return this;{let n=ae(e),r=this.children.get(n);return r!==null?r.subtree(xe(e)):new t(null)}}set(e,n){if(ce(e))return new t(n,this.children);{let r=ae(e),s=(this.children.get(r)||new t(null)).set(xe(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(ce(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=ae(e),r=this.children.get(n);if(r){let i=r.remove(xe(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(ce(e))return this.value;{let n=ae(e),r=this.children.get(n);return r?r.get(xe(e)):null}}setTree(e,n){if(ce(e))return n;{let r=ae(e),s=(this.children.get(r)||new t(null)).setTree(xe(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(_e(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(je(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,_e(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(ce(e))return null;{let s=ae(e),o=this.children.get(s);return o?o.findOnPath_(xe(e),je(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,_e(),n)}foreachOnPath_(e,n,r){if(ce(e))return this;{this.value&&r(n,this.value);let i=ae(e),s=this.children.get(i);return s?s.foreachOnPath_(xe(e),je(n,i),r):new t(null)}}foreach(e){this.foreach_(_e(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(je(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var lr=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Qt(null))}};function Bd(t,e,n){if(ce(e))return new lr(new Qt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Kt(i,e);return s=s.updateChild(o,n),new lr(t.writeTree_.set(i,s))}else{let i=new Qt(n),s=t.writeTree_.setTree(e,i);return new lr(s)}}}function ID(t,e,n){let r=t;return bt(n,(i,s)=>{r=Bd(r,je(e,i),s)}),r}function _V(t,e){if(ce(e))return lr.empty();{let n=t.writeTree_.setTree(e,new Qt(null));return new lr(n)}}function CD(t,e){return No(t,e)!=null}function No(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Kt(n.path,e)):null}function vV(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ne,(r,i)=>{e.push(new de(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new de(r,i.value))}),e}function gs(t,e){if(ce(e))return t;{let n=No(t,e);return n!=null?new lr(new Qt(n)):new lr(t.writeTree_.subtree(e))}}function bD(t){return t.writeTree_.isEmpty()}function Qc(t,e){return a2(_e(),t.writeTree_,e)}function a2(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(D(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=a2(je(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(je(t,".priority"),r)),n}}function Dy(t,e){return d2(e,t)}function hQ(t,e,n,r,i){D(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Bd(t.visibleWrites,e,n)),t.lastWriteId=r}function fQ(t,e,n,r){D(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=ID(t.visibleWrites,e,n),t.lastWriteId=r}function pQ(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function gQ(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);D(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&mQ(a,r.path)?i=!1:Bn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return yQ(t),!0;if(r.snap)t.visibleWrites=_V(t.visibleWrites,r.path);else{let a=r.children;bt(a,c=>{t.visibleWrites=_V(t.visibleWrites,je(r.path,c))})}return!0}else return!1}function mQ(t,e){if(t.snap)return Bn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&Bn(je(t.path,n),e))return!0;return!1}function yQ(t){t.visibleWrites=c2(t.allWrites,_Q,_e()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function _Q(t){return t.visible}function c2(t,e,n){let r=lr.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)Bn(n,o)?(a=Kt(n,o),r=Bd(r,a,s.snap)):Bn(o,n)&&(a=Kt(o,n),r=Bd(r,_e(),s.snap.getChild(a)));else if(s.children){if(Bn(n,o))a=Kt(n,o),r=ID(r,a,s.children);else if(Bn(o,n))if(a=Kt(o,n),ce(a))r=ID(r,_e(),s.children);else{let c=Ii(s.children,ae(a));if(c){let u=c.getChild(xe(a));r=Bd(r,_e(),u)}}}else throw Lo("WriteRecord should have .snap or .children")}}return r}function u2(t,e,n,r,i){if(!r&&!i){let s=No(t.visibleWrites,e);if(s!=null)return s;{let o=gs(t.visibleWrites,e);if(bD(o))return n;if(n==null&&!CD(o,_e()))return null;{let a=n||te.EMPTY_NODE;return Qc(o,a)}}}else{let s=gs(t.visibleWrites,e);if(!i&&bD(s))return n;if(!i&&n==null&&!CD(s,_e()))return null;{let o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(Bn(u.path,e)||Bn(e,u.path))},a=c2(t.allWrites,o,e),c=n||te.EMPTY_NODE;return Qc(a,c)}}}function vQ(t,e,n){let r=te.EMPTY_NODE,i=No(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ne,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=gs(t.visibleWrites,e);return n.forEachChild(Ne,(o,a)=>{let c=Qc(gs(s,new ve(o)),a);r=r.updateImmediateChild(o,c)}),vV(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=gs(t.visibleWrites,e);return vV(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function wQ(t,e,n,r,i){D(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=je(e,n);if(CD(t.visibleWrites,s))return null;{let o=gs(t.visibleWrites,s);return bD(o)?i.getChild(n):Qc(o,i.getChild(n))}}function EQ(t,e,n,r){let i=je(e,n),s=No(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=gs(t.visibleWrites,i);return Qc(o,r.getNode().getImmediateChild(n))}else return null}function IQ(t,e){return No(t.visibleWrites,e)}function CQ(t,e,n,r,i,s,o){let a,c=gs(t.visibleWrites,e),u=No(c,_e());if(u!=null)a=u;else if(n!=null)a=Qc(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function bQ(){return{visibleWrites:lr.empty(),allWrites:[],lastWriteId:-1}}function cy(t,e,n,r){return u2(t.writeTree,t.treePath,e,n,r)}function cT(t,e){return vQ(t.writeTree,t.treePath,e)}function wV(t,e,n,r){return wQ(t.writeTree,t.treePath,e,n,r)}function uy(t,e){return IQ(t.writeTree,je(t.treePath,e))}function DQ(t,e,n,r,i,s){return CQ(t.writeTree,t.treePath,e,n,r,i,s)}function uT(t,e,n){return EQ(t.writeTree,t.treePath,e,n)}function l2(t,e){return d2(je(t.treePath,e),t.writeTree)}function d2(t,e){return{treePath:t,writeTree:e}}var DD=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;D(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),D(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Wd(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,zd(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Wc(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Wd(r,e.snapshotNode,i.oldSnap));else throw Lo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var TD=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},h2=new TD,Xd=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new qr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return uT(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ro(this.viewCache_),s=DQ(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function TQ(t){return{filter:t}}function SQ(t,e){D(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),D(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function AQ(t,e,n,r,i){let s=new DD,o,a;if(n.type===Ur.OVERWRITE){let u=n;u.source.fromUser?o=SD(t,e,u.path,u.snap,r,i,s):(D(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!ce(u.path),o=ly(t,e,u.path,u.snap,r,i,a,s))}else if(n.type===Ur.MERGE){let u=n;u.source.fromUser?o=MQ(t,e,u.path,u.children,r,i,s):(D(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=AD(t,e,u.path,u.children,r,i,a,s))}else if(n.type===Ur.ACK_USER_WRITE){let u=n;u.revert?o=NQ(t,e,u.path,r,i,s):o=RQ(t,e,u.path,u.affectedTree,r,i,s)}else if(n.type===Ur.LISTEN_COMPLETE)o=PQ(t,e,n.path,r,s);else throw Lo("Unknown operation type: "+n.type);let c=s.getChanges();return xQ(e,o,c),{viewCache:o,changes:c}}function xQ(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=ay(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(s2(ay(e)))}}function f2(t,e,n,r,i,s){let o=e.eventCache;if(uy(r,n)!=null)return e;{let a,c;if(ce(n))if(D(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=Ro(e),l=u instanceof te?u:te.EMPTY_NODE,d=cT(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let u=cy(r,Ro(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=ae(n);if(u===".priority"){D(_s(n)===1,"Can't have a priority with additional path components");let l=o.getNode();c=e.serverCache.getNode();let d=wV(r,n,l,c);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=xe(n),d;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();let h=wV(r,n,o.getNode(),c);h!=null?d=o.getNode().getImmediateChild(u).updateChild(l,h):d=o.getNode().getImmediateChild(u)}else d=uT(r,u,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),u,d,l,i,s):a=o.getNode()}}return Ud(e,a,o.isFullyInitialized()||ce(n),t.filter.filtersNodes())}}function ly(t,e,n,r,i,s,o,a){let c=e.serverCache,u,l=o?t.filter:t.filter.getIndexedFilter();if(ce(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){let f=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),f,null)}else{let f=ae(n);if(!c.isCompleteForPath(n)&&_s(n)>1)return e;let p=xe(n),m=c.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?u=l.updatePriority(c.getNode(),m):u=l.updateChild(c.getNode(),f,m,p,h2,null)}let d=o2(e,u,c.isFullyInitialized()||ce(n),l.filtersNodes()),h=new Xd(i,d,s);return f2(t,d,n,i,h,a)}function SD(t,e,n,r,i,s,o){let a=e.eventCache,c,u,l=new Xd(i,e,s);if(ce(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Ud(e,u,!0,t.filter.filtersNodes());else{let d=ae(n);if(d===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),c=Ud(e,u,a.isFullyInitialized(),a.isFiltered());else{let h=xe(n),f=a.getNode().getImmediateChild(d),p;if(ce(h))p=r;else{let g=l.getCompleteChild(d);g!=null?eT(h)===".priority"&&g.getChild(JV(h)).isEmpty()?p=g:p=g.updateChild(h,r):p=te.EMPTY_NODE}if(f.equals(p))c=e;else{let g=t.filter.updateChild(a.getNode(),d,p,h,l,o);c=Ud(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function EV(t,e){return t.eventCache.isCompleteForChild(e)}function MQ(t,e,n,r,i,s,o){let a=e;return r.foreach((c,u)=>{let l=je(n,c);EV(e,ae(l))&&(a=SD(t,a,l,u,i,s,o))}),r.foreach((c,u)=>{let l=je(n,c);EV(e,ae(l))||(a=SD(t,a,l,u,i,s,o))}),a}function IV(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function AD(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;ce(n)?u=r:u=new Qt(null).setTree(n,r);let l=e.serverCache.getNode();return u.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=IV(t,f,h);c=ly(t,c,new ve(d),p,i,s,o,a)}}),u.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),g=IV(t,p,h);c=ly(t,c,new ve(d),g,i,s,o,a)}}),c}function RQ(t,e,n,r,i,s,o){if(uy(i,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(ce(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return ly(t,e,n,c.getNode().getChild(n),i,s,a,o);if(ce(n)){let u=new Qt(null);return c.getNode().forEachChild(Br,(l,d)=>{u=u.set(new ve(l),d)}),AD(t,e,n,u,i,s,a,o)}else return e}else{let u=new Qt(null);return r.foreach((l,d)=>{let h=je(n,l);c.isCompleteForPath(h)&&(u=u.set(l,c.getNode().getChild(h)))}),AD(t,e,n,u,i,s,a,o)}}function PQ(t,e,n,r,i){let s=e.serverCache,o=o2(e,s.getNode(),s.isFullyInitialized()||ce(n),s.isFiltered());return f2(t,o,n,r,h2,i)}function NQ(t,e,n,r,i,s){let o;if(uy(r,n)!=null)return e;{let a=new Xd(r,e,i),c=e.eventCache.getNode(),u;if(ce(n)||ae(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=cy(r,Ro(e));else{let d=e.serverCache.getNode();D(d instanceof te,"serverChildren would be complete if leaf node"),l=cT(r,d)}l=l,u=t.filter.updateFullNode(c,l,s)}else{let l=ae(n),d=uT(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=c.getImmediateChild(l)),d!=null?u=t.filter.updateChild(c,l,d,xe(n),a,s):e.eventCache.getNode().hasChild(l)?u=t.filter.updateChild(c,l,te.EMPTY_NODE,xe(n),a,s):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=cy(r,Ro(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||uy(r,_e())!=null,Ud(e,u,o,t.filter.filtersNodes())}}var xD=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Kd(r.getIndex()),s=eQ(r);this.processor_=TQ(s);let o=n.serverCache,a=n.eventCache,c=i.updateFullNode(te.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(te.EMPTY_NODE,a.getNode(),null),l=new qr(c,o.isFullyInitialized(),i.filtersNodes()),d=new qr(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=by(d,l),this.eventGenerator_=new ED(this.query_)}get query(){return this.query_}};function kQ(t){return t.viewCache_.serverCache.getNode()}function OQ(t){return ay(t.viewCache_)}function FQ(t,e){let n=Ro(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ce(e)&&!n.getImmediateChild(ae(e)).isEmpty())?n.getChild(e):null}function CV(t){return t.eventRegistrations_.length===0}function LQ(t,e){t.eventRegistrations_.push(e)}function bV(t,e,n){let r=[];if(n){D(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function DV(t,e,n,r){e.type===Ur.MERGE&&e.source.queryId!==null&&(D(Ro(t.viewCache_),"We should always have a full cache before handling merges"),D(ay(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=AQ(t.processor_,i,e,n,r);return SQ(t.processor_,s.viewCache),D(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,p2(t,s.changes,s.viewCache.eventCache.getNode(),null)}function VQ(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ne,(s,o)=>{r.push(Wc(s,o))}),n.isFullyInitialized()&&r.push(s2(n.getNode())),p2(t,r,n.getNode(),e)}function p2(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return cQ(t.eventGenerator_,e,n,i)}var dy,hy=class{constructor(){this.views=new Map}};function jQ(t){D(!dy,"__referenceConstructor has already been defined"),dy=t}function UQ(){return D(dy,"Reference.ts has not been loaded"),dy}function BQ(t){return t.views.size===0}function lT(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return D(s!=null,"SyncTree gave us an op for an invalid query."),DV(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(DV(o,e,n,r));return s}}function g2(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=cy(n,i?r:null),c=!1;a?c=!0:r instanceof te?(a=cT(n,r),c=!1):(a=te.EMPTY_NODE,c=!1);let u=by(new qr(a,c,!1),new qr(r,i,!1));return new xD(e,u)}return o}function $Q(t,e,n,r,i,s){let o=g2(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),LQ(o,n),VQ(o,n)}function qQ(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=vs(t);if(i==="default")for(let[c,u]of t.views.entries())o=o.concat(bV(u,n,r)),CV(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||s.push(u.query));else{let c=t.views.get(i);c&&(o=o.concat(bV(c,n,r)),CV(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!vs(t)&&s.push(new(UQ())(e._repo,e._path)),{removed:s,events:o}}function m2(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function ms(t,e){let n=null;for(let r of t.views.values())n=n||FQ(r,e);return n}function y2(t,e){if(e._queryParams.loadsAllData())return Ty(t);{let r=e._queryIdentifier;return t.views.get(r)}}function _2(t,e){return y2(t,e)!=null}function vs(t){return Ty(t)!=null}function Ty(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var fy;function HQ(t){D(!fy,"__referenceConstructor has already been defined"),fy=t}function GQ(){return D(fy,"Reference.ts has not been loaded"),fy}var zQ=1,py=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Qt(null),this.pendingWriteTree_=bQ(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function dT(t,e,n,r,i){return hQ(t.pendingWriteTree_,e,n,r,i),i?eu(t,new Kc(sT(),e,n)):[]}function WQ(t,e,n,r){fQ(t.pendingWriteTree_,e,n,r);let i=Qt.fromObject(n);return eu(t,new Yd(sT(),e,i))}function ps(t,e,n=!1){let r=pQ(t.pendingWriteTree_,e);if(gQ(t.pendingWriteTree_,e)){let s=new Qt(null);return r.snap!=null?s=s.set(_e(),!0):bt(r.children,o=>{s=s.set(new ve(o),!0)}),eu(t,new wD(r.path,s,n))}else return[]}function oh(t,e,n){return eu(t,new Kc(oT(),e,n))}function KQ(t,e,n){let r=Qt.fromObject(n);return eu(t,new Yd(oT(),e,r))}function QQ(t,e){return eu(t,new oy(oT(),e))}function YQ(t,e,n){let r=hT(t,n);if(r){let i=fT(r),s=i.path,o=i.queryId,a=Kt(s,e),c=new oy(aT(o),a);return pT(t,s,c)}else return[]}function gy(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||_2(o,e))){let c=qQ(o,e,n,r);BQ(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let u=c.removed;if(a=c.events,!i){let l=u.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>vs(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=JQ(h);for(let p=0;p<f.length;++p){let g=f[p],m=g.query,E=I2(t,g);t.listenProvider_.startListening($d(m),Zd(t,m),E.hashFn,E.onComplete)}}}!d&&u.length>0&&!r&&(l?t.listenProvider_.stopListening($d(e),null):u.forEach(h=>{let f=t.queryToTagMap.get(Ay(h));t.listenProvider_.stopListening($d(h),f)}))}e7(t,u)}return a}function v2(t,e,n,r){let i=hT(t,r);if(i!=null){let s=fT(i),o=s.path,a=s.queryId,c=Kt(o,e),u=new Kc(aT(a),c,n);return pT(t,o,u)}else return[]}function XQ(t,e,n,r){let i=hT(t,r);if(i){let s=fT(i),o=s.path,a=s.queryId,c=Kt(o,e),u=Qt.fromObject(n),l=new Yd(aT(a),c,u);return pT(t,o,l)}else return[]}function MD(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=Kt(h,i);s=s||ms(f,p),o=o||vs(f)});let a=t.syncPointTree_.get(i);a?(o=o||vs(a),s=s||ms(a,_e())):(a=new hy,t.syncPointTree_=t.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=te.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let g=ms(p,_e());g&&(s=s.updateImmediateChild(f,g))}));let u=_2(a,e);if(!u&&!e._queryParams.loadsAllData()){let h=Ay(e);D(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=t7();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=Dy(t.pendingWriteTree_,i),d=$Q(a,e,n,l,s,c);if(!u&&!o&&!r){let h=y2(a,e);d=d.concat(n7(t,e,h))}return d}function Sy(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=Kt(o,e),u=ms(a,c);if(u)return u});return u2(i,e,s,n,!0)}function ZQ(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(u,l)=>{let d=Kt(u,n);r=r||ms(l,d)});let i=t.syncPointTree_.get(n);i?r=r||ms(i,_e()):(i=new hy,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new qr(r,!0,!1):null,a=Dy(t.pendingWriteTree_,e._path),c=g2(i,e,a,s?o.getNode():te.EMPTY_NODE,s);return OQ(c)}function eu(t,e){return w2(e,t.syncPointTree_,null,Dy(t.pendingWriteTree_,_e()))}function w2(t,e,n,r){if(ce(t.path))return E2(t,e,n,r);{let i=e.get(_e());n==null&&i!=null&&(n=ms(i,_e()));let s=[],o=ae(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let u=n?n.getImmediateChild(o):null,l=l2(r,o);s=s.concat(w2(a,c,u,l))}return i&&(s=s.concat(lT(i,t,r,n))),s}}function E2(t,e,n,r){let i=e.get(_e());n==null&&i!=null&&(n=ms(i,_e()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,u=l2(r,o),l=t.operationForChild(o);l&&(s=s.concat(E2(l,a,c,u)))}),i&&(s=s.concat(lT(i,t,r,n))),s}function I2(t,e){let n=e.query,r=Zd(t,n);return{hashFn:()=>(kQ(e)||te.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?YQ(t,n._path,r):QQ(t,n._path);{let s=hK(i,n);return gy(t,n,null,s)}}}}function Zd(t,e){let n=Ay(e);return t.queryToTagMap.get(n)}function Ay(t){return t._path.toString()+"$"+t._queryIdentifier}function hT(t,e){return t.tagToQueryMap.get(e)}function fT(t){let e=t.indexOf("$");return D(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new ve(t.substr(0,e))}}function pT(t,e,n){let r=t.syncPointTree_.get(e);D(r,"Missing sync point for query tag that we're tracking");let i=Dy(t.pendingWriteTree_,e);return lT(r,n,i,null)}function JQ(t){return t.fold((e,n,r)=>{if(n&&vs(n))return[Ty(n)];{let i=[];return n&&(i=m2(n)),bt(r,(s,o)=>{i=i.concat(o)}),i}})}function $d(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(GQ())(t._repo,t._path):t}function e7(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=Ay(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function t7(){return zQ++}function n7(t,e,n){let r=e._path,i=Zd(t,e),s=I2(t,n),o=t.listenProvider_.startListening($d(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)D(!vs(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((u,l,d)=>{if(!ce(u)&&l&&vs(l))return[Ty(l).query];{let h=[];return l&&(h=h.concat(m2(l).map(f=>f.query))),bt(d,(f,p)=>{h=h.concat(p)}),h}});for(let u=0;u<c.length;++u){let l=c[u];t.listenProvider_.stopListening($d(l),Zd(t,l))}}return o}var RD=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},PD=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=je(this.path_,e);return new t(this.syncTree_,n)}node(){return Sy(this.syncTree_,this.path_)}},r7=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},TV=function(t,e,n){if(!t||typeof t!="object")return t;if(D(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return i7(t[".sv"],e,n);if(typeof t[".sv"]=="object")return s7(t[".sv"],e);D(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},i7=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:D(!1,"Unexpected server value: "+t)}},s7=function(t,e,n){t.hasOwnProperty("increment")||D(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&D(!1,"Unexpected increment value: "+r);let i=e.node();if(D(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},C2=function(t,e,n,r){return mT(e,new PD(n,t),r)},gT=function(t,e,n){return mT(t,new RD(e),n)};function mT(t,e,n){let r=t.getPriority().val(),i=TV(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=TV(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Gc(a,ze(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Gc(i))),o.forEachChild(Ne,(a,c)=>{let u=mT(c,e.getImmediateChild(a),n);u!==c&&(s=s.updateImmediateChild(a,u))}),s}}var Jd=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function xy(t,e){let n=e instanceof ve?e:new ve(e),r=t,i=ae(n);for(;i!==null;){let s=Ii(r.node.children,i)||{children:{},childCount:0};r=new Jd(i,r,s),n=xe(n),i=ae(n)}return r}function ko(t){return t.node.value}function yT(t,e){t.node.value=e,ND(t)}function b2(t){return t.node.childCount>0}function o7(t){return ko(t)===void 0&&!b2(t)}function My(t,e){bt(t.node.children,(n,r)=>{e(new Jd(n,t,r))})}function D2(t,e,n,r){n&&!r&&e(t),My(t,i=>{D2(i,e,!0,r)}),n&&r&&e(t)}function a7(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function ah(t){return new ve(t.parent===null?t.name:ah(t.parent)+"/"+t.name)}function ND(t){t.parent!==null&&c7(t.parent,t.name,t)}function c7(t,e,n){let r=o7(n),i=bn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,ND(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,ND(t))}var u7=/[\[\].#$\/\u0000-\u001F\u007F]/,l7=/[\[\].#$\u0000-\u001F\u007F]/,Hb=10*1024*1024,Ry=function(t){return typeof t=="string"&&t.length!==0&&!u7.test(t)},T2=function(t){return typeof t=="string"&&t.length!==0&&!l7.test(t)},d7=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),T2(t)},eh=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Iy(t)||t&&typeof t=="object"&&bn(t,".sv")},Hr=function(t,e,n,r){r&&e===void 0||ch(Xt(t,"value"),e,n)},ch=function(t,e,n){let r=n instanceof ve?new rD(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Ao(r));if(typeof e=="function")throw new Error(t+"contains a function "+Ao(r)+" with contents = "+e.toString());if(Iy(e))throw new Error(t+"contains "+e.toString()+" "+Ao(r));if(typeof e=="string"&&e.length>Hb/3&&su(e)>Hb)throw new Error(t+"contains a string greater than "+Hb+" utf8 bytes "+Ao(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(bt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Ry(o)))throw new Error(t+" contains an invalid key ("+o+") "+Ao(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);BK(r,o),ch(t,a,r),$K(r)}),i&&s)throw new Error(t+' contains ".value" child '+Ao(r)+" in addition to actual children.")}},h7=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=Hd(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Ry(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(UK);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&Bn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},S2=function(t,e,n,r){if(r&&e===void 0)return;let i=Xt(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];bt(e,(o,a)=>{let c=new ve(o);if(ch(i,a,je(n,c)),eT(c)===".priority"&&!eh(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),h7(i,s)},_T=function(t,e,n){if(!(n&&e===void 0)){if(Iy(e))throw new Error(Xt(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!eh(e))throw new Error(Xt(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},uh=function(t,e,n,r){if(!(r&&n===void 0)&&!Ry(n))throw new Error(Xt(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},tu=function(t,e,n,r){if(!(r&&n===void 0)&&!T2(n))throw new Error(Xt(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},f7=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),tu(t,e,n,r)},wn=function(t,e){if(ae(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},A2=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Ry(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!d7(n))throw new Error(Xt(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var kD=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Py(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!tT(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function x2(t,e,n){Py(t,n),M2(t,r=>tT(r,e))}function En(t,e,n){Py(t,n),M2(t,r=>Bn(r,e)||Bn(e,r))}function M2(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(p7(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function p7(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();Mo&&Ct("event: "+n.toString()),Zc(r)}}}var R2="repo_interrupt",g7=25,OD=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new kD,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=sy(),this.transactionQueueTree_=new Jd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function m7(t,e,n){if(t.stats_=JD(t.repoInfo_),t.forceRestClient_||mK())t.server_=new pD(t.repoInfo_,(r,i,s,o)=>{SV(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>AV(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{nt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new nT(t.repoInfo_,e,(r,i,s,o)=>{SV(t,r,i,s,o)},r=>{AV(t,r)},r=>{y7(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=_K(t.repoInfo_,()=>new vD(t.stats_,t.server_)),t.infoData_=new gD,t.infoSyncTree_=new py({startListening:(r,i,s,o)=>{let a=[],c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=oh(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),vT(t,"connected",!1),t.serverSyncTree_=new py({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,c)=>{let u=o(a,c);En(t.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function P2(t){let n=t.infoData_.getNode(new ve(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function lh(t){return r7({timestamp:P2(t)})}function SV(t,e,n,r,i){t.dataUpdateCount++;let s=new ve(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let c=iu(n,u=>ze(u));o=XQ(t.serverSyncTree_,s,c,i)}else{let c=ze(n);o=v2(t.serverSyncTree_,s,c,i)}else if(r){let c=iu(n,u=>ze(u));o=KQ(t.serverSyncTree_,s,c)}else{let c=ze(n);o=oh(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Yc(t,s)),En(t.eventQueue_,a,o)}function AV(t,e){vT(t,"connected",e),e===!1&&w7(t)}function y7(t,e){bt(e,(n,r)=>{vT(t,n,r)})}function vT(t,e,n){let r=new ve("/.info/"+e),i=ze(n);t.infoData_.updateSnapshot(r,i);let s=oh(t.infoSyncTree_,r,i);En(t.eventQueue_,r,s)}function Ny(t){return t.nextWriteId_++}function _7(t,e,n){let r=ZQ(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=ze(i).withIndex(e._queryParams.getIndex());MD(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=oh(t.serverSyncTree_,e._path,s);else{let a=Zd(t.serverSyncTree_,e);o=v2(t.serverSyncTree_,e._path,s,a)}return En(t.eventQueue_,e._path,o),gy(t.serverSyncTree_,e,n,null,!0),s},i=>(nu(t,"get for query "+nt(e)+" failed: "+i),Promise.reject(new Error(i))))}function wT(t,e,n,r,i){nu(t,"set",{path:e.toString(),value:n,priority:r});let s=lh(t),o=ze(n,r),a=Sy(t.serverSyncTree_,e),c=gT(o,a,s),u=Ny(t),l=dT(t.serverSyncTree_,e,c,u,!0);Py(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||jt("set at "+e+" failed: "+h);let g=ps(t.serverSyncTree_,u,!p);En(t.eventQueue_,e,g),ws(t,i,h,f)});let d=IT(t,e);Yc(t,d),En(t.eventQueue_,d,[])}function v7(t,e,n,r){nu(t,"update",{path:e.toString(),value:n});let i=!0,s=lh(t),o={};if(bt(n,(a,c)=>{i=!1,o[a]=C2(je(e,a),ze(c),t.serverSyncTree_,s)}),i)Ct("update() called with empty data.  Don't do anything."),ws(t,r,"ok",void 0);else{let a=Ny(t),c=WQ(t.serverSyncTree_,e,o,a);Py(t.eventQueue_,c),t.server_.merge(e.toString(),n,(u,l)=>{let d=u==="ok";d||jt("update at "+e+" failed: "+u);let h=ps(t.serverSyncTree_,a,!d),f=h.length>0?Yc(t,e):e;En(t.eventQueue_,f,h),ws(t,r,u,l)}),bt(n,u=>{let l=IT(t,je(e,u));Yc(t,l)}),En(t.eventQueue_,e,[])}}function w7(t){nu(t,"onDisconnectEvents");let e=lh(t),n=sy();yD(t.onDisconnect_,_e(),(i,s)=>{let o=C2(i,s,t.serverSyncTree_,e);Jc(n,i,o)});let r=[];yD(n,_e(),(i,s)=>{r=r.concat(oh(t.serverSyncTree_,i,s));let o=IT(t,i);Yc(t,o)}),t.onDisconnect_=sy(),En(t.eventQueue_,_e(),r)}function E7(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&mD(t.onDisconnect_,e),ws(t,n,r,i)})}function xV(t,e,n,r){let i=ze(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Jc(t.onDisconnect_,e,i),ws(t,r,s,o)})}function I7(t,e,n,r,i){let s=ze(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Jc(t.onDisconnect_,e,s),ws(t,i,o,a)})}function C7(t,e,n,r){if(_h(n)){Ct("onDisconnect().update() called with empty data.  Don't do anything."),ws(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&bt(n,(o,a)=>{let c=ze(a);Jc(t.onDisconnect_,je(e,o),c)}),ws(t,r,i,s)})}function b7(t,e,n){let r;ae(e._path)===".info"?r=MD(t.infoSyncTree_,e,n):r=MD(t.serverSyncTree_,e,n),x2(t.eventQueue_,e._path,r)}function FD(t,e,n){let r;ae(e._path)===".info"?r=gy(t.infoSyncTree_,e,n):r=gy(t.serverSyncTree_,e,n),x2(t.eventQueue_,e._path,r)}function N2(t){t.persistentConnection_&&t.persistentConnection_.interrupt(R2)}function D7(t){t.persistentConnection_&&t.persistentConnection_.resume(R2)}function nu(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Ct(n,...e)}function ws(t,e,n,r){e&&Zc(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function T7(t,e,n,r,i,s){nu(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:PV(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=ET(t,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{ch("transaction failed: Data returned ",c,o.path),o.status=0;let u=xy(t.transactionQueueTree_,e),l=ko(u)||[];l.push(o),yT(u,l);let d;typeof c=="object"&&c!==null&&bn(c,".priority")?(d=Ii(c,".priority"),D(eh(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(Sy(t.serverSyncTree_,e)||te.EMPTY_NODE).getPriority().val();let h=lh(t),f=ze(c,d),p=gT(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Ny(t);let g=dT(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);En(t.eventQueue_,e,g),ky(t,t.transactionQueueTree_)}}function ET(t,e,n){return Sy(t.serverSyncTree_,e,n)||te.EMPTY_NODE}function ky(t,e=t.transactionQueueTree_){if(e||Oy(t,e),ko(e)){let n=O2(t,e);D(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&S7(t,ah(e),n)}else b2(e)&&My(e,n=>{ky(t,n)})}function S7(t,e,n){let r=n.map(u=>u.currentWriteId),i=ET(t,e,r),s=i,o=i.hash();for(let u=0;u<n.length;u++){let l=n[u];D(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=Kt(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,u=>{nu(t,"transaction put response",{path:c.toString(),status:u});let l=[];if(u==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat(ps(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Oy(t,xy(t.transactionQueueTree_,e)),ky(t,t.transactionQueueTree_),En(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)Zc(d[h])}else{if(u==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{jt("transaction at "+c.toString()+" failed: "+u);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=u}Yc(t,e)}},o)}function Yc(t,e){let n=k2(t,e),r=ah(n),i=O2(t,n);return A7(t,i,r),r}function A7(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=Kt(n,c.path),l=!1,d;if(D(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)l=!0,d=c.abortReason,i=i.concat(ps(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=g7)l=!0,d="maxretry",i=i.concat(ps(t.serverSyncTree_,c.currentWriteId,!0));else{let h=ET(t,c.path,o);c.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){ch("transaction failed: Data returned ",f,c.path);let p=ze(f);typeof f=="object"&&f!=null&&bn(f,".priority")||(p=p.updatePriority(h.getPriority()));let m=c.currentWriteId,E=lh(t),S=gT(p,h,E);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=S,c.currentWriteId=Ny(t),o.splice(o.indexOf(m),1),i=i.concat(dT(t.serverSyncTree_,c.path,S,c.currentWriteId,c.applyLocally)),i=i.concat(ps(t.serverSyncTree_,m,!0))}else l=!0,d="nodata",i=i.concat(ps(t.serverSyncTree_,c.currentWriteId,!0))}En(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}Oy(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Zc(r[a]);ky(t,t.transactionQueueTree_)}function k2(t,e){let n,r=t.transactionQueueTree_;for(n=ae(e);n!==null&&ko(r)===void 0;)r=xy(r,n),e=xe(e),n=ae(e);return r}function O2(t,e){let n=[];return F2(t,e,n),n.sort((r,i)=>r.order-i.order),n}function F2(t,e,n){let r=ko(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);My(e,i=>{F2(t,i,n)})}function Oy(t,e){let n=ko(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,yT(e,n.length>0?n:void 0)}My(e,r=>{Oy(t,r)})}function IT(t,e){let n=ah(k2(t,e)),r=xy(t.transactionQueueTree_,e);return a7(r,i=>{Gb(t,i)}),Gb(t,r),D2(r,i=>{Gb(t,i)}),n}function Gb(t,e){let n=ko(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(D(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(D(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ps(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?yT(e,void 0):n.length=s+1,En(t.eventQueue_,ah(e),i);for(let o=0;o<r.length;o++)Zc(r[o])}}function x7(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function M7(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):jt(`Invalid query segment '${n}' in query '${t}'`)}return e}var LD=function(t,e){let n=R7(t),r=n.namespace;n.domain==="firebase.com"&&$r(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&$r("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||aK();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Xm(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new ve(n.pathString)}},R7=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=x7(t.substring(l,d)));let h=M7(t.substring(Math.min(t.length,d)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let f=e.slice(0,u);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var MV="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",P7=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=MV.charAt(n%64),n=Math.floor(n/64);D(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=MV.charAt(e[i]);return D(o.length===20,"nextPushId: Length should be 20."),o}}();var my=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+nt(this.snapshot.exportVal())}},yy=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var th=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return D(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var _y=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new mt;return E7(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){wn("OnDisconnect.remove",this._path);let e=new mt;return xV(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){wn("OnDisconnect.set",this._path),Hr("OnDisconnect.set",e,this._path,!1);let n=new mt;return xV(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){wn("OnDisconnect.setWithPriority",this._path),Hr("OnDisconnect.setWithPriority",e,this._path,!1),_T("OnDisconnect.setWithPriority",n,!1);let r=new mt;return I7(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){wn("OnDisconnect.update",this._path),S2("OnDisconnect.update",e,this._path,!1);let n=new mt;return C7(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Yt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ce(this._path)?null:eT(this._path)}get ref(){return new In(this._repo,this._path)}get _queryIdentifier(){let e=mV(this._queryParams),n=ZD(e);return n==="{}"?"default":n}get _queryObject(){return mV(this._queryParams)}isEqual(e){if(e=Q(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=tT(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+jK(this._path)}};function Fy(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Is(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Br){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==ys)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==wi)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Ne){if(e!=null&&!eh(e)||n!=null&&!eh(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(D(t.getIndex()instanceof Gd||t.getIndex()===iT,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Ly(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var In=class t extends Yt{constructor(e,n){super(e,n,new Qd,!1)}get parent(){let e=JV(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Xc=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new ve(e),r=Es(this.ref,e);return new t(this._node.getChild(n),r,Ne)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,Es(this.ref,r),Ne)))}hasChild(e){let n=new ve(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function CT(t,e){return t=Q(t),t._checkNotDeleted("ref"),e!==void 0?Es(t._root,e):t._root}function bT(t,e){t=Q(t),t._checkNotDeleted("refFromURL");let n=LD(e,t._repo.repoInfo_.nodeAdmin);A2("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&$r("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),CT(t,n.path.toString())}function Es(t,e){return t=Q(t),ae(t._path)===null?f7("child","path",e,!1):tu("child","path",e,!1),new In(t._repo,je(t._path,e))}function L2(t,e){t=Q(t),wn("push",t._path),Hr("push",e,t._path,!0);let n=P2(t._repo),r=P7(n),i=Es(t,r),s=Es(t,r),o;return e!=null?o=Vy(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function V2(t){return wn("remove",t._path),Vy(t,null)}function Vy(t,e){t=Q(t),wn("set",t._path),Hr("set",e,t._path,!1);let n=new mt;return wT(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function j2(t,e){t=Q(t),wn("setPriority",t._path),_T("setPriority",e,!1);let n=new mt;return wT(t._repo,je(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function U2(t,e,n){if(wn("setWithPriority",t._path),Hr("setWithPriority",e,t._path,!1),_T("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new mt;return wT(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function B2(t,e){S2("update",e,t._path,!1);let n=new mt;return v7(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function $2(t){t=Q(t);let e=new th(()=>{}),n=new nh(e);return _7(t._repo,t,n).then(r=>new Xc(r,new In(t._repo,t._path),t._queryParams.getIndex()))}var nh=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new my("value",this,new Xc(e.snapshotNode,new In(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new yy(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},vy=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new yy(this,e,n):null}createEvent(e,n){D(e.childName!=null,"Child events should have a childName.");let r=Es(new In(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new my(e.type,this,new Xc(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function dh(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=n,u=(l,d)=>{FD(t._repo,t,a),c(l,d)};u.userCallback=n.userCallback,u.context=n.context,n=u}let o=new th(n,s||void 0),a=e==="value"?new nh(o):new vy(e,o);return b7(t._repo,t,a),()=>FD(t._repo,t,a)}function jy(t,e,n,r){return dh(t,"value",e,n,r)}function DT(t,e,n,r){return dh(t,"child_added",e,n,r)}function TT(t,e,n,r){return dh(t,"child_changed",e,n,r)}function ST(t,e,n,r){return dh(t,"child_moved",e,n,r)}function AT(t,e,n,r){return dh(t,"child_removed",e,n,r)}function xT(t,e,n){let r=null,i=n?new th(n):null;e==="value"?r=new nh(i):e&&(r=new vy(e,i)),FD(t._repo,t,r)}var Cn=class{},wy=class extends Cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Hr("endAt",this._value,e._path,!0);let n=fD(e._queryParams,this._value,this._key);if(Ly(n),Is(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Yt(e._repo,e._path,n,e._orderByCalled)}};function q2(t,e){return uh("endAt","key",e,!0),new wy(t,e)}var VD=class extends Cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){Hr("endBefore",this._value,e._path,!1);let n=iQ(e._queryParams,this._value,this._key);if(Ly(n),Is(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Yt(e._repo,e._path,n,e._orderByCalled)}};function H2(t,e){return uh("endBefore","key",e,!0),new VD(t,e)}var Ey=class extends Cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Hr("startAt",this._value,e._path,!0);let n=hD(e._queryParams,this._value,this._key);if(Ly(n),Is(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Yt(e._repo,e._path,n,e._orderByCalled)}};function G2(t=null,e){return uh("startAt","key",e,!0),new Ey(t,e)}var jD=class extends Cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){Hr("startAfter",this._value,e._path,!1);let n=rQ(e._queryParams,this._value,this._key);if(Ly(n),Is(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Yt(e._repo,e._path,n,e._orderByCalled)}};function z2(t,e){return uh("startAfter","key",e,!0),new jD(t,e)}var UD=class extends Cn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Yt(e._repo,e._path,tQ(e._queryParams,this._limit),e._orderByCalled)}};function W2(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new UD(t)}var BD=class extends Cn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Yt(e._repo,e._path,nQ(e._queryParams,this._limit),e._orderByCalled)}};function K2(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new BD(t)}var $D=class extends Cn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Fy(e,"orderByChild");let n=new ve(this._path);if(ce(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new Gd(n),i=Cy(e._queryParams,r);return Is(i),new Yt(e._repo,e._path,i,!0)}};function Q2(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return tu("orderByChild","path",t,!1),new $D(t)}var qD=class extends Cn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Fy(e,"orderByKey");let n=Cy(e._queryParams,Br);return Is(n),new Yt(e._repo,e._path,n,!0)}};function Y2(){return new qD}var HD=class extends Cn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Fy(e,"orderByPriority");let n=Cy(e._queryParams,Ne);return Is(n),new Yt(e._repo,e._path,n,!0)}};function X2(){return new HD}var GD=class extends Cn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Fy(e,"orderByValue");let n=Cy(e._queryParams,iT);return Is(n),new Yt(e._repo,e._path,n,!0)}};function Z2(){return new GD}var zD=class extends Cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(Hr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new wy(this._value,this._key)._apply(new Ey(this._value,this._key)._apply(e))}};function J2(t,e){return uh("equalTo","key",e,!0),new zD(t,e)}function qn(t,...e){let n=Q(t);for(let r of e)n=r._apply(n);return n}jQ(In);HQ(In);var N7="FIREBASE_DATABASE_EMULATOR_HOST",WD={},k7=!1;function O7(t,e,n,r){t.repoInfo_=new Xm(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function MT(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||$r("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ct("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=LD(s,i),a=o.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[N7]),u?(c=!0,s=`http://${u}?ns=${a.namespace}`,o=LD(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let l=i&&c?new jd(jd.OWNER):new Xb(t.name,t.options,e);A2("Invalid Firebase Database URL",o),ce(o.path)||$r("Database URL must point to the root of a Firebase Database (not including a child path).");let d=L7(a,t,l,new Yb(t.name,n));return new KD(d,t)}function F7(t,e){let n=WD[e];(!n||n[t.key]!==t)&&$r(`Database ${e}(${t.repoInfo_}) has already been deleted.`),N2(t),delete n[t.key]}function L7(t,e,n,r){let i=WD[e.name];i||(i={},WD[e.name]=i);let s=i[t.toURLString()];return s&&$r("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new OD(t,k7,n,r),i[t.toURLString()]=s,s}var KD=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(m7(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new In(this._repo,_e())),this._rootInternal}_delete(){return this._rootInternal!==null&&(F7(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&$r("Cannot call "+e+" on a deleted database.")}};function ej(){ZV.IS_TRANSPORT_INITIALIZED&&jt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function tj(){ej(),qd.forceDisallow()}function nj(){ej(),Bc.forceDisallow(),qd.forceAllow()}function rj(t,e,n,r={}){t=Q(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&$r("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&$r('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new jd(jd.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Vo(r.mockUserToken,t.app.options.projectId);s=new jd(o)}O7(i,e,n,s)}function ij(t){t=Q(t),t._checkNotDeleted("goOffline"),N2(t._repo)}function sj(t){t=Q(t),t._checkNotDeleted("goOnline"),D7(t._repo)}function oj(t,e){kV(t,e)}function V7(t){XD(jo),Gr(new Dt("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return MT(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Zt(JL,eV,t),Zt(JL,eV,"esm2017")}var j7={".sv":"timestamp"};function aj(){return j7}function cj(t){return{".sv":{increment:t}}}var QD=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function uj(t,e,n){var r;if(t=Q(t),wn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new mt,o=(c,u,l)=>{let d=null;c?s.reject(c):(d=new Xc(l,new In(t._repo,t._path),Ne),s.resolve(new QD(u,d)))},a=jy(t,()=>{});return T7(t._repo,t._path,e,o,a,i),s.promise}nT.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};nT.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};V7();var U7="@firebase/database-compat",B7="1.0.3";var $7=new Ci("@firebase/database-compat"),lj=function(t){let e="FIREBASE WARNING: "+t;$7.warn(e)};var q7=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(Xt(t,e)+"must be a boolean.")},H7=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Xt(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var RT=class{constructor(e){this._delegate=e}cancel(e){z("OnDisconnect.cancel",0,1,arguments.length),ht("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){z("OnDisconnect.remove",0,1,arguments.length),ht("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){z("OnDisconnect.set",1,2,arguments.length),ht("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){z("OnDisconnect.setWithPriority",2,3,arguments.length),ht("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(z("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,lj("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ht("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var PT=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return z("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Oo=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return z("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return z("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return z("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return z("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return z("DataSnapshot.child",0,1,arguments.length),e=String(e),tu("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return z("DataSnapshot.hasChild",1,1,arguments.length),tu("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return z("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return z("DataSnapshot.forEach",1,1,arguments.length),ht("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return z("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return z("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return z("DataSnapshot.ref",0,0,arguments.length),new Ei(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Uy=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;z("Query.on",2,4,arguments.length),ht("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(u,l)=>{n.call(o.context,new Oo(this.database,u),l)};a.userCallback=n,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return jy(this._delegate,a,c),n;case"child_added":return DT(this._delegate,a,c),n;case"child_removed":return AT(this._delegate,a,c),n;case"child_changed":return TT(this._delegate,a,c),n;case"child_moved":return ST(this._delegate,a,c),n;default:throw new Error(Xt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(z("Query.off",0,3,arguments.length),H7("Query.off",e,!0),ht("Query.off","callback",n,!0),Gy("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,xT(this._delegate,e,i)}else xT(this._delegate,e)}get(){return $2(this._delegate).then(e=>new Oo(this.database,e))}once(e,n,r,i){z("Query.once",1,4,arguments.length),ht("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new mt,a=(u,l)=>{let d=new Oo(this.database,u);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let c=u=>{s.cancel&&s.cancel.call(s.context,u),o.reject(u)};switch(e){case"value":jy(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":DT(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":AT(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":TT(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":ST(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(Xt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return z("Query.limitToFirst",1,1,arguments.length),new t(this.database,qn(this._delegate,W2(e)))}limitToLast(e){return z("Query.limitToLast",1,1,arguments.length),new t(this.database,qn(this._delegate,K2(e)))}orderByChild(e){return z("Query.orderByChild",1,1,arguments.length),new t(this.database,qn(this._delegate,Q2(e)))}orderByKey(){return z("Query.orderByKey",0,0,arguments.length),new t(this.database,qn(this._delegate,Y2()))}orderByPriority(){return z("Query.orderByPriority",0,0,arguments.length),new t(this.database,qn(this._delegate,X2()))}orderByValue(){return z("Query.orderByValue",0,0,arguments.length),new t(this.database,qn(this._delegate,Z2()))}startAt(e=null,n){return z("Query.startAt",0,2,arguments.length),new t(this.database,qn(this._delegate,G2(e,n)))}startAfter(e=null,n){return z("Query.startAfter",0,2,arguments.length),new t(this.database,qn(this._delegate,z2(e,n)))}endAt(e=null,n){return z("Query.endAt",0,2,arguments.length),new t(this.database,qn(this._delegate,q2(e,n)))}endBefore(e=null,n){return z("Query.endBefore",0,2,arguments.length),new t(this.database,qn(this._delegate,H2(e,n)))}equalTo(e,n){return z("Query.equalTo",1,2,arguments.length),new t(this.database,qn(this._delegate,J2(e,n)))}toString(){return z("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return z("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(z("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,ht(e,"cancel",i.cancel,!0),i.context=r,Gy(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(Xt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Ei(this.database,new In(this._delegate._repo,this._delegate._path))}},Ei=class t extends Uy{constructor(e,n){super(e,new Yt(n._repo,n._path,new Qd,!1)),this.database=e,this._delegate=n}getKey(){return z("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return z("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,Es(this._delegate,e))}getParent(){z("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return z("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){z("Reference.set",1,2,arguments.length),ht("Reference.set","onComplete",n,!0);let r=Vy(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(z("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,lj("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}wn("Reference.update",this._delegate._path),ht("Reference.update","onComplete",n,!0);let r=B2(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){z("Reference.setWithPriority",2,3,arguments.length),ht("Reference.setWithPriority","onComplete",r,!0);let i=U2(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){z("Reference.remove",0,1,arguments.length),ht("Reference.remove","onComplete",e,!0);let n=V2(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){z("Reference.transaction",1,3,arguments.length),ht("Reference.transaction","transactionUpdate",e,!1),ht("Reference.transaction","onComplete",n,!0),q7("Reference.transaction","applyLocally",r,!0);let i=uj(this._delegate,e,{applyLocally:r}).then(s=>new PT(s.committed,new Oo(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){z("Reference.setPriority",1,2,arguments.length),ht("Reference.setPriority","onComplete",n,!0);let r=j2(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){z("Reference.push",0,2,arguments.length),ht("Reference.push","onComplete",n,!0);let r=L2(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return wn("Reference.onDisconnect",this._delegate._path),new RT(new _y(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Fo=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:tj,forceLongPolling:nj}}useEmulator(e,n,r={}){rj(this._delegate,e,n,r)}ref(e){if(z("database.ref",0,1,arguments.length),e instanceof Ei){let n=bT(this._delegate,e.toString());return new Ei(this,n)}else{let n=CT(this._delegate,e);return new Ei(this,n)}}refFromURL(e){z("database.refFromURL",1,1,arguments.length);let r=bT(this._delegate,e);return new Ei(this,r)}goOffline(){return z("database.goOffline",0,0,arguments.length),ij(this._delegate)}goOnline(){return z("database.goOnline",0,0,arguments.length),sj(this._delegate)}};Fo.ServerValue={TIMESTAMP:aj(),increment:t=>cj(t)};function G7({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){XD(n);let a=new zy("database-standalone"),c=new vh("auth-internal",a);c.setComponent(new Dt("auth-internal",()=>r,"PRIVATE"));let u;return i&&(u=new vh("app-check-internal",a),u.setComponent(new Dt("app-check-internal",()=>i,"PRIVATE"))),{instance:new Fo(MT(t,c,u,e,o),t),namespace:s}}var z7=Object.freeze({__proto__:null,initStandalone:G7});var W7=Fo.ServerValue;function K7(t){t.INTERNAL.registerComponent(new Dt("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Fo(i,r)},"PUBLIC").setServiceProps({Reference:Ei,Query:Uy,Database:Fo,DataSnapshot:Oo,enableLogging:oj,INTERNAL:z7,ServerValue:W7}).setMultipleInstances(!0)),t.registerVersion(U7,B7)}K7(Ue);function hh(t,e,n="on",r=Wr){return new ne(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(V(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),du())}function Q7(t){return typeof t=="string"}function Y7(t){return typeof t.exportVal=="function"}function gj(t){return t==null}function mj(t){return typeof t.set=="function"}function dj(t,e){return mj(e)?e:t.ref(e)}function yj(t,e){if(Q7(t))return e.stringCase();if(mj(t))return e.firebaseCase();if(Y7(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function _j(t){return(gj(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function vj(t,e,n){e=_j(e);let r=e.map(i=>hh(t,i,"on",n));return Zo(...r)}function X7(t,e,n){let r=vj(t,e).pipe(fr((i,s)=>[...i,s],[]));return J7(t,r,n)}function Z7(t,e){return hh(t,"value","on",e).pipe(V(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function J7(t,e,n){return Z7(t,n).pipe(y_(e),V(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(c=>c.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),g_(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),V(i=>i.actions))}function hj(t,e){return function(r,i){return yj(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function eY(t){return function(n){return n?yj(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function tY(t,e,n){return hh(t,"value","once",n).pipe(De(r=>{let i=[U(r)];return e.forEach(s=>i.push(hh(t,s,"on",n))),Zo(...i).pipe(fr(rY,[]))}),uu())}function wj(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function nY(t,e){if(gj(e))return 0;{let n=wj(t,e);return n===-1?t.length:n+1}}function rY(t,e){let{payload:n,prevKey:r,key:i}=e,s=wj(t,i),o=nY(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(c=>{let u={payload:c,type:"value",prevKey:a,key:c.key};return a=c.key,t=[...t,u],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(c=>c.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function fj(t,e,n){return e=_j(e),tY(t,e,n)}function iY(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:hj(r,"update"),set:hj(r,"set"),push:i=>r.push(i),remove:eY(r),snapshotChanges(i){return fj(t,i,n).pipe(Fe)},stateChanges(i){return vj(t,i,n).pipe(Fe)},auditTrail(i){return X7(t,i,n).pipe(Fe)},valueChanges(i,s){return fj(t,i,n).pipe(V(a=>a.map(c=>s&&s.idField?ye(A({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),Fe)}}}function pj(t,e){return function(){return hh(t,"value","on",e)}}function sY(t,e){return{query:t,snapshotChanges(){return pj(t,e.schedulers.outsideAngular)().pipe(Fe)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return pj(t,e.schedulers.outsideAngular)().pipe(Fe,V(r=>r.payload.exists()?r.payload.val():null))}}}var oY=new x("angularfire2.realtimeDatabaseURL"),aY=new x("angularfire2.database.use-emulator"),cY=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,c,u,l,d,h,f,p,g,m){this.schedulers=a;let E=c,S=ai(n,o,r);u&&fl(S,o,l,h,f,p,d,g),this.database=Hi(`${S.name}.database.${i}`,"AngularFireDatabase",S.name,()=>{let b=o.runOutsideAngular(()=>S.database(i||void 0));return E&&b.useEmulator(...E),b},[E])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>dj(this.database,n)),s=i;return r&&(s=r(i)),iY(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>dj(this.database,n));return sY(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(w(Cr),w(br,8),w(oY,8),w(ot),w(se),w($i),w(aY,8),w(ci,8),w(al,8),w(cl,8),w(ul,8),w(ll,8),w(dl,8),w(hl,8),w(Jn,8))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),Ej=(()=>{class t{constructor(){Ue.registerVersion("angularfire",er.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Me({type:t});static \u0275inj=Re({providers:[cY]})}return t})();var Ij={production:!1,firebase:{apiKey:"AIzaSyDmrgrnCMgL6-r563RM62VIE06BnMHgtug",authDomain:"crud-app-d735f.firebaseapp.com",projectId:"crud-app-d735f",storageBucket:"crud-app-d735f.appspot.com",messagingSenderId:"366503446665",appId:"1:366503446665:web:19058a82bec51a8bffde58",measurementId:"G-D7EQ2GQ4RM"}};var Cj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Me({type:e,bootstrap:[fL]}),e.\u0275inj=Re({providers:[_R()],imports:[mR,hL,IP.initializeApp(Ij.firebase),CP,ZL,EF,Ej,sL,oL]});let t=e;return t})();gR().bootstrapModule(Cj).catch(t=>console.error(t));
